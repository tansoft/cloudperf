import{u as wu,i as $t,j as m,s as Zo,A as bu,D as Pu,B as wt,T as uo,I as Di,a as Q,b as Zt,d as Su,L as Cu,e as Lu,f as Tu,g as Au,h as Mu,C as ci,k as Xt,l as ku,m as At,n as Sr,o as Cr,p as Lr,q as Dt,t as H,v as Ho,w as lo,x as $o,y as qo,z as Uo,E as Wo,G as Lt,F as Eu,H as Iu,S as Ru,M as co,J as Fe,K as ji,N as Ni,O as Ou,Q as zu,R as Fu,U as ju,V as Nu}from"./mui-Duey_HeI.js";import{b as Ko,a as Du,r as E,u as Go,f as Bu,L as Zu,O as Hu,c as Bi,e as oe,g as Ft,B as $u,h as qu,i as be,N as Yo}from"./vendor-CDotT_V8.js";import{R as $n,L as Uu,C as qn,X as Un,Y as Wn,T as Kn,a as Wu,B as fo,b as po,_ as Ku,c as Gu,d as Vo,e as Tr,l as Yu,f as Vu,g as Jo,h as Xo,i as Ju,j as Ar,k as Xu,m as Qu,n as Qo,o as tl,p as el,q as il,r as nl,s as rl,t as ta,u as sl,v as ol,w as al,x as hl,y as ea,z as ul,A as ll,D as cl,E as dl,F as fl,G as pl,H as ml,I as _l,J as mo,K as ia,M as na,N as ra,O as Gn,P as cr,Q as dr,S as vl}from"./charts-8qO8VMt8.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const u of a)if(u.type==="childList")for(const l of u.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function i(a){const u={};return a.integrity&&(u.integrity=a.integrity),a.referrerPolicy&&(u.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?u.credentials="include":a.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function s(a){if(a.ep)return;a.ep=!0;const u=i(a);fetch(a.href,u)}})();var fr={},_o=Ko;fr.createRoot=_o.createRoot,fr.hydrateRoot=_o.hydrateRoot;var Mr={},Yn={};const gl=Du(wu);var vo;function qt(){return vo||(vo=1,function(o){"use client";Object.defineProperty(o,"__esModule",{value:!0}),Object.defineProperty(o,"default",{enumerable:!0,get:function(){return n.createSvgIcon}});var n=gl}(Yn)),Yn}var yl=$t;Object.defineProperty(Mr,"__esModule",{value:!0});var sa=Mr.default=void 0,xl=yl(qt()),wl=m;sa=Mr.default=(0,xl.default)((0,wl.jsx)("path",{d:"M3 18h18v-2H3zm0-5h18v-2H3zm0-7v2h18V6z"}),"Menu");var kr={},bl=$t;Object.defineProperty(kr,"__esModule",{value:!0});var oa=kr.default=void 0,Pl=bl(qt()),Sl=m;oa=kr.default=(0,Pl.default)((0,Sl.jsx)("path",{d:"M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"}),"ChevronLeft");var Er={},Cl=$t;Object.defineProperty(Er,"__esModule",{value:!0});var Vi=Er.default=void 0,Ll=Cl(qt()),Tl=m;Vi=Er.default=(0,Ll.default)((0,Tl.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search");var Ir={},Al=$t;Object.defineProperty(Ir,"__esModule",{value:!0});var aa=Ir.default=void 0,Ml=Al(qt()),kl=m;aa=Ir.default=(0,Ml.default)((0,kl.jsx)("path",{d:"M2 20h20v-4H2zm2-3h2v2H4zM2 4v4h20V4zm4 3H4V5h2zm-4 7h20v-4H2zm2-3h2v2H4z"}),"Storage");var Rr={},El=$t;Object.defineProperty(Rr,"__esModule",{value:!0});var ha=Rr.default=void 0,Il=El(qt()),Rl=m;ha=Rr.default=(0,Il.default)((0,Rl.jsx)("path",{d:"M15.9 5c-.17 0-.32.09-.41.23l-.07.15-5.18 11.65c-.16.29-.26.61-.26.96 0 1.11.9 2.01 2.01 2.01.96 0 1.77-.68 1.96-1.59l.01-.03L16.4 5.5c0-.28-.22-.5-.5-.5M1 9l2 2c2.88-2.88 6.79-4.08 10.53-3.62l1.19-2.68C9.89 3.84 4.74 5.27 1 9m20 2 2-2c-1.64-1.64-3.55-2.82-5.59-3.57l-.53 2.82c1.5.62 2.9 1.53 4.12 2.75m-4 4 2-2c-.8-.8-1.7-1.42-2.66-1.89l-.55 2.92c.42.27.83.59 1.21.97M5 13l2 2c1.13-1.13 2.56-1.79 4.03-2l1.28-2.88c-2.63-.08-5.3.87-7.31 2.88"}),"NetworkCheck");var Or={},Ol=$t;Object.defineProperty(Or,"__esModule",{value:!0});var ua=Or.default=void 0,zl=Ol(qt()),Fl=m;ua=Or.default=(0,zl.default)((0,Fl.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2M8 17.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5M9.5 8c0-1.38 1.12-2.5 2.5-2.5s2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5S9.5 9.38 9.5 8m6.5 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5"}),"GroupWork");var zr={},jl=$t;Object.defineProperty(zr,"__esModule",{value:!0});var la=zr.default=void 0,Nl=jl(qt()),Dl=m;la=zr.default=(0,Nl.default)((0,Dl.jsx)("path",{d:"m17 7-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4z"}),"Logout");const pr=240,Bl=Zo(bu,{shouldForwardProp:o=>o!=="open"})(({theme:o,open:n})=>({zIndex:o.zIndex.drawer+1,transition:o.transitions.create(["width","margin"],{easing:o.transitions.easing.sharp,duration:o.transitions.duration.leavingScreen}),...n&&{marginLeft:pr,width:`calc(100% - ${pr}px)`,transition:o.transitions.create(["width","margin"],{easing:o.transitions.easing.sharp,duration:o.transitions.duration.enteringScreen})}})),Zl=Zo(Pu,{shouldForwardProp:o=>o!=="open"})(({theme:o,open:n})=>({"& .MuiDrawer-paper":{position:"relative",whiteSpace:"nowrap",width:pr,transition:o.transitions.create("width",{easing:o.transitions.easing.sharp,duration:o.transitions.duration.enteringScreen}),boxSizing:"border-box",...!n&&{overflowX:"hidden",transition:o.transitions.create("width",{easing:o.transitions.easing.sharp,duration:o.transitions.duration.leavingScreen}),width:o.spacing(7),[o.breakpoints.up("sm")]:{width:o.spacing(9)}}}})),Hl=[{text:"IP Search",path:"/ipsearch",icon:m.jsx(Vi,{})},{text:"ASN Search",path:"/asnsearch",icon:m.jsx(aa,{})},{text:"Network Performance",path:"/search",icon:m.jsx(ha,{})},{text:"City Sets",path:"/cityset",icon:m.jsx(ua,{})}];function $l(){const[o,n]=E.useState(!0),[i,s]=E.useState(null),a=Go(),u=Bu();E.useEffect(()=>{!document.cookie.split("; ").find(_=>_.startsWith("token="))&&u.pathname!=="/login"&&a("/login");const v=async()=>{try{const _=await fetch("/api/status");if(_.ok){const x=await _.json();s(x)}}catch(_){console.error("Error fetching status:",_)}};v();const y=setInterval(v,1e4);return()=>clearInterval(y)},[u,a]);const l=()=>{document.cookie="token=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT",a("/login")},d=()=>{n(!o)};return m.jsxs(wt,{sx:{display:"flex"},children:[m.jsx(Bl,{position:"absolute",open:o,children:m.jsxs(uo,{sx:{pr:"24px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[m.jsxs(wt,{sx:{display:"flex",alignItems:"center"},children:[m.jsx(Di,{edge:"start",color:"inherit","aria-label":"open drawer",onClick:d,sx:{marginRight:"36px",...o&&{display:"none"}},children:m.jsx(sa,{})}),m.jsx(Q,{component:"h1",variant:"h6",color:"inherit",noWrap:!0,children:"CloudPerf Dashboard"})]}),i&&m.jsxs(wt,{sx:{display:"flex",alignItems:"center",gap:3,flex:1,justifyContent:"center"},children:[m.jsxs(Q,{variant:"body2",children:["Active Nodes: ",i.activeNodes]}),m.jsxs(Q,{variant:"body2",children:["Avg Latency: ",i.avgLatency,"ms"]}),m.jsxs(Q,{variant:"body2",children:["Uptime: ",i.uptime,"%"]})]}),m.jsxs(wt,{sx:{display:"flex",alignItems:"center",gap:2},children:[m.jsx(Q,{variant:"body2",children:"admin"}),m.jsx(Zt,{color:"inherit",onClick:l,startIcon:m.jsx(la,{}),children:"Logout"})]})]})}),m.jsxs(Zl,{variant:"permanent",open:o,children:[m.jsx(uo,{sx:{display:"flex",alignItems:"center",justifyContent:"flex-end",px:[1]},children:m.jsx(Di,{onClick:d,children:m.jsx(oa,{})})}),m.jsx(Su,{}),m.jsx(Cu,{component:"nav",children:Hl.map(f=>m.jsx(Lu,{disablePadding:!0,sx:{display:"block"},children:m.jsxs(Tu,{component:Zu,to:f.path,selected:u.pathname===f.path,sx:{minHeight:48,justifyContent:o?"initial":"center",px:2.5},children:[m.jsx(Au,{sx:{minWidth:0,mr:o?3:"auto",justifyContent:"center"},children:f.icon}),m.jsx(Mu,{primary:f.text,sx:{opacity:o?1:0}})]})},f.text))})]}),m.jsx(wt,{component:"main",sx:{backgroundColor:f=>f.palette.mode==="light"?f.palette.grey[100]:f.palette.grey[900],flexGrow:1,height:"100vh",overflow:"auto",pt:8},children:m.jsx(Hu,{})})]})}function ql(){const o=Go(),[n,i]=E.useState(""),[s,a]=E.useState(""),[u,l]=E.useState(""),d=async f=>{f.preventDefault();try{const v=await fetch("/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n,password:s})});if(v.ok){const y=await v.json();document.cookie=`token=${y.token}; path=/`,o("/search")}else l("Invalid username or password")}catch{l("An error occurred. Please try again.")}};return m.jsx(ci,{component:"main",maxWidth:"xs",children:m.jsx(wt,{sx:{marginTop:8,display:"flex",flexDirection:"column",alignItems:"center"},children:m.jsxs(Xt,{elevation:3,sx:{padding:4,display:"flex",flexDirection:"column",alignItems:"center",width:"100%"},children:[m.jsx(Q,{component:"h1",variant:"h5",children:"CloudPerf Login"}),m.jsxs(wt,{component:"form",onSubmit:d,sx:{mt:1,width:"100%"},children:[u&&m.jsx(ku,{severity:"error",sx:{mb:2},children:u}),m.jsx(At,{margin:"normal",required:!0,fullWidth:!0,id:"username",label:"Username",name:"username",autoComplete:"username",autoFocus:!0,value:n,onChange:f=>i(f.target.value)}),m.jsx(At,{margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",value:s,onChange:f=>a(f.target.value)}),m.jsx(Zt,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},children:"Sign In"})]})]})})})}function ca(o,n){const i=E.useRef(n);E.useEffect(function(){n!==i.current&&o.attributionControl!=null&&(i.current!=null&&o.attributionControl.removeAttribution(i.current),n!=null&&o.attributionControl.addAttribution(n)),i.current=n},[o,n])}const Ul=1;function Wl(o){return Object.freeze({__version:Ul,map:o})}function da(o,n){return Object.freeze({...o,...n})}const fa=E.createContext(null),pa=fa.Provider;function Fr(){const o=E.useContext(fa);if(o==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return o}function ma(o){function n(i,s){const{instance:a,context:u}=o(i).current;return E.useImperativeHandle(s,()=>a),i.children==null?null:Bi.createElement(pa,{value:u},i.children)}return E.forwardRef(n)}function Kl(o){function n(i,s){const[a,u]=E.useState(!1),{instance:l}=o(i,u).current;E.useImperativeHandle(s,()=>l),E.useEffect(function(){a&&l.update()},[l,a,i.children]);const d=l._contentNode;return d?Ko.createPortal(i.children,d):null}return E.forwardRef(n)}function Gl(o){function n(i,s){const{instance:a}=o(i).current;return E.useImperativeHandle(s,()=>a),null}return E.forwardRef(n)}function jr(o,n){const i=E.useRef();E.useEffect(function(){return n!=null&&o.instance.on(n),i.current=n,function(){i.current!=null&&o.instance.off(i.current),i.current=null}},[o,n])}function Ji(o,n){const i=o.pane??n.pane;return i?{...o,pane:i}:o}function Yl(o,n){return function(s,a){const u=Fr(),l=o(Ji(s,u),u);return ca(u.map,s.attribution),jr(l.current,s.eventHandlers),n(l.current,u,s,a),l}}var mr={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(o,n){(function(i,s){s(n)})(oe,function(i){var s="1.9.4";function a(t){var e,r,h,c;for(r=1,h=arguments.length;r<h;r++){c=arguments[r];for(e in c)t[e]=c[e]}return t}var u=Object.create||function(){function t(){}return function(e){return t.prototype=e,new t}}();function l(t,e){var r=Array.prototype.slice;if(t.bind)return t.bind.apply(t,r.call(arguments,1));var h=r.call(arguments,2);return function(){return t.apply(e,h.length?h.concat(r.call(arguments)):arguments)}}var d=0;function f(t){return"_leaflet_id"in t||(t._leaflet_id=++d),t._leaflet_id}function v(t,e,r){var h,c,p,g;return g=function(){h=!1,c&&(p.apply(r,c),c=!1)},p=function(){h?c=arguments:(t.apply(r,arguments),setTimeout(g,e),h=!0)},p}function y(t,e,r){var h=e[1],c=e[0],p=h-c;return t===h&&r?t:((t-c)%p+p)%p+c}function _(){return!1}function x(t,e){if(e===!1)return t;var r=Math.pow(10,e===void 0?6:e);return Math.round(t*r)/r}function P(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function A(t){return P(t).split(/\s+/)}function M(t,e){Object.prototype.hasOwnProperty.call(t,"options")||(t.options=t.options?u(t.options):{});for(var r in e)t.options[r]=e[r];return t.options}function T(t,e,r){var h=[];for(var c in t)h.push(encodeURIComponent(r?c.toUpperCase():c)+"="+encodeURIComponent(t[c]));return(!e||e.indexOf("?")===-1?"?":"&")+h.join("&")}var j=/\{ *([\w_ -]+) *\}/g;function U(t,e){return t.replace(j,function(r,h){var c=e[h];if(c===void 0)throw new Error("No value provided for variable "+r);return typeof c=="function"&&(c=c(e)),c})}var rt=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};function yt(t,e){for(var r=0;r<t.length;r++)if(t[r]===e)return r;return-1}var he="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function Ue(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}var We=0;function Le(t){var e=+new Date,r=Math.max(0,16-(e-We));return We=e+r,window.setTimeout(t,r)}var Ke=window.requestAnimationFrame||Ue("RequestAnimationFrame")||Le,mt=window.cancelAnimationFrame||Ue("CancelAnimationFrame")||Ue("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)};function vt(t,e,r){if(r&&Ke===Le)t.call(e);else return Ke.call(window,l(t,e))}function bt(t){t&&mt.call(window,t)}var hn={__proto__:null,extend:a,create:u,bind:l,get lastId(){return d},stamp:f,throttle:v,wrapNum:y,falseFn:_,formatNum:x,trim:P,splitWords:A,setOptions:M,getParamString:T,template:U,isArray:rt,indexOf:yt,emptyImageUrl:he,requestFn:Ke,cancelFn:mt,requestAnimFrame:vt,cancelAnimFrame:bt};function S(){}S.extend=function(t){var e=function(){M(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},r=e.__super__=this.prototype,h=u(r);h.constructor=e,e.prototype=h;for(var c in this)Object.prototype.hasOwnProperty.call(this,c)&&c!=="prototype"&&c!=="__super__"&&(e[c]=this[c]);return t.statics&&a(e,t.statics),t.includes&&(K(t.includes),a.apply(null,[h].concat(t.includes))),a(h,t),delete h.statics,delete h.includes,h.options&&(h.options=r.options?u(r.options):{},a(h.options,t.options)),h._initHooks=[],h.callInitHooks=function(){if(!this._initHooksCalled){r.callInitHooks&&r.callInitHooks.call(this),this._initHooksCalled=!0;for(var p=0,g=h._initHooks.length;p<g;p++)h._initHooks[p].call(this)}},e},S.include=function(t){var e=this.prototype.options;return a(this.prototype,t),t.options&&(this.prototype.options=e,this.mergeOptions(t.options)),this},S.mergeOptions=function(t){return a(this.prototype.options,t),this},S.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),r=typeof t=="function"?t:function(){this[t].apply(this,e)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(r),this};function K(t){if(!(typeof L>"u"||!L||!L.Mixin)){t=rt(t)?t:[t];for(var e=0;e<t.length;e++)t[e]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var st={on:function(t,e,r){if(typeof t=="object")for(var h in t)this._on(h,t[h],e);else{t=A(t);for(var c=0,p=t.length;c<p;c++)this._on(t[c],e,r)}return this},off:function(t,e,r){if(!arguments.length)delete this._events;else if(typeof t=="object")for(var h in t)this._off(h,t[h],e);else{t=A(t);for(var c=arguments.length===1,p=0,g=t.length;p<g;p++)c?this._off(t[p]):this._off(t[p],e,r)}return this},_on:function(t,e,r,h){if(typeof e!="function"){console.warn("wrong listener type: "+typeof e);return}if(this._listens(t,e,r)===!1){r===this&&(r=void 0);var c={fn:e,ctx:r};h&&(c.once=!0),this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(c)}},_off:function(t,e,r){var h,c,p;if(this._events&&(h=this._events[t],!!h)){if(arguments.length===1){if(this._firingCount)for(c=0,p=h.length;c<p;c++)h[c].fn=_;delete this._events[t];return}if(typeof e!="function"){console.warn("wrong listener type: "+typeof e);return}var g=this._listens(t,e,r);if(g!==!1){var w=h[g];this._firingCount&&(w.fn=_,this._events[t]=h=h.slice()),h.splice(g,1)}}},fire:function(t,e,r){if(!this.listens(t,r))return this;var h=a({},e,{type:t,target:this,sourceTarget:e&&e.sourceTarget||this});if(this._events){var c=this._events[t];if(c){this._firingCount=this._firingCount+1||1;for(var p=0,g=c.length;p<g;p++){var w=c[p],b=w.fn;w.once&&this.off(t,b,w.ctx),b.call(w.ctx||this,h)}this._firingCount--}}return r&&this._propagateEvent(h),this},listens:function(t,e,r,h){typeof t!="string"&&console.warn('"string" type argument expected');var c=e;typeof e!="function"&&(h=!!e,c=void 0,r=void 0);var p=this._events&&this._events[t];if(p&&p.length&&this._listens(t,c,r)!==!1)return!0;if(h){for(var g in this._eventParents)if(this._eventParents[g].listens(t,e,r,h))return!0}return!1},_listens:function(t,e,r){if(!this._events)return!1;var h=this._events[t]||[];if(!e)return!!h.length;r===this&&(r=void 0);for(var c=0,p=h.length;c<p;c++)if(h[c].fn===e&&h[c].ctx===r)return c;return!1},once:function(t,e,r){if(typeof t=="object")for(var h in t)this._on(h,t[h],e,!0);else{t=A(t);for(var c=0,p=t.length;c<p;c++)this._on(t[c],e,r,!0)}return this},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[f(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[f(t)],this},_propagateEvent:function(t){for(var e in this._eventParents)this._eventParents[e].fire(t.type,a({layer:t.target,propagatedFrom:t.target},t),!0)}};st.addEventListener=st.on,st.removeEventListener=st.clearAllEventListeners=st.off,st.addOneTimeEventListener=st.once,st.fireEvent=st.fire,st.hasEventListeners=st.listens;var J=S.extend(st);function F(t,e,r){this.x=r?Math.round(t):t,this.y=r?Math.round(e):e}var Xr=Math.trunc||function(t){return t>0?Math.floor(t):Math.ceil(t)};F.prototype={clone:function(){return new F(this.x,this.y)},add:function(t){return this.clone()._add(N(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(N(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new F(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new F(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Xr(this.x),this.y=Xr(this.y),this},distanceTo:function(t){t=N(t);var e=t.x-this.x,r=t.y-this.y;return Math.sqrt(e*e+r*r)},equals:function(t){return t=N(t),t.x===this.x&&t.y===this.y},contains:function(t){return t=N(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+x(this.x)+", "+x(this.y)+")"}};function N(t,e,r){return t instanceof F?t:rt(t)?new F(t[0],t[1]):t==null?t:typeof t=="object"&&"x"in t&&"y"in t?new F(t.x,t.y):new F(t,e,r)}function it(t,e){if(t)for(var r=e?[t,e]:t,h=0,c=r.length;h<c;h++)this.extend(r[h])}it.prototype={extend:function(t){var e,r;if(!t)return this;if(t instanceof F||typeof t[0]=="number"||"x"in t)e=r=N(t);else if(t=Pt(t),e=t.min,r=t.max,!e||!r)return this;return!this.min&&!this.max?(this.min=e.clone(),this.max=r.clone()):(this.min.x=Math.min(e.x,this.min.x),this.max.x=Math.max(r.x,this.max.x),this.min.y=Math.min(e.y,this.min.y),this.max.y=Math.max(r.y,this.max.y)),this},getCenter:function(t){return N((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return N(this.min.x,this.max.y)},getTopRight:function(){return N(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,r;return typeof t[0]=="number"||t instanceof F?t=N(t):t=Pt(t),t instanceof it?(e=t.min,r=t.max):e=r=t,e.x>=this.min.x&&r.x<=this.max.x&&e.y>=this.min.y&&r.y<=this.max.y},intersects:function(t){t=Pt(t);var e=this.min,r=this.max,h=t.min,c=t.max,p=c.x>=e.x&&h.x<=r.x,g=c.y>=e.y&&h.y<=r.y;return p&&g},overlaps:function(t){t=Pt(t);var e=this.min,r=this.max,h=t.min,c=t.max,p=c.x>e.x&&h.x<r.x,g=c.y>e.y&&h.y<r.y;return p&&g},isValid:function(){return!!(this.min&&this.max)},pad:function(t){var e=this.min,r=this.max,h=Math.abs(e.x-r.x)*t,c=Math.abs(e.y-r.y)*t;return Pt(N(e.x-h,e.y-c),N(r.x+h,r.y+c))},equals:function(t){return t?(t=Pt(t),this.min.equals(t.getTopLeft())&&this.max.equals(t.getBottomRight())):!1}};function Pt(t,e){return!t||t instanceof it?t:new it(t,e)}function St(t,e){if(t)for(var r=e?[t,e]:t,h=0,c=r.length;h<c;h++)this.extend(r[h])}St.prototype={extend:function(t){var e=this._southWest,r=this._northEast,h,c;if(t instanceof Y)h=t,c=t;else if(t instanceof St){if(h=t._southWest,c=t._northEast,!h||!c)return this}else return t?this.extend($(t)||ht(t)):this;return!e&&!r?(this._southWest=new Y(h.lat,h.lng),this._northEast=new Y(c.lat,c.lng)):(e.lat=Math.min(h.lat,e.lat),e.lng=Math.min(h.lng,e.lng),r.lat=Math.max(c.lat,r.lat),r.lng=Math.max(c.lng,r.lng)),this},pad:function(t){var e=this._southWest,r=this._northEast,h=Math.abs(e.lat-r.lat)*t,c=Math.abs(e.lng-r.lng)*t;return new St(new Y(e.lat-h,e.lng-c),new Y(r.lat+h,r.lng+c))},getCenter:function(){return new Y((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Y(this.getNorth(),this.getWest())},getSouthEast:function(){return new Y(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){typeof t[0]=="number"||t instanceof Y||"lat"in t?t=$(t):t=ht(t);var e=this._southWest,r=this._northEast,h,c;return t instanceof St?(h=t.getSouthWest(),c=t.getNorthEast()):h=c=t,h.lat>=e.lat&&c.lat<=r.lat&&h.lng>=e.lng&&c.lng<=r.lng},intersects:function(t){t=ht(t);var e=this._southWest,r=this._northEast,h=t.getSouthWest(),c=t.getNorthEast(),p=c.lat>=e.lat&&h.lat<=r.lat,g=c.lng>=e.lng&&h.lng<=r.lng;return p&&g},overlaps:function(t){t=ht(t);var e=this._southWest,r=this._northEast,h=t.getSouthWest(),c=t.getNorthEast(),p=c.lat>e.lat&&h.lat<r.lat,g=c.lng>e.lng&&h.lng<r.lng;return p&&g},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t,e){return t?(t=ht(t),this._southWest.equals(t.getSouthWest(),e)&&this._northEast.equals(t.getNorthEast(),e)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function ht(t,e){return t instanceof St?t:new St(t,e)}function Y(t,e,r){if(isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=+t,this.lng=+e,r!==void 0&&(this.alt=+r)}Y.prototype={equals:function(t,e){if(!t)return!1;t=$(t);var r=Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng));return r<=(e===void 0?1e-9:e)},toString:function(t){return"LatLng("+x(this.lat,t)+", "+x(this.lng,t)+")"},distanceTo:function(t){return ue.distance(this,$(t))},wrap:function(){return ue.wrapLatLng(this)},toBounds:function(t){var e=180*t/40075017,r=e/Math.cos(Math.PI/180*this.lat);return ht([this.lat-e,this.lng-r],[this.lat+e,this.lng+r])},clone:function(){return new Y(this.lat,this.lng,this.alt)}};function $(t,e,r){return t instanceof Y?t:rt(t)&&typeof t[0]!="object"?t.length===3?new Y(t[0],t[1],t[2]):t.length===2?new Y(t[0],t[1]):null:t==null?t:typeof t=="object"&&"lat"in t?new Y(t.lat,"lng"in t?t.lng:t.lon,t.alt):e===void 0?null:new Y(t,e,r)}var ee={latLngToPoint:function(t,e){var r=this.projection.project(t),h=this.scale(e);return this.transformation._transform(r,h)},pointToLatLng:function(t,e){var r=this.scale(e),h=this.transformation.untransform(t,r);return this.projection.unproject(h)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var e=this.projection.bounds,r=this.scale(t),h=this.transformation.transform(e.min,r),c=this.transformation.transform(e.max,r);return new it(h,c)},infinite:!1,wrapLatLng:function(t){var e=this.wrapLng?y(t.lng,this.wrapLng,!0):t.lng,r=this.wrapLat?y(t.lat,this.wrapLat,!0):t.lat,h=t.alt;return new Y(r,e,h)},wrapLatLngBounds:function(t){var e=t.getCenter(),r=this.wrapLatLng(e),h=e.lat-r.lat,c=e.lng-r.lng;if(h===0&&c===0)return t;var p=t.getSouthWest(),g=t.getNorthEast(),w=new Y(p.lat-h,p.lng-c),b=new Y(g.lat-h,g.lng-c);return new St(w,b)}},ue=a({},ee,{wrapLng:[-180,180],R:6371e3,distance:function(t,e){var r=Math.PI/180,h=t.lat*r,c=e.lat*r,p=Math.sin((e.lat-t.lat)*r/2),g=Math.sin((e.lng-t.lng)*r/2),w=p*p+Math.cos(h)*Math.cos(c)*g*g,b=2*Math.atan2(Math.sqrt(w),Math.sqrt(1-w));return this.R*b}}),Qr=6378137,un={R:Qr,MAX_LATITUDE:85.0511287798,project:function(t){var e=Math.PI/180,r=this.MAX_LATITUDE,h=Math.max(Math.min(r,t.lat),-r),c=Math.sin(h*e);return new F(this.R*t.lng*e,this.R*Math.log((1+c)/(1-c))/2)},unproject:function(t){var e=180/Math.PI;return new Y((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*e,t.x*e/this.R)},bounds:function(){var t=Qr*Math.PI;return new it([-t,-t],[t,t])}()};function ln(t,e,r,h){if(rt(t)){this._a=t[0],this._b=t[1],this._c=t[2],this._d=t[3];return}this._a=t,this._b=e,this._c=r,this._d=h}ln.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new F((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}};function Ge(t,e,r,h){return new ln(t,e,r,h)}var cn=a({},ue,{code:"EPSG:3857",projection:un,transformation:function(){var t=.5/(Math.PI*un.R);return Ge(t,.5,-t,.5)}()}),Ja=a({},cn,{code:"EPSG:900913"});function ts(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function es(t,e){var r="",h,c,p,g,w,b;for(h=0,p=t.length;h<p;h++){for(w=t[h],c=0,g=w.length;c<g;c++)b=w[c],r+=(c?"L":"M")+b.x+" "+b.y;r+=e?I.svg?"z":"x":""}return r||"M0 0"}var dn=document.documentElement.style,gi="ActiveXObject"in window,Xa=gi&&!document.addEventListener,is="msLaunchUri"in navigator&&!("documentMode"in document),fn=Kt("webkit"),ns=Kt("android"),rs=Kt("android 2")||Kt("android 3"),Qa=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),th=ns&&Kt("Google")&&Qa<537&&!("AudioNode"in window),pn=!!window.opera,ss=!is&&Kt("chrome"),os=Kt("gecko")&&!fn&&!pn&&!gi,eh=!ss&&Kt("safari"),as=Kt("phantom"),hs="OTransition"in dn,ih=navigator.platform.indexOf("Win")===0,us=gi&&"transition"in dn,mn="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!rs,ls="MozPerspective"in dn,nh=!window.L_DISABLE_3D&&(us||mn||ls)&&!hs&&!as,Ye=typeof orientation<"u"||Kt("mobile"),rh=Ye&&fn,sh=Ye&&mn,cs=!window.PointerEvent&&window.MSPointerEvent,ds=!!(window.PointerEvent||cs),fs="ontouchstart"in window||!!window.TouchEvent,oh=!window.L_NO_TOUCH&&(fs||ds),ah=Ye&&pn,hh=Ye&&os,uh=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,lh=function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassiveEventSupport",_,e),window.removeEventListener("testPassiveEventSupport",_,e)}catch{}return t}(),ch=function(){return!!document.createElement("canvas").getContext}(),_n=!!(document.createElementNS&&ts("svg").createSVGRect),dh=!!_n&&function(){var t=document.createElement("div");return t.innerHTML="<svg/>",(t.firstChild&&t.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),fh=!_n&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var e=t.firstChild;return e.style.behavior="url(#default#VML)",e&&typeof e.adj=="object"}catch{return!1}}(),ph=navigator.platform.indexOf("Mac")===0,mh=navigator.platform.indexOf("Linux")===0;function Kt(t){return navigator.userAgent.toLowerCase().indexOf(t)>=0}var I={ie:gi,ielt9:Xa,edge:is,webkit:fn,android:ns,android23:rs,androidStock:th,opera:pn,chrome:ss,gecko:os,safari:eh,phantom:as,opera12:hs,win:ih,ie3d:us,webkit3d:mn,gecko3d:ls,any3d:nh,mobile:Ye,mobileWebkit:rh,mobileWebkit3d:sh,msPointer:cs,pointer:ds,touch:oh,touchNative:fs,mobileOpera:ah,mobileGecko:hh,retina:uh,passiveEvents:lh,canvas:ch,svg:_n,vml:fh,inlineSvg:dh,mac:ph,linux:mh},ps=I.msPointer?"MSPointerDown":"pointerdown",ms=I.msPointer?"MSPointerMove":"pointermove",_s=I.msPointer?"MSPointerUp":"pointerup",vs=I.msPointer?"MSPointerCancel":"pointercancel",vn={touchstart:ps,touchmove:ms,touchend:_s,touchcancel:vs},gs={touchstart:wh,touchmove:yi,touchend:yi,touchcancel:yi},Te={},ys=!1;function _h(t,e,r){return e==="touchstart"&&xh(),gs[e]?(r=gs[e].bind(this,r),t.addEventListener(vn[e],r,!1),r):(console.warn("wrong event specified:",e),_)}function vh(t,e,r){if(!vn[e]){console.warn("wrong event specified:",e);return}t.removeEventListener(vn[e],r,!1)}function gh(t){Te[t.pointerId]=t}function yh(t){Te[t.pointerId]&&(Te[t.pointerId]=t)}function xs(t){delete Te[t.pointerId]}function xh(){ys||(document.addEventListener(ps,gh,!0),document.addEventListener(ms,yh,!0),document.addEventListener(_s,xs,!0),document.addEventListener(vs,xs,!0),ys=!0)}function yi(t,e){if(e.pointerType!==(e.MSPOINTER_TYPE_MOUSE||"mouse")){e.touches=[];for(var r in Te)e.touches.push(Te[r]);e.changedTouches=[e],t(e)}}function wh(t,e){e.MSPOINTER_TYPE_TOUCH&&e.pointerType===e.MSPOINTER_TYPE_TOUCH&&_t(e),yi(t,e)}function bh(t){var e={},r,h;for(h in t)r=t[h],e[h]=r&&r.bind?r.bind(t):r;return t=e,e.type="dblclick",e.detail=2,e.isTrusted=!1,e._simulated=!0,e}var Ph=200;function Sh(t,e){t.addEventListener("dblclick",e);var r=0,h;function c(p){if(p.detail!==1){h=p.detail;return}if(!(p.pointerType==="mouse"||p.sourceCapabilities&&!p.sourceCapabilities.firesTouchEvents)){var g=Cs(p);if(!(g.some(function(b){return b instanceof HTMLLabelElement&&b.attributes.for})&&!g.some(function(b){return b instanceof HTMLInputElement||b instanceof HTMLSelectElement}))){var w=Date.now();w-r<=Ph?(h++,h===2&&e(bh(p))):h=1,r=w}}}return t.addEventListener("click",c),{dblclick:e,simDblclick:c}}function Ch(t,e){t.removeEventListener("dblclick",e.dblclick),t.removeEventListener("click",e.simDblclick)}var gn=bi(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Ve=bi(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),ws=Ve==="webkitTransition"||Ve==="OTransition"?Ve+"End":"transitionend";function bs(t){return typeof t=="string"?document.getElementById(t):t}function Je(t,e){var r=t.style[e]||t.currentStyle&&t.currentStyle[e];if((!r||r==="auto")&&document.defaultView){var h=document.defaultView.getComputedStyle(t,null);r=h?h[e]:null}return r==="auto"?null:r}function W(t,e,r){var h=document.createElement(t);return h.className=e||"",r&&r.appendChild(h),h}function nt(t){var e=t.parentNode;e&&e.removeChild(t)}function xi(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function Ae(t){var e=t.parentNode;e&&e.lastChild!==t&&e.appendChild(t)}function Me(t){var e=t.parentNode;e&&e.firstChild!==t&&e.insertBefore(t,e.firstChild)}function yn(t,e){if(t.classList!==void 0)return t.classList.contains(e);var r=wi(t);return r.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(r)}function B(t,e){if(t.classList!==void 0)for(var r=A(e),h=0,c=r.length;h<c;h++)t.classList.add(r[h]);else if(!yn(t,e)){var p=wi(t);xn(t,(p?p+" ":"")+e)}}function ot(t,e){t.classList!==void 0?t.classList.remove(e):xn(t,P((" "+wi(t)+" ").replace(" "+e+" "," ")))}function xn(t,e){t.className.baseVal===void 0?t.className=e:t.className.baseVal=e}function wi(t){return t.correspondingElement&&(t=t.correspondingElement),t.className.baseVal===void 0?t.className:t.className.baseVal}function It(t,e){"opacity"in t.style?t.style.opacity=e:"filter"in t.style&&Lh(t,e)}function Lh(t,e){var r=!1,h="DXImageTransform.Microsoft.Alpha";try{r=t.filters.item(h)}catch{if(e===1)return}e=Math.round(e*100),r?(r.Enabled=e!==100,r.Opacity=e):t.style.filter+=" progid:"+h+"(opacity="+e+")"}function bi(t){for(var e=document.documentElement.style,r=0;r<t.length;r++)if(t[r]in e)return t[r];return!1}function ve(t,e,r){var h=e||new F(0,0);t.style[gn]=(I.ie3d?"translate("+h.x+"px,"+h.y+"px)":"translate3d("+h.x+"px,"+h.y+"px,0)")+(r?" scale("+r+")":"")}function ut(t,e){t._leaflet_pos=e,I.any3d?ve(t,e):(t.style.left=e.x+"px",t.style.top=e.y+"px")}function ge(t){return t._leaflet_pos||new F(0,0)}var Xe,Qe,wn;if("onselectstart"in document)Xe=function(){D(window,"selectstart",_t)},Qe=function(){X(window,"selectstart",_t)};else{var ti=bi(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Xe=function(){if(ti){var t=document.documentElement.style;wn=t[ti],t[ti]="none"}},Qe=function(){ti&&(document.documentElement.style[ti]=wn,wn=void 0)}}function bn(){D(window,"dragstart",_t)}function Pn(){X(window,"dragstart",_t)}var Pi,Sn;function Cn(t){for(;t.tabIndex===-1;)t=t.parentNode;t.style&&(Si(),Pi=t,Sn=t.style.outlineStyle,t.style.outlineStyle="none",D(window,"keydown",Si))}function Si(){Pi&&(Pi.style.outlineStyle=Sn,Pi=void 0,Sn=void 0,X(window,"keydown",Si))}function Ps(t){do t=t.parentNode;while((!t.offsetWidth||!t.offsetHeight)&&t!==document.body);return t}function Ln(t){var e=t.getBoundingClientRect();return{x:e.width/t.offsetWidth||1,y:e.height/t.offsetHeight||1,boundingClientRect:e}}var Th={__proto__:null,TRANSFORM:gn,TRANSITION:Ve,TRANSITION_END:ws,get:bs,getStyle:Je,create:W,remove:nt,empty:xi,toFront:Ae,toBack:Me,hasClass:yn,addClass:B,removeClass:ot,setClass:xn,getClass:wi,setOpacity:It,testProp:bi,setTransform:ve,setPosition:ut,getPosition:ge,get disableTextSelection(){return Xe},get enableTextSelection(){return Qe},disableImageDrag:bn,enableImageDrag:Pn,preventOutline:Cn,restoreOutline:Si,getSizedParentNode:Ps,getScale:Ln};function D(t,e,r,h){if(e&&typeof e=="object")for(var c in e)An(t,c,e[c],r);else{e=A(e);for(var p=0,g=e.length;p<g;p++)An(t,e[p],r,h)}return this}var Gt="_leaflet_events";function X(t,e,r,h){if(arguments.length===1)Ss(t),delete t[Gt];else if(e&&typeof e=="object")for(var c in e)Mn(t,c,e[c],r);else if(e=A(e),arguments.length===2)Ss(t,function(w){return yt(e,w)!==-1});else for(var p=0,g=e.length;p<g;p++)Mn(t,e[p],r,h);return this}function Ss(t,e){for(var r in t[Gt]){var h=r.split(/\d/)[0];(!e||e(h))&&Mn(t,h,null,null,r)}}var Tn={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function An(t,e,r,h){var c=e+f(r)+(h?"_"+f(h):"");if(t[Gt]&&t[Gt][c])return this;var p=function(w){return r.call(h||t,w||window.event)},g=p;!I.touchNative&&I.pointer&&e.indexOf("touch")===0?p=_h(t,e,p):I.touch&&e==="dblclick"?p=Sh(t,p):"addEventListener"in t?e==="touchstart"||e==="touchmove"||e==="wheel"||e==="mousewheel"?t.addEventListener(Tn[e]||e,p,I.passiveEvents?{passive:!1}:!1):e==="mouseenter"||e==="mouseleave"?(p=function(w){w=w||window.event,En(t,w)&&g(w)},t.addEventListener(Tn[e],p,!1)):t.addEventListener(e,g,!1):t.attachEvent("on"+e,p),t[Gt]=t[Gt]||{},t[Gt][c]=p}function Mn(t,e,r,h,c){c=c||e+f(r)+(h?"_"+f(h):"");var p=t[Gt]&&t[Gt][c];if(!p)return this;!I.touchNative&&I.pointer&&e.indexOf("touch")===0?vh(t,e,p):I.touch&&e==="dblclick"?Ch(t,p):"removeEventListener"in t?t.removeEventListener(Tn[e]||e,p,!1):t.detachEvent("on"+e,p),t[Gt][c]=null}function ye(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,this}function kn(t){return An(t,"wheel",ye),this}function ei(t){return D(t,"mousedown touchstart dblclick contextmenu",ye),t._leaflet_disable_click=!0,this}function _t(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function xe(t){return _t(t),ye(t),this}function Cs(t){if(t.composedPath)return t.composedPath();for(var e=[],r=t.target;r;)e.push(r),r=r.parentNode;return e}function Ls(t,e){if(!e)return new F(t.clientX,t.clientY);var r=Ln(e),h=r.boundingClientRect;return new F((t.clientX-h.left)/r.x-e.clientLeft,(t.clientY-h.top)/r.y-e.clientTop)}var Ah=I.linux&&I.chrome?window.devicePixelRatio:I.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Ts(t){return I.edge?t.wheelDeltaY/2:t.deltaY&&t.deltaMode===0?-t.deltaY/Ah:t.deltaY&&t.deltaMode===1?-t.deltaY*20:t.deltaY&&t.deltaMode===2?-t.deltaY*60:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?-t.detail*20:t.detail?t.detail/-32765*60:0}function En(t,e){var r=e.relatedTarget;if(!r)return!0;try{for(;r&&r!==t;)r=r.parentNode}catch{return!1}return r!==t}var Mh={__proto__:null,on:D,off:X,stopPropagation:ye,disableScrollPropagation:kn,disableClickPropagation:ei,preventDefault:_t,stop:xe,getPropagationPath:Cs,getMousePosition:Ls,getWheelDelta:Ts,isExternalTarget:En,addListener:D,removeListener:X},As=J.extend({run:function(t,e,r,h){this.stop(),this._el=t,this._inProgress=!0,this._duration=r||.25,this._easeOutPower=1/Math.max(h||.5,.2),this._startPos=ge(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=vt(this._animate,this),this._step()},_step:function(t){var e=+new Date-this._startTime,r=this._duration*1e3;e<r?this._runFrame(this._easeOut(e/r),t):(this._runFrame(1),this._complete())},_runFrame:function(t,e){var r=this._startPos.add(this._offset.multiplyBy(t));e&&r._round(),ut(this._el,r),this.fire("step")},_complete:function(){bt(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),q=J.extend({options:{crs:cn,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,e){e=M(this,e),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(t),this._initLayout(),this._onResize=l(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),e.zoom!==void 0&&(this._zoom=this._limitZoom(e.zoom)),e.center&&e.zoom!==void 0&&this.setView($(e.center),e.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Ve&&I.any3d&&!I.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),D(this._proxy,ws,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,e,r){if(e=e===void 0?this._zoom:this._limitZoom(e),t=this._limitCenter($(t),e,this.options.maxBounds),r=r||{},this._stop(),this._loaded&&!r.reset&&r!==!0){r.animate!==void 0&&(r.zoom=a({animate:r.animate},r.zoom),r.pan=a({animate:r.animate,duration:r.duration},r.pan));var h=this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,r.zoom):this._tryAnimatedPan(t,r.pan);if(h)return clearTimeout(this._sizeTimer),this}return this._resetView(t,e,r.pan&&r.pan.noMoveStart),this},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=t,this)},zoomIn:function(t,e){return t=t||(I.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+t,e)},zoomOut:function(t,e){return t=t||(I.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-t,e)},setZoomAround:function(t,e,r){var h=this.getZoomScale(e),c=this.getSize().divideBy(2),p=t instanceof F?t:this.latLngToContainerPoint(t),g=p.subtract(c).multiplyBy(1-1/h),w=this.containerPointToLatLng(c.add(g));return this.setView(w,e,{zoom:r})},_getBoundsCenterZoom:function(t,e){e=e||{},t=t.getBounds?t.getBounds():ht(t);var r=N(e.paddingTopLeft||e.padding||[0,0]),h=N(e.paddingBottomRight||e.padding||[0,0]),c=this.getBoundsZoom(t,!1,r.add(h));if(c=typeof e.maxZoom=="number"?Math.min(e.maxZoom,c):c,c===1/0)return{center:t.getCenter(),zoom:c};var p=h.subtract(r).divideBy(2),g=this.project(t.getSouthWest(),c),w=this.project(t.getNorthEast(),c),b=this.unproject(g.add(w).divideBy(2).add(p),c);return{center:b,zoom:c}},fitBounds:function(t,e){if(t=ht(t),!t.isValid())throw new Error("Bounds are not valid.");var r=this._getBoundsCenterZoom(t,e);return this.setView(r.center,r.zoom,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t,e){if(t=N(t).round(),e=e||{},!t.x&&!t.y)return this.fire("moveend");if(e.animate!==!0&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new As,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),e.animate!==!1){B(this._mapPane,"leaflet-pan-anim");var r=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,r,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},flyTo:function(t,e,r){if(r=r||{},r.animate===!1||!I.any3d)return this.setView(t,e,r);this._stop();var h=this.project(this.getCenter()),c=this.project(t),p=this.getSize(),g=this._zoom;t=$(t),e=e===void 0?g:e;var w=Math.max(p.x,p.y),b=w*this.getZoomScale(g,e),C=c.distanceTo(h)||1,k=1.42,R=k*k;function Z(lt){var Fi=lt?-1:1,vu=lt?b:w,gu=b*b-w*w+Fi*R*R*C*C,yu=2*vu*R*C,Hn=gu/yu,ho=Math.sqrt(Hn*Hn+1)-Hn,xu=ho<1e-9?-18:Math.log(ho);return xu}function xt(lt){return(Math.exp(lt)-Math.exp(-lt))/2}function pt(lt){return(Math.exp(lt)+Math.exp(-lt))/2}function Ot(lt){return xt(lt)/pt(lt)}var Ct=Z(0);function ze(lt){return w*(pt(Ct)/pt(Ct+k*lt))}function fu(lt){return w*(pt(Ct)*Ot(Ct+k*lt)-xt(Ct))/R}function pu(lt){return 1-Math.pow(1-lt,1.5)}var mu=Date.now(),oo=(Z(1)-Ct)/k,_u=r.duration?1e3*r.duration:1e3*oo*.8;function ao(){var lt=(Date.now()-mu)/_u,Fi=pu(lt)*oo;lt<=1?(this._flyToFrame=vt(ao,this),this._move(this.unproject(h.add(c.subtract(h).multiplyBy(fu(Fi)/C)),g),this.getScaleZoom(w/ze(Fi),g),{flyTo:!0})):this._move(t,e)._moveEnd(!0)}return this._moveStart(!0,r.noMoveStart),ao.call(this),this},flyToBounds:function(t,e){var r=this._getBoundsCenterZoom(t,e);return this.flyTo(r.center,r.zoom,e)},setMaxBounds:function(t){return t=ht(t),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),t.isValid()?(this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(t){var e=this.options.minZoom;return this.options.minZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(t):this},setMaxZoom:function(t){var e=this.options.maxZoom;return this.options.maxZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(t):this},panInsideBounds:function(t,e){this._enforcingBounds=!0;var r=this.getCenter(),h=this._limitCenter(r,this._zoom,ht(t));return r.equals(h)||this.panTo(h,e),this._enforcingBounds=!1,this},panInside:function(t,e){e=e||{};var r=N(e.paddingTopLeft||e.padding||[0,0]),h=N(e.paddingBottomRight||e.padding||[0,0]),c=this.project(this.getCenter()),p=this.project(t),g=this.getPixelBounds(),w=Pt([g.min.add(r),g.max.subtract(h)]),b=w.getSize();if(!w.contains(p)){this._enforcingBounds=!0;var C=p.subtract(w.getCenter()),k=w.extend(p).getSize().subtract(b);c.x+=C.x<0?-k.x:k.x,c.y+=C.y<0?-k.y:k.y,this.panTo(this.unproject(c),e),this._enforcingBounds=!1}return this},invalidateSize:function(t){if(!this._loaded)return this;t=a({animate:!1,pan:!0},t===!0?{animate:!0}:t);var e=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var r=this.getSize(),h=e.divideBy(2).round(),c=r.divideBy(2).round(),p=h.subtract(c);return!p.x&&!p.y?this:(t.animate&&t.pan?this.panBy(p):(t.pan&&this._rawPanBy(p),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(l(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:e,newSize:r}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){if(t=this._locateOptions=a({timeout:1e4,watch:!1},t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var e=l(this._handleGeolocationResponse,this),r=l(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(e,r,t):navigator.geolocation.getCurrentPosition(e,r,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){if(this._container._leaflet_id){var e=t.code,r=t.message||(e===1?"permission denied":e===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+r+"."})}},_handleGeolocationResponse:function(t){if(this._container._leaflet_id){var e=t.coords.latitude,r=t.coords.longitude,h=new Y(e,r),c=h.toBounds(t.coords.accuracy*2),p=this._locateOptions;if(p.setView){var g=this.getBoundsZoom(c);this.setView(h,p.maxZoom?Math.min(g,p.maxZoom):g)}var w={latlng:h,bounds:c,timestamp:t.timestamp};for(var b in t.coords)typeof t.coords[b]=="number"&&(w[b]=t.coords[b]);this.fire("locationfound",w)}},addHandler:function(t,e){if(!e)return this;var r=this[t]=new e(this);return this._handlers.push(r),this.options[t]&&r.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),nt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(bt(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var t;for(t in this._layers)this._layers[t].remove();for(t in this._panes)nt(this._panes[t]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(t,e){var r="leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),h=W("div",r,e||this._mapPane);return t&&(this._panes[t]=h),h},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds(),e=this.unproject(t.getBottomLeft()),r=this.unproject(t.getTopRight());return new St(e,r)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,r){t=ht(t),r=N(r||[0,0]);var h=this.getZoom()||0,c=this.getMinZoom(),p=this.getMaxZoom(),g=t.getNorthWest(),w=t.getSouthEast(),b=this.getSize().subtract(r),C=Pt(this.project(w,h),this.project(g,h)).getSize(),k=I.any3d?this.options.zoomSnap:1,R=b.x/C.x,Z=b.y/C.y,xt=e?Math.max(R,Z):Math.min(R,Z);return h=this.getScaleZoom(xt,h),k&&(h=Math.round(h/(k/100))*(k/100),h=e?Math.ceil(h/k)*k:Math.floor(h/k)*k),Math.max(c,Math.min(p,h))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new F(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,e){var r=this._getTopLeftPoint(t,e);return new it(r,r.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(t===void 0?this.getZoom():t)},getPane:function(t){return typeof t=="string"?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,e){var r=this.options.crs;return e=e===void 0?this._zoom:e,r.scale(t)/r.scale(e)},getScaleZoom:function(t,e){var r=this.options.crs;e=e===void 0?this._zoom:e;var h=r.zoom(t*r.scale(e));return isNaN(h)?1/0:h},project:function(t,e){return e=e===void 0?this._zoom:e,this.options.crs.latLngToPoint($(t),e)},unproject:function(t,e){return e=e===void 0?this._zoom:e,this.options.crs.pointToLatLng(N(t),e)},layerPointToLatLng:function(t){var e=N(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){var e=this.project($(t))._round();return e._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng($(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(ht(t))},distance:function(t,e){return this.options.crs.distance($(t),$(e))},containerPointToLayerPoint:function(t){return N(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return N(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(N(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint($(t)))},mouseEventToContainerPoint:function(t){return Ls(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=bs(t);if(e){if(e._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");D(e,"scroll",this._onScroll,this),this._containerId=f(e)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&I.any3d,B(t,"leaflet-container"+(I.touch?" leaflet-touch":"")+(I.retina?" leaflet-retina":"")+(I.ielt9?" leaflet-oldie":"")+(I.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var e=Je(t,"position");e!=="absolute"&&e!=="relative"&&e!=="fixed"&&e!=="sticky"&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),ut(this._mapPane,new F(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(B(t.markerPane,"leaflet-zoom-hide"),B(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,e,r){ut(this._mapPane,new F(0,0));var h=!this._loaded;this._loaded=!0,e=this._limitZoom(e),this.fire("viewprereset");var c=this._zoom!==e;this._moveStart(c,r)._move(t,e)._moveEnd(c),this.fire("viewreset"),h&&this.fire("load")},_moveStart:function(t,e){return t&&this.fire("zoomstart"),e||this.fire("movestart"),this},_move:function(t,e,r,h){e===void 0&&(e=this._zoom);var c=this._zoom!==e;return this._zoom=e,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),h?r&&r.pinch&&this.fire("zoom",r):((c||r&&r.pinch)&&this.fire("zoom",r),this.fire("move",r)),this},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return bt(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){ut(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){this._targets={},this._targets[f(this._container)]=this;var e=t?X:D;e(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&e(window,"resize",this._onResize,this),I.any3d&&this.options.transform3DLimit&&(t?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){bt(this._resizeRequest),this._resizeRequest=vt(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,e){for(var r=[],h,c=e==="mouseout"||e==="mouseover",p=t.target||t.srcElement,g=!1;p;){if(h=this._targets[f(p)],h&&(e==="click"||e==="preclick")&&this._draggableMoved(h)){g=!0;break}if(h&&h.listens(e,!0)&&(c&&!En(p,t)||(r.push(h),c))||p===this._container)break;p=p.parentNode}return!r.length&&!g&&!c&&this.listens(e,!0)&&(r=[this]),r},_isClickDisabled:function(t){for(;t&&t!==this._container;){if(t._leaflet_disable_click)return!0;t=t.parentNode}},_handleDOMEvent:function(t){var e=t.target||t.srcElement;if(!(!this._loaded||e._leaflet_disable_events||t.type==="click"&&this._isClickDisabled(e))){var r=t.type;r==="mousedown"&&Cn(e),this._fireDOMEvent(t,r)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(t,e,r){if(t.type==="click"){var h=a({},t);h.type="preclick",this._fireDOMEvent(h,h.type,r)}var c=this._findEventTargets(t,e);if(r){for(var p=[],g=0;g<r.length;g++)r[g].listens(e,!0)&&p.push(r[g]);c=p.concat(c)}if(c.length){e==="contextmenu"&&_t(t);var w=c[0],b={originalEvent:t};if(t.type!=="keypress"&&t.type!=="keydown"&&t.type!=="keyup"){var C=w.getLatLng&&(!w._radius||w._radius<=10);b.containerPoint=C?this.latLngToContainerPoint(w.getLatLng()):this.mouseEventToContainerPoint(t),b.layerPoint=this.containerPointToLayerPoint(b.containerPoint),b.latlng=C?w.getLatLng():this.layerPointToLatLng(b.layerPoint)}for(g=0;g<c.length;g++)if(c[g].fire(e,b,!0),b.originalEvent._stopped||c[g].options.bubblingMouseEvents===!1&&yt(this._mouseEvents,e)!==-1)return}},_draggableMoved:function(t){return t=t.dragging&&t.dragging.enabled()?t:this,t.dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,e=this._handlers.length;t<e;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,{target:this}):this.on("load",t,e),this},_getMapPanePos:function(){return ge(this._mapPane)||new F(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,e){var r=t&&e!==void 0?this._getNewPixelOrigin(t,e):this.getPixelOrigin();return r.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,e){var r=this.getSize()._divideBy(2);return this.project(t,e)._subtract(r)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,e,r){var h=this._getNewPixelOrigin(r,e);return this.project(t,e)._subtract(h)},_latLngBoundsToNewLayerBounds:function(t,e,r){var h=this._getNewPixelOrigin(r,e);return Pt([this.project(t.getSouthWest(),e)._subtract(h),this.project(t.getNorthWest(),e)._subtract(h),this.project(t.getSouthEast(),e)._subtract(h),this.project(t.getNorthEast(),e)._subtract(h)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,r){if(!r)return t;var h=this.project(t,e),c=this.getSize().divideBy(2),p=new it(h.subtract(c),h.add(c)),g=this._getBoundsOffset(p,r,e);return Math.abs(g.x)<=1&&Math.abs(g.y)<=1?t:this.unproject(h.add(g),e)},_limitOffset:function(t,e){if(!e)return t;var r=this.getPixelBounds(),h=new it(r.min.add(t),r.max.add(t));return t.add(this._getBoundsOffset(h,e))},_getBoundsOffset:function(t,e,r){var h=Pt(this.project(e.getNorthEast(),r),this.project(e.getSouthWest(),r)),c=h.min.subtract(t.min),p=h.max.subtract(t.max),g=this._rebound(c.x,-p.x),w=this._rebound(c.y,-p.y);return new F(g,w)},_rebound:function(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),r=this.getMaxZoom(),h=I.any3d?this.options.zoomSnap:1;return h&&(t=Math.round(t/h)*h),Math.max(e,Math.min(r,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){ot(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var r=this._getCenterOffset(t)._trunc();return(e&&e.animate)!==!0&&!this.getSize().contains(r)?!1:(this.panBy(r,e),!0)},_createAnimProxy:function(){var t=this._proxy=W("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",function(e){var r=gn,h=this._proxy.style[r];ve(this._proxy,this.project(e.center,e.zoom),this.getZoomScale(e.zoom,1)),h===this._proxy.style[r]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){nt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var t=this.getCenter(),e=this.getZoom();ve(this._proxy,this.project(t,e),this.getZoomScale(e,1))},_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,r){if(this._animatingZoom)return!0;if(r=r||{},!this._zoomAnimated||r.animate===!1||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var h=this.getZoomScale(e),c=this._getCenterOffset(t)._divideBy(1-1/h);return r.animate!==!0&&!this.getSize().contains(c)?!1:(vt(function(){this._moveStart(!0,r.noMoveStart||!1)._animateZoom(t,e,!0)},this),!0)},_animateZoom:function(t,e,r,h){this._mapPane&&(r&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=e,B(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:e,noUpdate:h}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(l(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&ot(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function kh(t,e){return new q(t,e)}var jt=S.extend({options:{position:"topright"},initialize:function(t){M(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var e=this._container=this.onAdd(t),r=this.getPosition(),h=t._controlCorners[r];return B(e,"leaflet-control"),r.indexOf("bottom")!==-1?h.insertBefore(e,h.firstChild):h.appendChild(e),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(nt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(t){this._map&&t&&t.screenX>0&&t.screenY>0&&this._map.getContainer().focus()}}),ii=function(t){return new jt(t)};q.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){var t=this._controlCorners={},e="leaflet-",r=this._controlContainer=W("div",e+"control-container",this._container);function h(c,p){var g=e+c+" "+e+p;t[c+p]=W("div",g,r)}h("top","left"),h("top","right"),h("bottom","left"),h("bottom","right")},_clearControlPos:function(){for(var t in this._controlCorners)nt(this._controlCorners[t]);nt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Ms=jt.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,e,r,h){return r<h?-1:h<r?1:0}},initialize:function(t,e,r){M(this,r),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var h in t)this._addLayer(t[h],h);for(h in e)this._addLayer(e[h],h,!0)},onAdd:function(t){this._initLayout(),this._update(),this._map=t,t.on("zoomend",this._checkDisabledLayers,this);for(var e=0;e<this._layers.length;e++)this._layers[e].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(t){return jt.prototype.addTo.call(this,t),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._map?this._update():this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);var e=this._getLayer(f(t));return e&&this._layers.splice(this._layers.indexOf(e),1),this._map?this._update():this},expand:function(){B(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._section.clientHeight?(B(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=t+"px"):ot(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return ot(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=W("div",t),r=this.options.collapsed;e.setAttribute("aria-haspopup",!0),ei(e),kn(e);var h=this._section=W("section",t+"-list");r&&(this._map.on("click",this.collapse,this),D(e,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var c=this._layersLink=W("a",t+"-toggle",e);c.href="#",c.title="Layers",c.setAttribute("role","button"),D(c,{keydown:function(p){p.keyCode===13&&this._expandSafely()},click:function(p){_t(p),this._expandSafely()}},this),r||this.expand(),this._baseLayersList=W("div",t+"-base",h),this._separator=W("div",t+"-separator",h),this._overlaysList=W("div",t+"-overlays",h),e.appendChild(h)},_getLayer:function(t){for(var e=0;e<this._layers.length;e++)if(this._layers[e]&&f(this._layers[e].layer)===t)return this._layers[e]},_addLayer:function(t,e,r){this._map&&t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:e,overlay:r}),this.options.sortLayers&&this._layers.sort(l(function(h,c){return this.options.sortFunction(h.layer,c.layer,h.name,c.name)},this)),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;xi(this._baseLayersList),xi(this._overlaysList),this._layerControlInputs=[];var t,e,r,h,c=0;for(r=0;r<this._layers.length;r++)h=this._layers[r],this._addItem(h),e=e||h.overlay,t=t||!h.overlay,c+=h.overlay?0:1;return this.options.hideSingleBase&&(t=t&&c>1,this._baseLayersList.style.display=t?"":"none"),this._separator.style.display=e&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var e=this._getLayer(f(t.target)),r=e.overlay?t.type==="add"?"overlayadd":"overlayremove":t.type==="add"?"baselayerchange":null;r&&this._map.fire(r,e)},_createRadioElement:function(t,e){var r='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(e?' checked="checked"':"")+"/>",h=document.createElement("div");return h.innerHTML=r,h.firstChild},_addItem:function(t){var e=document.createElement("label"),r=this._map.hasLayer(t.layer),h;t.overlay?(h=document.createElement("input"),h.type="checkbox",h.className="leaflet-control-layers-selector",h.defaultChecked=r):h=this._createRadioElement("leaflet-base-layers_"+f(this),r),this._layerControlInputs.push(h),h.layerId=f(t.layer),D(h,"click",this._onInputClick,this);var c=document.createElement("span");c.innerHTML=" "+t.name;var p=document.createElement("span");e.appendChild(p),p.appendChild(h),p.appendChild(c);var g=t.overlay?this._overlaysList:this._baseLayersList;return g.appendChild(e),this._checkDisabledLayers(),e},_onInputClick:function(){if(!this._preventClick){var t=this._layerControlInputs,e,r,h=[],c=[];this._handlingClick=!0;for(var p=t.length-1;p>=0;p--)e=t[p],r=this._getLayer(e.layerId).layer,e.checked?h.push(r):e.checked||c.push(r);for(p=0;p<c.length;p++)this._map.hasLayer(c[p])&&this._map.removeLayer(c[p]);for(p=0;p<h.length;p++)this._map.hasLayer(h[p])||this._map.addLayer(h[p]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var t=this._layerControlInputs,e,r,h=this._map.getZoom(),c=t.length-1;c>=0;c--)e=t[c],r=this._getLayer(e.layerId).layer,e.disabled=r.options.minZoom!==void 0&&h<r.options.minZoom||r.options.maxZoom!==void 0&&h>r.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var t=this._section;this._preventClick=!0,D(t,"click",_t),this.expand();var e=this;setTimeout(function(){X(t,"click",_t),e._preventClick=!1})}}),Eh=function(t,e,r){return new Ms(t,e,r)},In=jt.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",r=W("div",e+" leaflet-bar"),h=this.options;return this._zoomInButton=this._createButton(h.zoomInText,h.zoomInTitle,e+"-in",r,this._zoomIn),this._zoomOutButton=this._createButton(h.zoomOutText,h.zoomOutTitle,e+"-out",r,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),r},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,e,r,h,c){var p=W("a",r,h);return p.innerHTML=t,p.href="#",p.title=e,p.setAttribute("role","button"),p.setAttribute("aria-label",e),ei(p),D(p,"click",xe),D(p,"click",c,this),D(p,"click",this._refocusOnMap,this),p},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";ot(this._zoomInButton,e),ot(this._zoomOutButton,e),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||t._zoom===t.getMinZoom())&&(B(this._zoomOutButton,e),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||t._zoom===t.getMaxZoom())&&(B(this._zoomInButton,e),this._zoomInButton.setAttribute("aria-disabled","true"))}});q.mergeOptions({zoomControl:!0}),q.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new In,this.addControl(this.zoomControl))});var Ih=function(t){return new In(t)},ks=jt.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var e="leaflet-control-scale",r=W("div",e),h=this.options;return this._addScales(h,e+"-line",r),t.on(h.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),r},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,r){t.metric&&(this._mScale=W("div",e,r)),t.imperial&&(this._iScale=W("div",e,r))},_update:function(){var t=this._map,e=t.getSize().y/2,r=t.distance(t.containerPointToLatLng([0,e]),t.containerPointToLatLng([this.options.maxWidth,e]));this._updateScales(r)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var e=this._getRoundNum(t),r=e<1e3?e+" m":e/1e3+" km";this._updateScale(this._mScale,r,e/t)},_updateImperial:function(t){var e=t*3.2808399,r,h,c;e>5280?(r=e/5280,h=this._getRoundNum(r),this._updateScale(this._iScale,h+" mi",h/r)):(c=this._getRoundNum(e),this._updateScale(this._iScale,c+" ft",c/e))},_updateScale:function(t,e,r){t.style.width=Math.round(this.options.maxWidth*r)+"px",t.innerHTML=e},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),r=t/e;return r=r>=10?10:r>=5?5:r>=3?3:r>=2?2:1,e*r}}),Rh=function(t){return new ks(t)},Oh='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Rn=jt.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(I.inlineSvg?Oh+" ":"")+"Leaflet</a>"},initialize:function(t){M(this,t),this._attributions={}},onAdd:function(t){t.attributionControl=this,this._container=W("div","leaflet-control-attribution"),ei(this._container);for(var e in t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return this._update(),t.on("layeradd",this._addAttribution,this),this._container},onRemove:function(t){t.off("layeradd",this._addAttribution,this)},_addAttribution:function(t){t.layer.getAttribution&&(this.addAttribution(t.layer.getAttribution()),t.layer.once("remove",function(){this.removeAttribution(t.layer.getAttribution())},this))},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):this},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):this},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var r=[];this.options.prefix&&r.push(this.options.prefix),t.length&&r.push(t.join(", ")),this._container.innerHTML=r.join(' <span aria-hidden="true">|</span> ')}}});q.mergeOptions({attributionControl:!0}),q.addInitHook(function(){this.options.attributionControl&&new Rn().addTo(this)});var zh=function(t){return new Rn(t)};jt.Layers=Ms,jt.Zoom=In,jt.Scale=ks,jt.Attribution=Rn,ii.layers=Eh,ii.zoom=Ih,ii.scale=Rh,ii.attribution=zh;var Yt=S.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Yt.addTo=function(t,e){return t.addHandler(e,this),this};var Fh={Events:st},Es=I.touch?"touchstart mousedown":"mousedown",le=J.extend({options:{clickTolerance:3},initialize:function(t,e,r,h){M(this,h),this._element=t,this._dragStartTarget=e||t,this._preventOutline=r},enable:function(){this._enabled||(D(this._dragStartTarget,Es,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(le._dragging===this&&this.finishDrag(!0),X(this._dragStartTarget,Es,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(this._enabled&&(this._moved=!1,!yn(this._element,"leaflet-zoom-anim"))){if(t.touches&&t.touches.length!==1){le._dragging===this&&this.finishDrag();return}if(!(le._dragging||t.shiftKey||t.which!==1&&t.button!==1&&!t.touches)&&(le._dragging=this,this._preventOutline&&Cn(this._element),bn(),Xe(),!this._moving)){this.fire("down");var e=t.touches?t.touches[0]:t,r=Ps(this._element);this._startPoint=new F(e.clientX,e.clientY),this._startPos=ge(this._element),this._parentScale=Ln(r);var h=t.type==="mousedown";D(document,h?"mousemove":"touchmove",this._onMove,this),D(document,h?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(t){if(this._enabled){if(t.touches&&t.touches.length>1){this._moved=!0;return}var e=t.touches&&t.touches.length===1?t.touches[0]:t,r=new F(e.clientX,e.clientY)._subtract(this._startPoint);!r.x&&!r.y||Math.abs(r.x)+Math.abs(r.y)<this.options.clickTolerance||(r.x/=this._parentScale.x,r.y/=this._parentScale.y,_t(t),this._moved||(this.fire("dragstart"),this._moved=!0,B(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),B(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(r),this._moving=!0,this._lastEvent=t,this._updatePosition())}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),ut(this._element,this._newPos),this.fire("drag",t)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(t){ot(document.body,"leaflet-dragging"),this._lastTarget&&(ot(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),X(document,"mousemove touchmove",this._onMove,this),X(document,"mouseup touchend touchcancel",this._onUp,this),Pn(),Qe();var e=this._moved&&this._moving;this._moving=!1,le._dragging=!1,e&&this.fire("dragend",{noInertia:t,distance:this._newPos.distanceTo(this._startPos)})}});function Is(t,e,r){var h,c=[1,4,2,8],p,g,w,b,C,k,R,Z;for(p=0,k=t.length;p<k;p++)t[p]._code=we(t[p],e);for(w=0;w<4;w++){for(R=c[w],h=[],p=0,k=t.length,g=k-1;p<k;g=p++)b=t[p],C=t[g],b._code&R?C._code&R||(Z=Ci(C,b,R,e,r),Z._code=we(Z,e),h.push(Z)):(C._code&R&&(Z=Ci(C,b,R,e,r),Z._code=we(Z,e),h.push(Z)),h.push(b));t=h}return t}function Rs(t,e){var r,h,c,p,g,w,b,C,k;if(!t||t.length===0)throw new Error("latlngs not passed");Rt(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var R=$([0,0]),Z=ht(t),xt=Z.getNorthWest().distanceTo(Z.getSouthWest())*Z.getNorthEast().distanceTo(Z.getNorthWest());xt<1700&&(R=On(t));var pt=t.length,Ot=[];for(r=0;r<pt;r++){var Ct=$(t[r]);Ot.push(e.project($([Ct.lat-R.lat,Ct.lng-R.lng])))}for(w=b=C=0,r=0,h=pt-1;r<pt;h=r++)c=Ot[r],p=Ot[h],g=c.y*p.x-p.y*c.x,b+=(c.x+p.x)*g,C+=(c.y+p.y)*g,w+=g*3;w===0?k=Ot[0]:k=[b/w,C/w];var ze=e.unproject(N(k));return $([ze.lat+R.lat,ze.lng+R.lng])}function On(t){for(var e=0,r=0,h=0,c=0;c<t.length;c++){var p=$(t[c]);e+=p.lat,r+=p.lng,h++}return $([e/h,r/h])}var jh={__proto__:null,clipPolygon:Is,polygonCenter:Rs,centroid:On};function Os(t,e){if(!e||!t.length)return t.slice();var r=e*e;return t=Bh(t,r),t=Dh(t,r),t}function zs(t,e,r){return Math.sqrt(ni(t,e,r,!0))}function Nh(t,e,r){return ni(t,e,r)}function Dh(t,e){var r=t.length,h=typeof Uint8Array<"u"?Uint8Array:Array,c=new h(r);c[0]=c[r-1]=1,zn(t,c,e,0,r-1);var p,g=[];for(p=0;p<r;p++)c[p]&&g.push(t[p]);return g}function zn(t,e,r,h,c){var p=0,g,w,b;for(w=h+1;w<=c-1;w++)b=ni(t[w],t[h],t[c],!0),b>p&&(g=w,p=b);p>r&&(e[g]=1,zn(t,e,r,h,g),zn(t,e,r,g,c))}function Bh(t,e){for(var r=[t[0]],h=1,c=0,p=t.length;h<p;h++)Zh(t[h],t[c])>e&&(r.push(t[h]),c=h);return c<p-1&&r.push(t[p-1]),r}var Fs;function js(t,e,r,h,c){var p=h?Fs:we(t,r),g=we(e,r),w,b,C;for(Fs=g;;){if(!(p|g))return[t,e];if(p&g)return!1;w=p||g,b=Ci(t,e,w,r,c),C=we(b,r),w===p?(t=b,p=C):(e=b,g=C)}}function Ci(t,e,r,h,c){var p=e.x-t.x,g=e.y-t.y,w=h.min,b=h.max,C,k;return r&8?(C=t.x+p*(b.y-t.y)/g,k=b.y):r&4?(C=t.x+p*(w.y-t.y)/g,k=w.y):r&2?(C=b.x,k=t.y+g*(b.x-t.x)/p):r&1&&(C=w.x,k=t.y+g*(w.x-t.x)/p),new F(C,k,c)}function we(t,e){var r=0;return t.x<e.min.x?r|=1:t.x>e.max.x&&(r|=2),t.y<e.min.y?r|=4:t.y>e.max.y&&(r|=8),r}function Zh(t,e){var r=e.x-t.x,h=e.y-t.y;return r*r+h*h}function ni(t,e,r,h){var c=e.x,p=e.y,g=r.x-c,w=r.y-p,b=g*g+w*w,C;return b>0&&(C=((t.x-c)*g+(t.y-p)*w)/b,C>1?(c=r.x,p=r.y):C>0&&(c+=g*C,p+=w*C)),g=t.x-c,w=t.y-p,h?g*g+w*w:new F(c,p)}function Rt(t){return!rt(t[0])||typeof t[0][0]!="object"&&typeof t[0][0]<"u"}function Ns(t){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Rt(t)}function Ds(t,e){var r,h,c,p,g,w,b,C;if(!t||t.length===0)throw new Error("latlngs not passed");Rt(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var k=$([0,0]),R=ht(t),Z=R.getNorthWest().distanceTo(R.getSouthWest())*R.getNorthEast().distanceTo(R.getNorthWest());Z<1700&&(k=On(t));var xt=t.length,pt=[];for(r=0;r<xt;r++){var Ot=$(t[r]);pt.push(e.project($([Ot.lat-k.lat,Ot.lng-k.lng])))}for(r=0,h=0;r<xt-1;r++)h+=pt[r].distanceTo(pt[r+1])/2;if(h===0)C=pt[0];else for(r=0,p=0;r<xt-1;r++)if(g=pt[r],w=pt[r+1],c=g.distanceTo(w),p+=c,p>h){b=(p-h)/c,C=[w.x-b*(w.x-g.x),w.y-b*(w.y-g.y)];break}var Ct=e.unproject(N(C));return $([Ct.lat+k.lat,Ct.lng+k.lng])}var Hh={__proto__:null,simplify:Os,pointToSegmentDistance:zs,closestPointOnSegment:Nh,clipSegment:js,_getEdgeIntersection:Ci,_getBitCode:we,_sqClosestPointOnSegment:ni,isFlat:Rt,_flat:Ns,polylineCenter:Ds},Fn={project:function(t){return new F(t.lng,t.lat)},unproject:function(t){return new Y(t.y,t.x)},bounds:new it([-180,-90],[180,90])},jn={R:6378137,R_MINOR:6356752314245179e-9,bounds:new it([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(t){var e=Math.PI/180,r=this.R,h=t.lat*e,c=this.R_MINOR/r,p=Math.sqrt(1-c*c),g=p*Math.sin(h),w=Math.tan(Math.PI/4-h/2)/Math.pow((1-g)/(1+g),p/2);return h=-r*Math.log(Math.max(w,1e-10)),new F(t.lng*e*r,h)},unproject:function(t){for(var e=180/Math.PI,r=this.R,h=this.R_MINOR/r,c=Math.sqrt(1-h*h),p=Math.exp(-t.y/r),g=Math.PI/2-2*Math.atan(p),w=0,b=.1,C;w<15&&Math.abs(b)>1e-7;w++)C=c*Math.sin(g),C=Math.pow((1-C)/(1+C),c/2),b=Math.PI/2-2*Math.atan(p*C)-g,g+=b;return new Y(g*e,t.x*e/r)}},$h={__proto__:null,LonLat:Fn,Mercator:jn,SphericalMercator:un},qh=a({},ue,{code:"EPSG:3395",projection:jn,transformation:function(){var t=.5/(Math.PI*jn.R);return Ge(t,.5,-t,.5)}()}),Bs=a({},ue,{code:"EPSG:4326",projection:Fn,transformation:Ge(1/180,1,-1/180,.5)}),Uh=a({},ee,{projection:Fn,transformation:Ge(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,e){var r=e.lng-t.lng,h=e.lat-t.lat;return Math.sqrt(r*r+h*h)},infinite:!0});ee.Earth=ue,ee.EPSG3395=qh,ee.EPSG3857=cn,ee.EPSG900913=Ja,ee.EPSG4326=Bs,ee.Simple=Uh;var Nt=J.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[f(t)]=this,this},removeInteractiveTarget:function(t){return delete this._map._targets[f(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var e=t.target;if(e.hasLayer(this)){if(this._map=e,this._zoomAnimated=e._zoomAnimated,this.getEvents){var r=this.getEvents();e.on(r,this),this.once("remove",function(){e.off(r,this)},this)}this.onAdd(e),this.fire("add"),e.fire("layeradd",{layer:this})}}});q.include({addLayer:function(t){if(!t._layerAdd)throw new Error("The provided object is not a Layer.");var e=f(t);return this._layers[e]?this:(this._layers[e]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t),this)},removeLayer:function(t){var e=f(t);return this._layers[e]?(this._loaded&&t.onRemove(this),delete this._layers[e],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return f(t)in this._layers},eachLayer:function(t,e){for(var r in this._layers)t.call(e,this._layers[r]);return this},_addLayers:function(t){t=t?rt(t)?t:[t]:[];for(var e=0,r=t.length;e<r;e++)this.addLayer(t[e])},_addZoomLimit:function(t){(!isNaN(t.options.maxZoom)||!isNaN(t.options.minZoom))&&(this._zoomBoundLayers[f(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var e=f(t);this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,e=-1/0,r=this._getZoomSpan();for(var h in this._zoomBoundLayers){var c=this._zoomBoundLayers[h].options;t=c.minZoom===void 0?t:Math.min(t,c.minZoom),e=c.maxZoom===void 0?e:Math.max(e,c.maxZoom)}this._layersMaxZoom=e===-1/0?void 0:e,this._layersMinZoom=t===1/0?void 0:t,r!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var ke=Nt.extend({initialize:function(t,e){M(this,e),this._layers={};var r,h;if(t)for(r=0,h=t.length;r<h;r++)this.addLayer(t[r])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){var e=typeof t=="number"?t:this.getLayerId(t);return e in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(t){var e=Array.prototype.slice.call(arguments,1),r,h;for(r in this._layers)h=this._layers[r],h[t]&&h[t].apply(h,e);return this},onAdd:function(t){this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t)},eachLayer:function(t,e){for(var r in this._layers)t.call(e,this._layers[r]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];return this.eachLayer(t.push,t),t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return f(t)}}),Wh=function(t,e){return new ke(t,e)},ie=ke.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),ke.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),ke.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new St;for(var e in this._layers){var r=this._layers[e];t.extend(r.getBounds?r.getBounds():r.getLatLng())}return t}}),Kh=function(t,e){return new ie(t,e)},Ee=S.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(t){M(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var r=this._getIconUrl(t);if(!r){if(t==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var h=this._createImg(r,e&&e.tagName==="IMG"?e:null);return this._setIconStyles(h,t),(this.options.crossOrigin||this.options.crossOrigin==="")&&(h.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),h},_setIconStyles:function(t,e){var r=this.options,h=r[e+"Size"];typeof h=="number"&&(h=[h,h]);var c=N(h),p=N(e==="shadow"&&r.shadowAnchor||r.iconAnchor||c&&c.divideBy(2,!0));t.className="leaflet-marker-"+e+" "+(r.className||""),p&&(t.style.marginLeft=-p.x+"px",t.style.marginTop=-p.y+"px"),c&&(t.style.width=c.x+"px",t.style.height=c.y+"px")},_createImg:function(t,e){return e=e||document.createElement("img"),e.src=t,e},_getIconUrl:function(t){return I.retina&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}});function Gh(t){return new Ee(t)}var ri=Ee.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return typeof ri.imagePath!="string"&&(ri.imagePath=this._detectIconPath()),(this.options.imagePath||ri.imagePath)+Ee.prototype._getIconUrl.call(this,t)},_stripUrl:function(t){var e=function(r,h,c){var p=h.exec(r);return p&&p[c]};return t=e(t,/^url\((['"])?(.+)\1\)$/,2),t&&e(t,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var t=W("div","leaflet-default-icon-path",document.body),e=Je(t,"background-image")||Je(t,"backgroundImage");if(document.body.removeChild(t),e=this._stripUrl(e),e)return e;var r=document.querySelector('link[href$="leaflet.css"]');return r?r.href.substring(0,r.href.length-11-1):""}}),Zs=Yt.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new le(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),B(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&ot(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(t){var e=this._marker,r=e._map,h=this._marker.options.autoPanSpeed,c=this._marker.options.autoPanPadding,p=ge(e._icon),g=r.getPixelBounds(),w=r.getPixelOrigin(),b=Pt(g.min._subtract(w).add(c),g.max._subtract(w).subtract(c));if(!b.contains(p)){var C=N((Math.max(b.max.x,p.x)-b.max.x)/(g.max.x-b.max.x)-(Math.min(b.min.x,p.x)-b.min.x)/(g.min.x-b.min.x),(Math.max(b.max.y,p.y)-b.max.y)/(g.max.y-b.max.y)-(Math.min(b.min.y,p.y)-b.min.y)/(g.min.y-b.min.y)).multiplyBy(h);r.panBy(C,{animate:!1}),this._draggable._newPos._add(C),this._draggable._startPos._add(C),ut(e._icon,this._draggable._newPos),this._onDrag(t),this._panRequest=vt(this._adjustPan.bind(this,t))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(t){this._marker.options.autoPan&&(bt(this._panRequest),this._panRequest=vt(this._adjustPan.bind(this,t)))},_onDrag:function(t){var e=this._marker,r=e._shadow,h=ge(e._icon),c=e._map.layerPointToLatLng(h);r&&ut(r,h),e._latlng=c,t.latlng=c,t.oldLatLng=this._oldLatLng,e.fire("move",t).fire("drag",t)},_onDragEnd:function(t){bt(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),Li=Nt.extend({options:{icon:new ri,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(t,e){M(this,e),this._latlng=$(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var e=this._latlng;return this._latlng=$(t),this.update(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},getIcon:function(){return this.options.icon},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,e="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),r=t.icon.createIcon(this._icon),h=!1;r!==this._icon&&(this._icon&&this._removeIcon(),h=!0,t.title&&(r.title=t.title),r.tagName==="IMG"&&(r.alt=t.alt||"")),B(r,e),t.keyboard&&(r.tabIndex="0",r.setAttribute("role","button")),this._icon=r,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&D(r,"focus",this._panOnFocus,this);var c=t.icon.createShadow(this._shadow),p=!1;c!==this._shadow&&(this._removeShadow(),p=!0),c&&(B(c,e),c.alt=""),this._shadow=c,t.opacity<1&&this._updateOpacity(),h&&this.getPane().appendChild(this._icon),this._initInteraction(),c&&p&&this.getPane(t.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&X(this._icon,"focus",this._panOnFocus,this),nt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&nt(this._shadow),this._shadow=null},_setPos:function(t){this._icon&&ut(this._icon,t),this._shadow&&ut(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon&&(this._icon.style.zIndex=this._zIndex+t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.interactive&&(B(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Zs)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Zs(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;this._icon&&It(this._icon,t),this._shadow&&It(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var t=this._map;if(t){var e=this.options.icon.options,r=e.iconSize?N(e.iconSize):N(0,0),h=e.iconAnchor?N(e.iconAnchor):N(0,0);t.panInside(this._latlng,{paddingTopLeft:h,paddingBottomRight:r.subtract(h)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Yh(t,e){return new Li(t,e)}var ce=Nt.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return M(this,t),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&t&&Object.prototype.hasOwnProperty.call(t,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Ti=ce.extend({options:{fill:!0,radius:10},initialize:function(t,e){M(this,e),this._latlng=$(t),this._radius=this.options.radius},setLatLng:function(t){var e=this._latlng;return this._latlng=$(t),this.redraw(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var e=t&&t.radius||this._radius;return ce.prototype.setStyle.call(this,t),this.setRadius(e),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,e=this._radiusY||t,r=this._clickTolerance(),h=[t+r,e+r];this._pxBounds=new it(this._point.subtract(h),this._point.add(h))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Vh(t,e){return new Ti(t,e)}var Nn=Ti.extend({initialize:function(t,e,r){if(typeof e=="number"&&(e=a({},r,{radius:e})),M(this,e),this._latlng=$(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new St(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:ce.prototype.setStyle,_project:function(){var t=this._latlng.lng,e=this._latlng.lat,r=this._map,h=r.options.crs;if(h.distance===ue.distance){var c=Math.PI/180,p=this._mRadius/ue.R/c,g=r.project([e+p,t]),w=r.project([e-p,t]),b=g.add(w).divideBy(2),C=r.unproject(b).lat,k=Math.acos((Math.cos(p*c)-Math.sin(e*c)*Math.sin(C*c))/(Math.cos(e*c)*Math.cos(C*c)))/c;(isNaN(k)||k===0)&&(k=p/Math.cos(Math.PI/180*e)),this._point=b.subtract(r.getPixelOrigin()),this._radius=isNaN(k)?0:b.x-r.project([C,t-k]).x,this._radiusY=b.y-g.y}else{var R=h.unproject(h.project(this._latlng).subtract([this._mRadius,0]));this._point=r.latLngToLayerPoint(this._latlng),this._radius=this._point.x-r.latLngToLayerPoint(R).x}this._updateBounds()}});function Jh(t,e,r){return new Nn(t,e,r)}var ne=ce.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,e){M(this,e),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var e=1/0,r=null,h=ni,c,p,g=0,w=this._parts.length;g<w;g++)for(var b=this._parts[g],C=1,k=b.length;C<k;C++){c=b[C-1],p=b[C];var R=h(t,c,p,!0);R<e&&(e=R,r=h(t,c,p))}return r&&(r.distance=Math.sqrt(e)),r},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Ds(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(t,e){return e=e||this._defaultShape(),t=$(t),e.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new St,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return Rt(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var e=[],r=Rt(t),h=0,c=t.length;h<c;h++)r?(e[h]=$(t[h]),this._bounds.extend(e[h])):e[h]=this._convertLatLngs(t[h]);return e},_project:function(){var t=new it;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t),this._bounds.isValid()&&t.isValid()&&(this._rawPxBounds=t,this._updateBounds())},_updateBounds:function(){var t=this._clickTolerance(),e=new F(t,t);this._rawPxBounds&&(this._pxBounds=new it([this._rawPxBounds.min.subtract(e),this._rawPxBounds.max.add(e)]))},_projectLatlngs:function(t,e,r){var h=t[0]instanceof Y,c=t.length,p,g;if(h){for(g=[],p=0;p<c;p++)g[p]=this._map.latLngToLayerPoint(t[p]),r.extend(g[p]);e.push(g)}else for(p=0;p<c;p++)this._projectLatlngs(t[p],e,r)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(t))){if(this.options.noClip){this._parts=this._rings;return}var e=this._parts,r,h,c,p,g,w,b;for(r=0,c=0,p=this._rings.length;r<p;r++)for(b=this._rings[r],h=0,g=b.length;h<g-1;h++)w=js(b[h],b[h+1],t,h,!0),w&&(e[c]=e[c]||[],e[c].push(w[0]),(w[1]!==b[h+1]||h===g-2)&&(e[c].push(w[1]),c++))}},_simplifyPoints:function(){for(var t=this._parts,e=this.options.smoothFactor,r=0,h=t.length;r<h;r++)t[r]=Os(t[r],e)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(t,e){var r,h,c,p,g,w,b=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(r=0,p=this._parts.length;r<p;r++)for(w=this._parts[r],h=0,g=w.length,c=g-1;h<g;c=h++)if(!(!e&&h===0)&&zs(t,w[c],w[h])<=b)return!0;return!1}});function Xh(t,e){return new ne(t,e)}ne._flat=Ns;var Ie=ne.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Rs(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(t){var e=ne.prototype._convertLatLngs.call(this,t),r=e.length;return r>=2&&e[0]instanceof Y&&e[0].equals(e[r-1])&&e.pop(),e},_setLatLngs:function(t){ne.prototype._setLatLngs.call(this,t),Rt(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Rt(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,e=this.options.weight,r=new F(e,e);if(t=new it(t.min.subtract(r),t.max.add(r)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(t))){if(this.options.noClip){this._parts=this._rings;return}for(var h=0,c=this._rings.length,p;h<c;h++)p=Is(this._rings[h],t,!0),p.length&&this._parts.push(p)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(t){var e=!1,r,h,c,p,g,w,b,C;if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(p=0,b=this._parts.length;p<b;p++)for(r=this._parts[p],g=0,C=r.length,w=C-1;g<C;w=g++)h=r[g],c=r[w],h.y>t.y!=c.y>t.y&&t.x<(c.x-h.x)*(t.y-h.y)/(c.y-h.y)+h.x&&(e=!e);return e||ne.prototype._containsPoint.call(this,t,!0)}});function Qh(t,e){return new Ie(t,e)}var re=ie.extend({initialize:function(t,e){M(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e=rt(t)?t:t.features,r,h,c;if(e){for(r=0,h=e.length;r<h;r++)c=e[r],(c.geometries||c.geometry||c.features||c.coordinates)&&this.addData(c);return this}var p=this.options;if(p.filter&&!p.filter(t))return this;var g=Ai(t,p);return g?(g.feature=Ei(t),g.defaultOptions=g.options,this.resetStyle(g),p.onEachFeature&&p.onEachFeature(t,g),this.addLayer(g)):this},resetStyle:function(t){return t===void 0?this.eachLayer(this.resetStyle,this):(t.options=a({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this)},setStyle:function(t){return this.eachLayer(function(e){this._setLayerStyle(e,t)},this)},_setLayerStyle:function(t,e){t.setStyle&&(typeof e=="function"&&(e=e(t.feature)),t.setStyle(e))}});function Ai(t,e){var r=t.type==="Feature"?t.geometry:t,h=r?r.coordinates:null,c=[],p=e&&e.pointToLayer,g=e&&e.coordsToLatLng||Dn,w,b,C,k;if(!h&&!r)return null;switch(r.type){case"Point":return w=g(h),Hs(p,t,w,e);case"MultiPoint":for(C=0,k=h.length;C<k;C++)w=g(h[C]),c.push(Hs(p,t,w,e));return new ie(c);case"LineString":case"MultiLineString":return b=Mi(h,r.type==="LineString"?0:1,g),new ne(b,e);case"Polygon":case"MultiPolygon":return b=Mi(h,r.type==="Polygon"?1:2,g),new Ie(b,e);case"GeometryCollection":for(C=0,k=r.geometries.length;C<k;C++){var R=Ai({geometry:r.geometries[C],type:"Feature",properties:t.properties},e);R&&c.push(R)}return new ie(c);case"FeatureCollection":for(C=0,k=r.features.length;C<k;C++){var Z=Ai(r.features[C],e);Z&&c.push(Z)}return new ie(c);default:throw new Error("Invalid GeoJSON object.")}}function Hs(t,e,r,h){return t?t(e,r):new Li(r,h&&h.markersInheritOptions&&h)}function Dn(t){return new Y(t[1],t[0],t[2])}function Mi(t,e,r){for(var h=[],c=0,p=t.length,g;c<p;c++)g=e?Mi(t[c],e-1,r):(r||Dn)(t[c]),h.push(g);return h}function Bn(t,e){return t=$(t),t.alt!==void 0?[x(t.lng,e),x(t.lat,e),x(t.alt,e)]:[x(t.lng,e),x(t.lat,e)]}function ki(t,e,r,h){for(var c=[],p=0,g=t.length;p<g;p++)c.push(e?ki(t[p],Rt(t[p])?0:e-1,r,h):Bn(t[p],h));return!e&&r&&c.length>0&&c.push(c[0].slice()),c}function Re(t,e){return t.feature?a({},t.feature,{geometry:e}):Ei(e)}function Ei(t){return t.type==="Feature"||t.type==="FeatureCollection"?t:{type:"Feature",properties:{},geometry:t}}var Zn={toGeoJSON:function(t){return Re(this,{type:"Point",coordinates:Bn(this.getLatLng(),t)})}};Li.include(Zn),Nn.include(Zn),Ti.include(Zn),ne.include({toGeoJSON:function(t){var e=!Rt(this._latlngs),r=ki(this._latlngs,e?1:0,!1,t);return Re(this,{type:(e?"Multi":"")+"LineString",coordinates:r})}}),Ie.include({toGeoJSON:function(t){var e=!Rt(this._latlngs),r=e&&!Rt(this._latlngs[0]),h=ki(this._latlngs,r?2:e?1:0,!0,t);return e||(h=[h]),Re(this,{type:(r?"Multi":"")+"Polygon",coordinates:h})}}),ke.include({toMultiPoint:function(t){var e=[];return this.eachLayer(function(r){e.push(r.toGeoJSON(t).geometry.coordinates)}),Re(this,{type:"MultiPoint",coordinates:e})},toGeoJSON:function(t){var e=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(e==="MultiPoint")return this.toMultiPoint(t);var r=e==="GeometryCollection",h=[];return this.eachLayer(function(c){if(c.toGeoJSON){var p=c.toGeoJSON(t);if(r)h.push(p.geometry);else{var g=Ei(p);g.type==="FeatureCollection"?h.push.apply(h,g.features):h.push(g)}}}),r?Re(this,{geometries:h,type:"GeometryCollection"}):{type:"FeatureCollection",features:h}}});function $s(t,e){return new re(t,e)}var tu=$s,Ii=Nt.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(t,e,r){this._url=t,this._bounds=ht(e),M(this,r)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(B(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){nt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&Ae(this._image),this},bringToBack:function(){return this._map&&Me(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=ht(t),this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t=this._url.tagName==="IMG",e=this._image=t?this._url:W("img");if(B(e,"leaflet-image-layer"),this._zoomAnimated&&B(e,"leaflet-zoom-animated"),this.options.className&&B(e,this.options.className),e.onselectstart=_,e.onmousemove=_,e.onload=l(this.fire,this,"load"),e.onerror=l(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(e.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),t){this._url=e.src;return}e.src=this._url,e.alt=this.options.alt},_animateZoom:function(t){var e=this._map.getZoomScale(t.zoom),r=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;ve(this._image,r,e)},_reset:function(){var t=this._image,e=new it(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),r=e.getSize();ut(t,e.min),t.style.width=r.x+"px",t.style.height=r.y+"px"},_updateOpacity:function(){It(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var t=this.options.errorOverlayUrl;t&&this._url!==t&&(this._url=t,this._image.src=t)},getCenter:function(){return this._bounds.getCenter()}}),eu=function(t,e,r){return new Ii(t,e,r)},qs=Ii.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var t=this._url.tagName==="VIDEO",e=this._image=t?this._url:W("video");if(B(e,"leaflet-image-layer"),this._zoomAnimated&&B(e,"leaflet-zoom-animated"),this.options.className&&B(e,this.options.className),e.onselectstart=_,e.onmousemove=_,e.onloadeddata=l(this.fire,this,"load"),t){for(var r=e.getElementsByTagName("source"),h=[],c=0;c<r.length;c++)h.push(r[c].src);this._url=r.length>0?h:[e.src];return}rt(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(e.style,"objectFit")&&(e.style.objectFit="fill"),e.autoplay=!!this.options.autoplay,e.loop=!!this.options.loop,e.muted=!!this.options.muted,e.playsInline=!!this.options.playsInline;for(var p=0;p<this._url.length;p++){var g=W("source");g.src=this._url[p],e.appendChild(g)}}});function iu(t,e,r){return new qs(t,e,r)}var Us=Ii.extend({_initImage:function(){var t=this._image=this._url;B(t,"leaflet-image-layer"),this._zoomAnimated&&B(t,"leaflet-zoom-animated"),this.options.className&&B(t,this.options.className),t.onselectstart=_,t.onmousemove=_}});function nu(t,e,r){return new Us(t,e,r)}var Vt=Nt.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(t,e){t&&(t instanceof Y||rt(t))?(this._latlng=$(t),M(this,e)):(M(this,t),this._source=e),this.options.content&&(this._content=this.options.content)},openOn:function(t){return t=arguments.length?t:this._source._map,t.hasLayer(this)||t.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(t){return this._map?this.close():(arguments.length?this._source=t:t=this._source,this._prepareOpen(),this.openOn(t._map)),this},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&It(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&It(this._container,1),this.bringToFront(),this.options.interactive&&(B(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(t){t._fadeAnimated?(It(this._container,0),this._removeTimeout=setTimeout(l(nt,void 0,this._container),200)):nt(this._container),this.options.interactive&&(ot(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=$(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Ae(this._container),this},bringToBack:function(){return this._map&&Me(this._container),this},_prepareOpen:function(t){var e=this._source;if(!e._map)return!1;if(e instanceof ie){e=null;var r=this._source._layers;for(var h in r)if(r[h]._map){e=r[h];break}if(!e)return!1;this._source=e}if(!t)if(e.getCenter)t=e.getCenter();else if(e.getLatLng)t=e.getLatLng();else if(e.getBounds)t=e.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(t),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var t=this._contentNode,e=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof e=="string")t.innerHTML=e;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(e)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=N(this.options.offset),r=this._getAnchor();this._zoomAnimated?ut(this._container,t.add(r)):e=e.add(t).add(r);var h=this._containerBottom=-e.y,c=this._containerLeft=-Math.round(this._containerWidth/2)+e.x;this._container.style.bottom=h+"px",this._container.style.left=c+"px"}},_getAnchor:function(){return[0,0]}});q.include({_initOverlay:function(t,e,r,h){var c=e;return c instanceof t||(c=new t(h).setContent(e)),r&&c.setLatLng(r),c}}),Nt.include({_initOverlay:function(t,e,r,h){var c=r;return c instanceof t?(M(c,h),c._source=this):(c=e&&!h?e:new t(h,this),c.setContent(r)),c}});var Ri=Vt.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(t){return t=arguments.length?t:this._source._map,!t.hasLayer(this)&&t._popup&&t._popup.options.autoClose&&t.removeLayer(t._popup),t._popup=this,Vt.prototype.openOn.call(this,t)},onAdd:function(t){Vt.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof ce||this._source.on("preclick",ye))},onRemove:function(t){Vt.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof ce||this._source.off("preclick",ye))},getEvents:function(){var t=Vt.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this.close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_initLayout:function(){var t="leaflet-popup",e=this._container=W("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated"),r=this._wrapper=W("div",t+"-content-wrapper",e);if(this._contentNode=W("div",t+"-content",r),ei(e),kn(this._contentNode),D(e,"contextmenu",ye),this._tipContainer=W("div",t+"-tip-container",e),this._tip=W("div",t+"-tip",this._tipContainer),this.options.closeButton){var h=this._closeButton=W("a",t+"-close-button",e);h.setAttribute("role","button"),h.setAttribute("aria-label","Close popup"),h.href="#close",h.innerHTML='<span aria-hidden="true">&#215;</span>',D(h,"click",function(c){_t(c),this.close()},this)}},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var r=t.offsetWidth;r=Math.min(r,this.options.maxWidth),r=Math.max(r,this.options.minWidth),e.width=r+1+"px",e.whiteSpace="",e.height="";var h=t.offsetHeight,c=this.options.maxHeight,p="leaflet-popup-scrolled";c&&h>c?(e.height=c+"px",B(t,p)):ot(t,p),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),r=this._getAnchor();ut(this._container,e.add(r))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var t=this._map,e=parseInt(Je(this._container,"marginBottom"),10)||0,r=this._container.offsetHeight+e,h=this._containerWidth,c=new F(this._containerLeft,-r-this._containerBottom);c._add(ge(this._container));var p=t.layerPointToContainerPoint(c),g=N(this.options.autoPanPadding),w=N(this.options.autoPanPaddingTopLeft||g),b=N(this.options.autoPanPaddingBottomRight||g),C=t.getSize(),k=0,R=0;p.x+h+b.x>C.x&&(k=p.x+h-C.x+b.x),p.x-k-w.x<0&&(k=p.x-w.x),p.y+r+b.y>C.y&&(R=p.y+r-C.y+b.y),p.y-R-w.y<0&&(R=p.y-w.y),(k||R)&&(this.options.keepInView&&(this._autopanning=!0),t.fire("autopanstart").panBy([k,R]))}},_getAnchor:function(){return N(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),ru=function(t,e){return new Ri(t,e)};q.mergeOptions({closePopupOnClick:!0}),q.include({openPopup:function(t,e,r){return this._initOverlay(Ri,t,e,r).openOn(this),this},closePopup:function(t){return t=arguments.length?t:this._popup,t&&t.close(),this}}),Nt.include({bindPopup:function(t,e){return this._popup=this._initOverlay(Ri,this._popup,t,e),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t){return this._popup&&(this instanceof ie||(this._popup._source=this),this._popup._prepareOpen(t||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){if(!(!this._popup||!this._map)){xe(t);var e=t.layer||t.target;if(this._popup._source===e&&!(e instanceof ce)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(t.latlng);return}this._popup._source=e,this.openPopup(t.latlng)}},_movePopup:function(t){this._popup.setLatLng(t.latlng)},_onKeyPress:function(t){t.originalEvent.keyCode===13&&this._openPopup(t)}});var Oi=Vt.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(t){Vt.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(t){Vt.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var t=Vt.prototype.getEvents.call(this);return this.options.permanent||(t.preclick=this.close),t},_initLayout:function(){var t="leaflet-tooltip",e=t+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=W("div",e),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+f(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var e,r,h=this._map,c=this._container,p=h.latLngToContainerPoint(h.getCenter()),g=h.layerPointToContainerPoint(t),w=this.options.direction,b=c.offsetWidth,C=c.offsetHeight,k=N(this.options.offset),R=this._getAnchor();w==="top"?(e=b/2,r=C):w==="bottom"?(e=b/2,r=0):w==="center"?(e=b/2,r=C/2):w==="right"?(e=0,r=C/2):w==="left"?(e=b,r=C/2):g.x<p.x?(w="right",e=0,r=C/2):(w="left",e=b+(k.x+R.x)*2,r=C/2),t=t.subtract(N(e,r,!0)).add(k).add(R),ot(c,"leaflet-tooltip-right"),ot(c,"leaflet-tooltip-left"),ot(c,"leaflet-tooltip-top"),ot(c,"leaflet-tooltip-bottom"),B(c,"leaflet-tooltip-"+w),ut(c,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&It(this._container,t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(e)},_getAnchor:function(){return N(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),su=function(t,e){return new Oi(t,e)};q.include({openTooltip:function(t,e,r){return this._initOverlay(Oi,t,e,r).openOn(this),this},closeTooltip:function(t){return t.close(),this}}),Nt.include({bindTooltip:function(t,e){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Oi,this._tooltip,t,e),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){if(!(!t&&this._tooltipHandlersAdded)){var e=t?"off":"on",r={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?r.add=this._openTooltip:(r.mouseover=this._openTooltip,r.mouseout=this.closeTooltip,r.click=this._openTooltip,this._map?this._addFocusListeners():r.add=this._addFocusListeners),this._tooltip.options.sticky&&(r.mousemove=this._moveTooltip),this[e](r),this._tooltipHandlersAdded=!t}},openTooltip:function(t){return this._tooltip&&(this instanceof ie||(this._tooltip._source=this),this._tooltip._prepareOpen(t)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(t){var e=typeof t.getElement=="function"&&t.getElement();e&&(D(e,"focus",function(){this._tooltip._source=t,this.openTooltip()},this),D(e,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(t){var e=typeof t.getElement=="function"&&t.getElement();e&&e.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(t){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var e=this;this._map.once("moveend",function(){e._openOnceFlag=!1,e._openTooltip(t)});return}this._tooltip._source=t.layer||t.target,this.openTooltip(this._tooltip.options.sticky?t.latlng:void 0)}},_moveTooltip:function(t){var e=t.latlng,r,h;this._tooltip.options.sticky&&t.originalEvent&&(r=this._map.mouseEventToContainerPoint(t.originalEvent),h=this._map.containerPointToLayerPoint(r),e=this._map.layerPointToLatLng(h)),this._tooltip.setLatLng(e)}});var Ws=Ee.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var e=t&&t.tagName==="DIV"?t:document.createElement("div"),r=this.options;if(r.html instanceof Element?(xi(e),e.appendChild(r.html)):e.innerHTML=r.html!==!1?r.html:"",r.bgPos){var h=N(r.bgPos);e.style.backgroundPosition=-h.x+"px "+-h.y+"px"}return this._setIconStyles(e,"icon"),e},createShadow:function(){return null}});function ou(t){return new Ws(t)}Ee.Default=ri;var si=Nt.extend({options:{tileSize:256,opacity:1,updateWhenIdle:I.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){M(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),nt(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Ae(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Me(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var t=this._clampZoom(this._map.getZoom());t!==this._tileZoom&&(this._tileZoom=t,this._updateLevels()),this._update()}return this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=v(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return document.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof F?t:new F(t,t)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var e=this.getPane().children,r=-t(-1/0,1/0),h=0,c=e.length,p;h<c;h++)p=e[h].style.zIndex,e[h]!==this._container&&p&&(r=t(r,+p));isFinite(r)&&(this.options.zIndex=r+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!I.ielt9){It(this._container,this.options.opacity);var t=+new Date,e=!1,r=!1;for(var h in this._tiles){var c=this._tiles[h];if(!(!c.current||!c.loaded)){var p=Math.min(1,(t-c.loaded)/200);It(c.el,p),p<1?e=!0:(c.active?r=!0:this._onOpaqueTile(c),c.active=!0)}}r&&!this._noPrune&&this._pruneTiles(),e&&(bt(this._fadeFrame),this._fadeFrame=vt(this._updateOpacity,this))}},_onOpaqueTile:_,_initContainer:function(){this._container||(this._container=W("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,e=this.options.maxZoom;if(t!==void 0){for(var r in this._levels)r=Number(r),this._levels[r].el.children.length||r===t?(this._levels[r].el.style.zIndex=e-Math.abs(t-r),this._onUpdateLevel(r)):(nt(this._levels[r].el),this._removeTilesAtZoom(r),this._onRemoveLevel(r),delete this._levels[r]);var h=this._levels[t],c=this._map;return h||(h=this._levels[t]={},h.el=W("div","leaflet-tile-container leaflet-zoom-animated",this._container),h.el.style.zIndex=e,h.origin=c.project(c.unproject(c.getPixelOrigin()),t).round(),h.zoom=t,this._setZoomTransform(h,c.getCenter(),c.getZoom()),_(h.el.offsetWidth),this._onCreateLevel(h)),this._level=h,h}},_onUpdateLevel:_,_onRemoveLevel:_,_onCreateLevel:_,_pruneTiles:function(){if(this._map){var t,e,r=this._map.getZoom();if(r>this.options.maxZoom||r<this.options.minZoom){this._removeAllTiles();return}for(t in this._tiles)e=this._tiles[t],e.retain=e.current;for(t in this._tiles)if(e=this._tiles[t],e.current&&!e.active){var h=e.coords;this._retainParent(h.x,h.y,h.z,h.z-5)||this._retainChildren(h.x,h.y,h.z,h.z+2)}for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}},_removeTilesAtZoom:function(t){for(var e in this._tiles)this._tiles[e].coords.z===t&&this._removeTile(e)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)nt(this._levels[t].el),this._onRemoveLevel(Number(t)),delete this._levels[t];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(t,e,r,h){var c=Math.floor(t/2),p=Math.floor(e/2),g=r-1,w=new F(+c,+p);w.z=+g;var b=this._tileCoordsToKey(w),C=this._tiles[b];return C&&C.active?(C.retain=!0,!0):(C&&C.loaded&&(C.retain=!0),g>h?this._retainParent(c,p,g,h):!1)},_retainChildren:function(t,e,r,h){for(var c=2*t;c<2*t+2;c++)for(var p=2*e;p<2*e+2;p++){var g=new F(c,p);g.z=r+1;var w=this._tileCoordsToKey(g),b=this._tiles[w];if(b&&b.active){b.retain=!0;continue}else b&&b.loaded&&(b.retain=!0);r+1<h&&this._retainChildren(c,p,r+1,h)}},_resetView:function(t){var e=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),e,e)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_clampZoom:function(t){var e=this.options;return e.minNativeZoom!==void 0&&t<e.minNativeZoom?e.minNativeZoom:e.maxNativeZoom!==void 0&&e.maxNativeZoom<t?e.maxNativeZoom:t},_setView:function(t,e,r,h){var c=Math.round(e);this.options.maxZoom!==void 0&&c>this.options.maxZoom||this.options.minZoom!==void 0&&c<this.options.minZoom?c=void 0:c=this._clampZoom(c);var p=this.options.updateWhenZooming&&c!==this._tileZoom;(!h||p)&&(this._tileZoom=c,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),c!==void 0&&this._update(t),r||this._pruneTiles(),this._noPrune=!!r),this._setZoomTransforms(t,e)},_setZoomTransforms:function(t,e){for(var r in this._levels)this._setZoomTransform(this._levels[r],t,e)},_setZoomTransform:function(t,e,r){var h=this._map.getZoomScale(r,t.zoom),c=t.origin.multiplyBy(h).subtract(this._map._getNewPixelOrigin(e,r)).round();I.any3d?ve(t.el,c,h):ut(t.el,c)},_resetGrid:function(){var t=this._map,e=t.options.crs,r=this._tileSize=this.getTileSize(),h=this._tileZoom,c=this._map.getPixelWorldBounds(this._tileZoom);c&&(this._globalTileRange=this._pxBoundsToTileRange(c)),this._wrapX=e.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,e.wrapLng[0]],h).x/r.x),Math.ceil(t.project([0,e.wrapLng[1]],h).x/r.y)],this._wrapY=e.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([e.wrapLat[0],0],h).y/r.x),Math.ceil(t.project([e.wrapLat[1],0],h).y/r.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(t){var e=this._map,r=e._animatingZoom?Math.max(e._animateToZoom,e.getZoom()):e.getZoom(),h=e.getZoomScale(r,this._tileZoom),c=e.project(t,this._tileZoom).floor(),p=e.getSize().divideBy(h*2);return new it(c.subtract(p),c.add(p))},_update:function(t){var e=this._map;if(e){var r=this._clampZoom(e.getZoom());if(t===void 0&&(t=e.getCenter()),this._tileZoom!==void 0){var h=this._getTiledPixelBounds(t),c=this._pxBoundsToTileRange(h),p=c.getCenter(),g=[],w=this.options.keepBuffer,b=new it(c.getBottomLeft().subtract([w,-w]),c.getTopRight().add([w,-w]));if(!(isFinite(c.min.x)&&isFinite(c.min.y)&&isFinite(c.max.x)&&isFinite(c.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var C in this._tiles){var k=this._tiles[C].coords;(k.z!==this._tileZoom||!b.contains(new F(k.x,k.y)))&&(this._tiles[C].current=!1)}if(Math.abs(r-this._tileZoom)>1){this._setView(t,r);return}for(var R=c.min.y;R<=c.max.y;R++)for(var Z=c.min.x;Z<=c.max.x;Z++){var xt=new F(Z,R);if(xt.z=this._tileZoom,!!this._isValidTile(xt)){var pt=this._tiles[this._tileCoordsToKey(xt)];pt?pt.current=!0:g.push(xt)}}if(g.sort(function(Ct,ze){return Ct.distanceTo(p)-ze.distanceTo(p)}),g.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Ot=document.createDocumentFragment();for(Z=0;Z<g.length;Z++)this._addTile(g[Z],Ot);this._level.el.appendChild(Ot)}}}},_isValidTile:function(t){var e=this._map.options.crs;if(!e.infinite){var r=this._globalTileRange;if(!e.wrapLng&&(t.x<r.min.x||t.x>r.max.x)||!e.wrapLat&&(t.y<r.min.y||t.y>r.max.y))return!1}if(!this.options.bounds)return!0;var h=this._tileCoordsToBounds(t);return ht(this.options.bounds).overlaps(h)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToNwSe:function(t){var e=this._map,r=this.getTileSize(),h=t.scaleBy(r),c=h.add(r),p=e.unproject(h,t.z),g=e.unproject(c,t.z);return[p,g]},_tileCoordsToBounds:function(t){var e=this._tileCoordsToNwSe(t),r=new St(e[0],e[1]);return this.options.noWrap||(r=this._map.wrapLatLngBounds(r)),r},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var e=t.split(":"),r=new F(+e[0],+e[1]);return r.z=+e[2],r},_removeTile:function(t){var e=this._tiles[t];e&&(nt(e.el),delete this._tiles[t],this.fire("tileunload",{tile:e.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){B(t,"leaflet-tile");var e=this.getTileSize();t.style.width=e.x+"px",t.style.height=e.y+"px",t.onselectstart=_,t.onmousemove=_,I.ielt9&&this.options.opacity<1&&It(t,this.options.opacity)},_addTile:function(t,e){var r=this._getTilePos(t),h=this._tileCoordsToKey(t),c=this.createTile(this._wrapCoords(t),l(this._tileReady,this,t));this._initTile(c),this.createTile.length<2&&vt(l(this._tileReady,this,t,null,c)),ut(c,r),this._tiles[h]={el:c,coords:t,current:!0},e.appendChild(c),this.fire("tileloadstart",{tile:c,coords:t})},_tileReady:function(t,e,r){e&&this.fire("tileerror",{error:e,tile:r,coords:t});var h=this._tileCoordsToKey(t);r=this._tiles[h],r&&(r.loaded=+new Date,this._map._fadeAnimated?(It(r.el,0),bt(this._fadeFrame),this._fadeFrame=vt(this._updateOpacity,this)):(r.active=!0,this._pruneTiles()),e||(B(r.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:r.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),I.ielt9||!this._map._fadeAnimated?vt(this._pruneTiles,this):setTimeout(l(this._pruneTiles,this),250)))},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var e=new F(this._wrapX?y(t.x,this._wrapX):t.x,this._wrapY?y(t.y,this._wrapY):t.y);return e.z=t.z,e},_pxBoundsToTileRange:function(t){var e=this.getTileSize();return new it(t.min.unscaleBy(e).floor(),t.max.unscaleBy(e).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}});function au(t){return new si(t)}var Oe=si.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(t,e){this._url=t,e=M(this,e),e.detectRetina&&I.retina&&e.maxZoom>0?(e.tileSize=Math.floor(e.tileSize/2),e.zoomReverse?(e.zoomOffset--,e.minZoom=Math.min(e.maxZoom,e.minZoom+1)):(e.zoomOffset++,e.maxZoom=Math.max(e.minZoom,e.maxZoom-1)),e.minZoom=Math.max(0,e.minZoom)):e.zoomReverse?e.minZoom=Math.min(e.maxZoom,e.minZoom):e.maxZoom=Math.max(e.minZoom,e.maxZoom),typeof e.subdomains=="string"&&(e.subdomains=e.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(t,e){return this._url===t&&e===void 0&&(e=!0),this._url=t,e||this.redraw(),this},createTile:function(t,e){var r=document.createElement("img");return D(r,"load",l(this._tileOnLoad,this,e,r)),D(r,"error",l(this._tileOnError,this,e,r)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(r.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(r.referrerPolicy=this.options.referrerPolicy),r.alt="",r.src=this.getTileUrl(t),r},getTileUrl:function(t){var e={r:I.retina?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var r=this._globalTileRange.max.y-t.y;this.options.tms&&(e.y=r),e["-y"]=r}return U(this._url,a(e,this.options))},_tileOnLoad:function(t,e){I.ielt9?setTimeout(l(t,this,null,e),0):t(null,e)},_tileOnError:function(t,e,r){var h=this.options.errorTileUrl;h&&e.getAttribute("src")!==h&&(e.src=h),t(r,e)},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom,e=this.options.maxZoom,r=this.options.zoomReverse,h=this.options.zoomOffset;return r&&(t=e-t),t+h},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_abortLoading:function(){var t,e;for(t in this._tiles)if(this._tiles[t].coords.z!==this._tileZoom&&(e=this._tiles[t].el,e.onload=_,e.onerror=_,!e.complete)){e.src=he;var r=this._tiles[t].coords;nt(e),delete this._tiles[t],this.fire("tileabort",{tile:e,coords:r})}},_removeTile:function(t){var e=this._tiles[t];if(e)return e.el.setAttribute("src",he),si.prototype._removeTile.call(this,t)},_tileReady:function(t,e,r){if(!(!this._map||r&&r.getAttribute("src")===he))return si.prototype._tileReady.call(this,t,e,r)}});function Ks(t,e){return new Oe(t,e)}var Gs=Oe.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,e){this._url=t;var r=a({},this.defaultWmsParams);for(var h in e)h in this.options||(r[h]=e[h]);e=M(this,e);var c=e.detectRetina&&I.retina?2:1,p=this.getTileSize();r.width=p.x*c,r.height=p.y*c,this.wmsParams=r},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[e]=this._crs.code,Oe.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._tileCoordsToNwSe(t),r=this._crs,h=Pt(r.project(e[0]),r.project(e[1])),c=h.min,p=h.max,g=(this._wmsVersion>=1.3&&this._crs===Bs?[c.y,c.x,p.y,p.x]:[c.x,c.y,p.x,p.y]).join(","),w=Oe.prototype.getTileUrl.call(this,t);return w+T(this.wmsParams,w,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+g},setParams:function(t,e){return a(this.wmsParams,t),e||this.redraw(),this}});function hu(t,e){return new Gs(t,e)}Oe.WMS=Gs,Ks.wms=hu;var se=Nt.extend({options:{padding:.1},initialize:function(t){M(this,t),f(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),B(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,e){var r=this._map.getZoomScale(e,this._zoom),h=this._map.getSize().multiplyBy(.5+this.options.padding),c=this._map.project(this._center,e),p=h.multiplyBy(-r).add(c).subtract(this._map._getNewPixelOrigin(t,e));I.any3d?ve(this._container,p,r):ut(this._container,p)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var t in this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,e=this._map.getSize(),r=this._map.containerPointToLayerPoint(e.multiplyBy(-t)).round();this._bounds=new it(r,r.add(e.multiplyBy(1+t*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Ys=se.extend({options:{tolerance:0},getEvents:function(){var t=se.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){se.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");D(t,"mousemove",this._onMouseMove,this),D(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),D(t,"mouseout",this._handleMouseOut,this),t._leaflet_disable_events=!0,this._ctx=t.getContext("2d")},_destroyContainer:function(){bt(this._redrawRequest),delete this._ctx,nt(this._container),X(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var t;this._redrawBounds=null;for(var e in this._layers)t=this._layers[e],t._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){se.prototype._update.call(this);var t=this._bounds,e=this._container,r=t.getSize(),h=I.retina?2:1;ut(e,t.min),e.width=h*r.x,e.height=h*r.y,e.style.width=r.x+"px",e.style.height=r.y+"px",I.retina&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update")}},_reset:function(){se.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t),this._layers[f(t)]=t;var e=t._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=e),this._drawLast=e,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var e=t._order,r=e.next,h=e.prev;r?r.prev=h:this._drawLast=h,h?h.next=r:this._drawFirst=r,delete t._order,delete this._layers[f(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if(typeof t.options.dashArray=="string"){var e=t.options.dashArray.split(/[, ]+/),r=[],h,c;for(c=0;c<e.length;c++){if(h=Number(e[c]),isNaN(h))return;r.push(h)}t.options._dashArray=r}else t.options._dashArray=t.options.dashArray},_requestRedraw:function(t){this._map&&(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||vt(this._redraw,this))},_extendRedrawBounds:function(t){if(t._pxBounds){var e=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new it,this._redrawBounds.extend(t._pxBounds.min.subtract([e,e])),this._redrawBounds.extend(t._pxBounds.max.add([e,e]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t=this._redrawBounds;if(t){var e=t.getSize();this._ctx.clearRect(t.min.x,t.min.y,e.x,e.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var t,e=this._redrawBounds;if(this._ctx.save(),e){var r=e.getSize();this._ctx.beginPath(),this._ctx.rect(e.min.x,e.min.y,r.x,r.y),this._ctx.clip()}this._drawing=!0;for(var h=this._drawFirst;h;h=h.next)t=h.layer,(!e||t._pxBounds&&t._pxBounds.intersects(e))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,e){if(this._drawing){var r,h,c,p,g=t._parts,w=g.length,b=this._ctx;if(w){for(b.beginPath(),r=0;r<w;r++){for(h=0,c=g[r].length;h<c;h++)p=g[r][h],b[h?"lineTo":"moveTo"](p.x,p.y);e&&b.closePath()}this._fillStroke(b,t)}}},_updateCircle:function(t){if(!(!this._drawing||t._empty())){var e=t._point,r=this._ctx,h=Math.max(Math.round(t._radius),1),c=(Math.max(Math.round(t._radiusY),1)||h)/h;c!==1&&(r.save(),r.scale(1,c)),r.beginPath(),r.arc(e.x,e.y/c,h,0,Math.PI*2,!1),c!==1&&r.restore(),this._fillStroke(r,t)}},_fillStroke:function(t,e){var r=e.options;r.fill&&(t.globalAlpha=r.fillOpacity,t.fillStyle=r.fillColor||r.color,t.fill(r.fillRule||"evenodd")),r.stroke&&r.weight!==0&&(t.setLineDash&&t.setLineDash(e.options&&e.options._dashArray||[]),t.globalAlpha=r.opacity,t.lineWidth=r.weight,t.strokeStyle=r.color,t.lineCap=r.lineCap,t.lineJoin=r.lineJoin,t.stroke())},_onClick:function(t){for(var e=this._map.mouseEventToLayerPoint(t),r,h,c=this._drawFirst;c;c=c.next)r=c.layer,r.options.interactive&&r._containsPoint(e)&&(!(t.type==="click"||t.type==="preclick")||!this._map._draggableMoved(r))&&(h=r);this._fireEvent(h?[h]:!1,t)},_onMouseMove:function(t){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var e=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,e)}},_handleMouseOut:function(t){var e=this._hoveredLayer;e&&(ot(this._container,"leaflet-interactive"),this._fireEvent([e],t,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(t,e){if(!this._mouseHoverThrottled){for(var r,h,c=this._drawFirst;c;c=c.next)r=c.layer,r.options.interactive&&r._containsPoint(e)&&(h=r);h!==this._hoveredLayer&&(this._handleMouseOut(t),h&&(B(this._container,"leaflet-interactive"),this._fireEvent([h],t,"mouseover"),this._hoveredLayer=h)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,t),this._mouseHoverThrottled=!0,setTimeout(l(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(t,e,r){this._map._fireDOMEvent(e,r||e.type,t)},_bringToFront:function(t){var e=t._order;if(e){var r=e.next,h=e.prev;if(r)r.prev=h;else return;h?h.next=r:r&&(this._drawFirst=r),e.prev=this._drawLast,this._drawLast.next=e,e.next=null,this._drawLast=e,this._requestRedraw(t)}},_bringToBack:function(t){var e=t._order;if(e){var r=e.next,h=e.prev;if(h)h.next=r;else return;r?r.prev=h:h&&(this._drawLast=h),e.prev=null,e.next=this._drawFirst,this._drawFirst.prev=e,this._drawFirst=e,this._requestRedraw(t)}}});function Vs(t){return I.canvas?new Ys(t):null}var oi=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch{}return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),uu={_initContainer:function(){this._container=W("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(se.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var e=t._container=oi("shape");B(e,"leaflet-vml-shape "+(this.options.className||"")),e.coordsize="1 1",t._path=oi("path"),e.appendChild(t._path),this._updateStyle(t),this._layers[f(t)]=t},_addPath:function(t){var e=t._container;this._container.appendChild(e),t.options.interactive&&t.addInteractiveTarget(e)},_removePath:function(t){var e=t._container;nt(e),t.removeInteractiveTarget(e),delete this._layers[f(t)]},_updateStyle:function(t){var e=t._stroke,r=t._fill,h=t.options,c=t._container;c.stroked=!!h.stroke,c.filled=!!h.fill,h.stroke?(e||(e=t._stroke=oi("stroke")),c.appendChild(e),e.weight=h.weight+"px",e.color=h.color,e.opacity=h.opacity,h.dashArray?e.dashStyle=rt(h.dashArray)?h.dashArray.join(" "):h.dashArray.replace(/( *, *)/g," "):e.dashStyle="",e.endcap=h.lineCap.replace("butt","flat"),e.joinstyle=h.lineJoin):e&&(c.removeChild(e),t._stroke=null),h.fill?(r||(r=t._fill=oi("fill")),c.appendChild(r),r.color=h.fillColor||h.color,r.opacity=h.fillOpacity):r&&(c.removeChild(r),t._fill=null)},_updateCircle:function(t){var e=t._point.round(),r=Math.round(t._radius),h=Math.round(t._radiusY||r);this._setPath(t,t._empty()?"M0 0":"AL "+e.x+","+e.y+" "+r+","+h+" 0,"+65535*360)},_setPath:function(t,e){t._path.v=e},_bringToFront:function(t){Ae(t._container)},_bringToBack:function(t){Me(t._container)}},zi=I.vml?oi:ts,ai=se.extend({_initContainer:function(){this._container=zi("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=zi("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){nt(this._container),X(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){se.prototype._update.call(this);var t=this._bounds,e=t.getSize(),r=this._container;(!this._svgSize||!this._svgSize.equals(e))&&(this._svgSize=e,r.setAttribute("width",e.x),r.setAttribute("height",e.y)),ut(r,t.min),r.setAttribute("viewBox",[t.min.x,t.min.y,e.x,e.y].join(" ")),this.fire("update")}},_initPath:function(t){var e=t._path=zi("path");t.options.className&&B(e,t.options.className),t.options.interactive&&B(e,"leaflet-interactive"),this._updateStyle(t),this._layers[f(t)]=t},_addPath:function(t){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){nt(t._path),t.removeInteractiveTarget(t._path),delete this._layers[f(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var e=t._path,r=t.options;e&&(r.stroke?(e.setAttribute("stroke",r.color),e.setAttribute("stroke-opacity",r.opacity),e.setAttribute("stroke-width",r.weight),e.setAttribute("stroke-linecap",r.lineCap),e.setAttribute("stroke-linejoin",r.lineJoin),r.dashArray?e.setAttribute("stroke-dasharray",r.dashArray):e.removeAttribute("stroke-dasharray"),r.dashOffset?e.setAttribute("stroke-dashoffset",r.dashOffset):e.removeAttribute("stroke-dashoffset")):e.setAttribute("stroke","none"),r.fill?(e.setAttribute("fill",r.fillColor||r.color),e.setAttribute("fill-opacity",r.fillOpacity),e.setAttribute("fill-rule",r.fillRule||"evenodd")):e.setAttribute("fill","none"))},_updatePoly:function(t,e){this._setPath(t,es(t._parts,e))},_updateCircle:function(t){var e=t._point,r=Math.max(Math.round(t._radius),1),h=Math.max(Math.round(t._radiusY),1)||r,c="a"+r+","+h+" 0 1,0 ",p=t._empty()?"M0 0":"M"+(e.x-r)+","+e.y+c+r*2+",0 "+c+-r*2+",0 ";this._setPath(t,p)},_setPath:function(t,e){t._path.setAttribute("d",e)},_bringToFront:function(t){Ae(t._path)},_bringToBack:function(t){Me(t._path)}});I.vml&&ai.include(uu);function Js(t){return I.svg||I.vml?new ai(t):null}q.include({getRenderer:function(t){var e=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return e||(e=this._renderer=this._createRenderer()),this.hasLayer(e)||this.addLayer(e),e},_getPaneRenderer:function(t){if(t==="overlayPane"||t===void 0)return!1;var e=this._paneRenderers[t];return e===void 0&&(e=this._createRenderer({pane:t}),this._paneRenderers[t]=e),e},_createRenderer:function(t){return this.options.preferCanvas&&Vs(t)||Js(t)}});var Xs=Ie.extend({initialize:function(t,e){Ie.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return t=ht(t),[t.getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}});function lu(t,e){return new Xs(t,e)}ai.create=zi,ai.pointsToPath=es,re.geometryToLayer=Ai,re.coordsToLatLng=Dn,re.coordsToLatLngs=Mi,re.latLngToCoords=Bn,re.latLngsToCoords=ki,re.getFeature=Re,re.asFeature=Ei,q.mergeOptions({boxZoom:!0});var Qs=Yt.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._resetStateTimeout=0,t.on("unload",this._destroy,this)},addHooks:function(){D(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){X(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){nt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(t){if(!t.shiftKey||t.which!==1&&t.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Xe(),bn(),this._startPoint=this._map.mouseEventToContainerPoint(t),D(document,{contextmenu:xe,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=W("div","leaflet-zoom-box",this._container),B(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var e=new it(this._point,this._startPoint),r=e.getSize();ut(this._box,e.min),this._box.style.width=r.x+"px",this._box.style.height=r.y+"px"},_finish:function(){this._moved&&(nt(this._box),ot(this._container,"leaflet-crosshair")),Qe(),Pn(),X(document,{contextmenu:xe,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if(!(t.which!==1&&t.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(l(this._resetState,this),0);var e=new St(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(e).fire("boxzoomend",{boxZoomBounds:e})}},_onKeyDown:function(t){t.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});q.addInitHook("addHandler","boxZoom",Qs),q.mergeOptions({doubleClickZoom:!0});var to=Yt.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,r=e.getZoom(),h=e.options.zoomDelta,c=t.originalEvent.shiftKey?r-h:r+h;e.options.doubleClickZoom==="center"?e.setZoom(c):e.setZoomAround(t.containerPoint,c)}});q.addInitHook("addHandler","doubleClickZoom",to),q.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var eo=Yt.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new le(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}B(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){ot(this._map._container,"leaflet-grab"),ot(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var t=this._map;if(t._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var e=ht(this._map.options.maxBounds);this._offsetLimit=Pt(this._map.latLngToContainerPoint(e.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(e.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var e=this._lastTime=+new Date,r=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(r),this._times.push(e),this._prunePositions(e)}this._map.fire("move",t).fire("drag",t)},_prunePositions:function(t){for(;this._positions.length>1&&t-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,e){return t-(t-e)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var t=this._draggable._newPos.subtract(this._draggable._startPos),e=this._offsetLimit;t.x<e.min.x&&(t.x=this._viscousLimit(t.x,e.min.x)),t.y<e.min.y&&(t.y=this._viscousLimit(t.y,e.min.y)),t.x>e.max.x&&(t.x=this._viscousLimit(t.x,e.max.x)),t.y>e.max.y&&(t.y=this._viscousLimit(t.y,e.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,e=Math.round(t/2),r=this._initialWorldOffset,h=this._draggable._newPos.x,c=(h-e+r)%t+e-r,p=(h+e+r)%t-e-r,g=Math.abs(c+r)<Math.abs(p+r)?c:p;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=g},_onDragEnd:function(t){var e=this._map,r=e.options,h=!r.inertia||t.noInertia||this._times.length<2;if(e.fire("dragend",t),h)e.fire("moveend");else{this._prunePositions(+new Date);var c=this._lastPos.subtract(this._positions[0]),p=(this._lastTime-this._times[0])/1e3,g=r.easeLinearity,w=c.multiplyBy(g/p),b=w.distanceTo([0,0]),C=Math.min(r.inertiaMaxSpeed,b),k=w.multiplyBy(C/b),R=C/(r.inertiaDeceleration*g),Z=k.multiplyBy(-R/2).round();!Z.x&&!Z.y?e.fire("moveend"):(Z=e._limitOffset(Z,e.options.maxBounds),vt(function(){e.panBy(Z,{duration:R,easeLinearity:g,noMoveStart:!0,animate:!0})}))}}});q.addInitHook("addHandler","dragging",eo),q.mergeOptions({keyboard:!0,keyboardPanDelta:80});var io=Yt.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),D(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),X(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var t=document.body,e=document.documentElement,r=t.scrollTop||e.scrollTop,h=t.scrollLeft||e.scrollLeft;this._map._container.focus(),window.scrollTo(h,r)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){var e=this._panKeys={},r=this.keyCodes,h,c;for(h=0,c=r.left.length;h<c;h++)e[r.left[h]]=[-1*t,0];for(h=0,c=r.right.length;h<c;h++)e[r.right[h]]=[t,0];for(h=0,c=r.down.length;h<c;h++)e[r.down[h]]=[0,t];for(h=0,c=r.up.length;h<c;h++)e[r.up[h]]=[0,-1*t]},_setZoomDelta:function(t){var e=this._zoomKeys={},r=this.keyCodes,h,c;for(h=0,c=r.zoomIn.length;h<c;h++)e[r.zoomIn[h]]=t;for(h=0,c=r.zoomOut.length;h<c;h++)e[r.zoomOut[h]]=-t},_addHooks:function(){D(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){X(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e=t.keyCode,r=this._map,h;if(e in this._panKeys){if(!r._panAnim||!r._panAnim._inProgress)if(h=this._panKeys[e],t.shiftKey&&(h=N(h).multiplyBy(3)),r.options.maxBounds&&(h=r._limitOffset(N(h),r.options.maxBounds)),r.options.worldCopyJump){var c=r.wrapLatLng(r.unproject(r.project(r.getCenter()).add(h)));r.panTo(c)}else r.panBy(h)}else if(e in this._zoomKeys)r.setZoom(r.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[e]);else if(e===27&&r._popup&&r._popup.options.closeOnEscapeKey)r.closePopup();else return;xe(t)}}});q.addInitHook("addHandler","keyboard",io),q.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var no=Yt.extend({addHooks:function(){D(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){X(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var e=Ts(t),r=this._map.options.wheelDebounceTime;this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var h=Math.max(r-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(l(this._performZoom,this),h),xe(t)},_performZoom:function(){var t=this._map,e=t.getZoom(),r=this._map.options.zoomSnap||0;t._stop();var h=this._delta/(this._map.options.wheelPxPerZoomLevel*4),c=4*Math.log(2/(1+Math.exp(-Math.abs(h))))/Math.LN2,p=r?Math.ceil(c/r)*r:c,g=t._limitZoom(e+(this._delta>0?p:-p))-e;this._delta=0,this._startTime=null,g&&(t.options.scrollWheelZoom==="center"?t.setZoom(e+g):t.setZoomAround(this._lastMousePos,e+g))}});q.addInitHook("addHandler","scrollWheelZoom",no);var cu=600;q.mergeOptions({tapHold:I.touchNative&&I.safari&&I.mobile,tapTolerance:15});var ro=Yt.extend({addHooks:function(){D(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){X(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(clearTimeout(this._holdTimeout),t.touches.length===1){var e=t.touches[0];this._startPos=this._newPos=new F(e.clientX,e.clientY),this._holdTimeout=setTimeout(l(function(){this._cancel(),this._isTapValid()&&(D(document,"touchend",_t),D(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",e))},this),cu),D(document,"touchend touchcancel contextmenu",this._cancel,this),D(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function t(){X(document,"touchend",_t),X(document,"touchend touchcancel",t)},_cancel:function(){clearTimeout(this._holdTimeout),X(document,"touchend touchcancel contextmenu",this._cancel,this),X(document,"touchmove",this._onMove,this)},_onMove:function(t){var e=t.touches[0];this._newPos=new F(e.clientX,e.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(t,e){var r=new MouseEvent(t,{bubbles:!0,cancelable:!0,view:window,screenX:e.screenX,screenY:e.screenY,clientX:e.clientX,clientY:e.clientY});r._simulated=!0,e.target.dispatchEvent(r)}});q.addInitHook("addHandler","tapHold",ro),q.mergeOptions({touchZoom:I.touch,bounceAtZoomLimits:!0});var so=Yt.extend({addHooks:function(){B(this._map._container,"leaflet-touch-zoom"),D(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){ot(this._map._container,"leaflet-touch-zoom"),X(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var e=this._map;if(!(!t.touches||t.touches.length!==2||e._animatingZoom||this._zooming)){var r=e.mouseEventToContainerPoint(t.touches[0]),h=e.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=e.getSize()._divideBy(2),this._startLatLng=e.containerPointToLatLng(this._centerPoint),e.options.touchZoom!=="center"&&(this._pinchStartLatLng=e.containerPointToLatLng(r.add(h)._divideBy(2))),this._startDist=r.distanceTo(h),this._startZoom=e.getZoom(),this._moved=!1,this._zooming=!0,e._stop(),D(document,"touchmove",this._onTouchMove,this),D(document,"touchend touchcancel",this._onTouchEnd,this),_t(t)}},_onTouchMove:function(t){if(!(!t.touches||t.touches.length!==2||!this._zooming)){var e=this._map,r=e.mouseEventToContainerPoint(t.touches[0]),h=e.mouseEventToContainerPoint(t.touches[1]),c=r.distanceTo(h)/this._startDist;if(this._zoom=e.getScaleZoom(c,this._startZoom),!e.options.bounceAtZoomLimits&&(this._zoom<e.getMinZoom()&&c<1||this._zoom>e.getMaxZoom()&&c>1)&&(this._zoom=e._limitZoom(this._zoom)),e.options.touchZoom==="center"){if(this._center=this._startLatLng,c===1)return}else{var p=r._add(h)._divideBy(2)._subtract(this._centerPoint);if(c===1&&p.x===0&&p.y===0)return;this._center=e.unproject(e.project(this._pinchStartLatLng,this._zoom).subtract(p),this._zoom)}this._moved||(e._moveStart(!0,!1),this._moved=!0),bt(this._animRequest);var g=l(e._move,e,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=vt(g,this,!0),_t(t)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,bt(this._animRequest),X(document,"touchmove",this._onTouchMove,this),X(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});q.addInitHook("addHandler","touchZoom",so),q.BoxZoom=Qs,q.DoubleClickZoom=to,q.Drag=eo,q.Keyboard=io,q.ScrollWheelZoom=no,q.TapHold=ro,q.TouchZoom=so,i.Bounds=it,i.Browser=I,i.CRS=ee,i.Canvas=Ys,i.Circle=Nn,i.CircleMarker=Ti,i.Class=S,i.Control=jt,i.DivIcon=Ws,i.DivOverlay=Vt,i.DomEvent=Mh,i.DomUtil=Th,i.Draggable=le,i.Evented=J,i.FeatureGroup=ie,i.GeoJSON=re,i.GridLayer=si,i.Handler=Yt,i.Icon=Ee,i.ImageOverlay=Ii,i.LatLng=Y,i.LatLngBounds=St,i.Layer=Nt,i.LayerGroup=ke,i.LineUtil=Hh,i.Map=q,i.Marker=Li,i.Mixin=Fh,i.Path=ce,i.Point=F,i.PolyUtil=jh,i.Polygon=Ie,i.Polyline=ne,i.Popup=Ri,i.PosAnimation=As,i.Projection=$h,i.Rectangle=Xs,i.Renderer=se,i.SVG=ai,i.SVGOverlay=Us,i.TileLayer=Oe,i.Tooltip=Oi,i.Transformation=ln,i.Util=hn,i.VideoOverlay=qs,i.bind=l,i.bounds=Pt,i.canvas=Vs,i.circle=Jh,i.circleMarker=Vh,i.control=ii,i.divIcon=ou,i.extend=a,i.featureGroup=Kh,i.geoJSON=$s,i.geoJson=tu,i.gridLayer=au,i.icon=Gh,i.imageOverlay=eu,i.latLng=$,i.latLngBounds=ht,i.layerGroup=Wh,i.map=kh,i.marker=Yh,i.point=N,i.polygon=Qh,i.polyline=Xh,i.popup=ru,i.rectangle=lu,i.setOptions=M,i.stamp=f,i.svg=Js,i.svgOverlay=nu,i.tileLayer=Ks,i.tooltip=su,i.transformation=Ge,i.version=s,i.videoOverlay=iu;var du=window.L;i.noConflict=function(){return window.L=du,this},window.L=i})})(mr,mr.exports);var $e=mr.exports;const qe=Ft($e);function Xi(o,n,i){return Object.freeze({instance:o,context:n,container:i})}function Qi(o,n){return n==null?function(s,a){const u=E.useRef();return u.current||(u.current=o(s,a)),u}:function(s,a){const u=E.useRef();u.current||(u.current=o(s,a));const l=E.useRef(s),{instance:d}=u.current;return E.useEffect(function(){l.current!==s&&(n(d,s,l.current),l.current=s)},[d,s,a]),u}}function _a(o,n){E.useEffect(function(){return(n.layerContainer??n.map).addLayer(o.instance),function(){var u;(u=n.layerContainer)==null||u.removeLayer(o.instance),n.map.removeLayer(o.instance)}},[n,o])}function va(o){return function(i){const s=Fr(),a=o(Ji(i,s),s);return ca(s.map,i.attribution),jr(a.current,i.eventHandlers),_a(a.current,s),a}}function Vl(o,n){const i=E.useRef();E.useEffect(function(){if(n.pathOptions!==i.current){const a=n.pathOptions??{};o.instance.setStyle(a),i.current=a}},[o,n])}function Jl(o){return function(i){const s=Fr(),a=o(Ji(i,s),s);return jr(a.current,i.eventHandlers),_a(a.current,s),Vl(a.current,i),a}}function Xl(o,n){const i=Qi(o,n),s=va(i);return ma(s)}function Ql(o,n){const i=Qi(o),s=Yl(i,n);return Kl(s)}function tc(o,n){const i=Qi(o,n),s=Jl(i);return ma(s)}function ec(o,n){const i=Qi(o,n),s=va(i);return Gl(s)}function ic(o,n,i){const{opacity:s,zIndex:a}=n;s!=null&&s!==i.opacity&&o.setOpacity(s),a!=null&&a!==i.zIndex&&o.setZIndex(a)}function _r(){return _r=Object.assign||function(o){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(o[s]=i[s])}return o},_r.apply(this,arguments)}function nc({bounds:o,boundsOptions:n,center:i,children:s,className:a,id:u,placeholder:l,style:d,whenReady:f,zoom:v,...y},_){const[x]=E.useState({className:a,id:u,style:d}),[P,A]=E.useState(null);E.useImperativeHandle(_,()=>(P==null?void 0:P.map)??null,[P]);const M=E.useCallback(j=>{if(j!==null&&P===null){const U=new $e.Map(j,y);i!=null&&v!=null?U.setView(i,v):o!=null&&U.fitBounds(o,n),f!=null&&U.whenReady(f),A(Wl(U))}},[]);E.useEffect(()=>()=>{P==null||P.map.remove()},[P]);const T=P?Bi.createElement(pa,{value:P},s):l??null;return Bi.createElement("div",_r({},x,{ref:M}),T)}const Nr=E.forwardRef(nc),Zi=Xl(function({position:n,...i},s){const a=new $e.Marker(n,i);return Xi(a,da(s,{overlayContainer:a}))},function(n,i,s){i.position!==s.position&&n.setLatLng(i.position),i.icon!=null&&i.icon!==s.icon&&n.setIcon(i.icon),i.zIndexOffset!=null&&i.zIndexOffset!==s.zIndexOffset&&n.setZIndexOffset(i.zIndexOffset),i.opacity!=null&&i.opacity!==s.opacity&&n.setOpacity(i.opacity),n.dragging!=null&&i.draggable!==s.draggable&&(i.draggable===!0?n.dragging.enable():n.dragging.disable())}),rc=tc(function({positions:n,...i},s){const a=new $e.Polyline(n,i);return Xi(a,da(s,{overlayContainer:a}))},function(n,i,s){i.positions!==s.positions&&n.setLatLngs(i.positions)}),ui=Ql(function(n,i){const s=new $e.Popup(n,i.overlayContainer);return Xi(s,i)},function(n,i,{position:s},a){E.useEffect(function(){const{instance:l}=n;function d(v){v.popup===l&&(l.update(),a(!0))}function f(v){v.popup===l&&a(!1)}return i.map.on({popupopen:d,popupclose:f}),i.overlayContainer==null?(s!=null&&l.setLatLng(s),l.openOn(i.map)):i.overlayContainer.bindPopup(l),function(){var y;i.map.off({popupopen:d,popupclose:f}),(y=i.overlayContainer)==null||y.unbindPopup(),i.map.removeLayer(l)}},[n,i,a,s])}),Dr=ec(function({url:n,...i},s){const a=new $e.TileLayer(n,Ji(i,s));return Xi(a,s)},function(n,i,s){ic(n,i,s);const{url:a}=i;a!=null&&a!==s.url&&n.setUrl(a)});delete qe.Icon.Default.prototype._getIconUrl;qe.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"});function sc(){const[o,n]=E.useState(""),[i,s]=E.useState(null),[a,u]=E.useState(""),l=async()=>{try{const d=await fetch(`/api/ipinfo?ip=${encodeURIComponent(o)}`);if(d.ok){const f=await d.json();s(f),u("")}else u("Failed to fetch IP information"),s(null)}catch{u("An error occurred while fetching data"),s(null)}};return m.jsx(ci,{maxWidth:"md",sx:{mt:4,mb:4},children:m.jsxs(Xt,{sx:{p:3},children:[m.jsx(Q,{variant:"h6",gutterBottom:!0,children:"IP Search"}),m.jsxs(wt,{sx:{display:"flex",gap:2,mb:4},children:[m.jsx(At,{fullWidth:!0,label:"Enter IP Address",value:o,onChange:d=>n(d.target.value),placeholder:"e.g. 2.3.4.5"}),m.jsx(Zt,{variant:"contained",startIcon:m.jsx(Vi,{}),onClick:l,sx:{minWidth:120},children:"Search"})]}),a&&m.jsx(Q,{color:"error",sx:{mb:2},children:a}),i&&m.jsxs(m.Fragment,{children:[m.jsx(Sr,{children:m.jsx(Cr,{children:m.jsxs(Lr,{children:[m.jsxs(Dt,{children:[m.jsx(H,{component:"th",scope:"row",children:"ASN"}),m.jsx(H,{children:i.asn})]}),m.jsxs(Dt,{children:[m.jsx(H,{component:"th",scope:"row",children:"Country"}),m.jsx(H,{children:i.country})]}),m.jsxs(Dt,{children:[m.jsx(H,{component:"th",scope:"row",children:"Region"}),m.jsx(H,{children:i.region})]}),m.jsxs(Dt,{children:[m.jsx(H,{component:"th",scope:"row",children:"ASN Type"}),m.jsx(H,{children:i.asnType})]}),m.jsxs(Dt,{children:[m.jsx(H,{component:"th",scope:"row",children:"IP Range"}),m.jsx(H,{children:i.ipRange.join(" - ")})]}),m.jsxs(Dt,{children:[m.jsx(H,{component:"th",scope:"row",children:"City ID"}),m.jsx(H,{children:i.cityId})]}),m.jsxs(Dt,{children:[m.jsx(H,{component:"th",scope:"row",children:"Location"}),m.jsx(H,{children:`${i.latitude}, ${i.longitude}`})]})]})})}),m.jsx(wt,{sx:{mt:3,height:400},children:m.jsxs(Nr,{center:[i.latitude,i.longitude],zoom:10,style:{height:"100%",width:"100%"},children:[m.jsx(Dr,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),m.jsx(Zi,{position:[i.latitude,i.longitude],children:m.jsxs(ui,{children:[i.asn,m.jsx("br",{}),i.cityId]})})]})})]})]})})}var Br={},oc=$t;Object.defineProperty(Br,"__esModule",{value:!0});var ga=Br.default=void 0,ac=oc(qt()),hc=m;ga=Br.default=(0,ac.default)((0,hc.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add");var Zr={},uc=$t;Object.defineProperty(Zr,"__esModule",{value:!0});var ya=Zr.default=void 0,lc=uc(qt()),cc=m;ya=Zr.default=(0,lc.default)((0,cc.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit");var Hr={},dc=$t;Object.defineProperty(Hr,"__esModule",{value:!0});var xa=Hr.default=void 0,fc=dc(qt()),pc=m;xa=Hr.default=(0,fc.default)((0,pc.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete");var $r={},mc=$t;Object.defineProperty($r,"__esModule",{value:!0});var wa=$r.default=void 0,_c=mc(qt()),vc=m;wa=$r.default=(0,_c.default)((0,vc.jsx)("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3m3-10H5V5h10z"}),"Save");delete qe.Icon.Default.prototype._getIconUrl;qe.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"});function gc(){const[o,n]=E.useState(""),[i,s]=E.useState([]),[a,u]=E.useState([]),[l,d]=E.useState(""),[f,v]=E.useState(!1),[y,_]=E.useState(""),x=async()=>{try{const T=await fetch(`/api/asninfo?filter=${encodeURIComponent(o)}`);if(T.ok){const j=await T.json();s(j),u([]),d("")}else d("Failed to fetch ASN information"),s([])}catch{d("An error occurred while fetching data"),s([])}},P=T=>{u(j=>j.includes(T)?j.filter(U=>U!==T):[...j,T])},A=async()=>{try{(await fetch("/api/cityset",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:y,cityIds:a})})).ok?(v(!1),_(""),u([])):d("Failed to save city set")}catch{d("An error occurred while saving")}},M=()=>{if(i.length===0)return[[0,0],[0,0]];const T=i.map(U=>U.latitude),j=i.map(U=>U.longitude);return[[Math.min(...T),Math.min(...j)],[Math.max(...T),Math.max(...j)]]};return m.jsxs(ci,{maxWidth:"lg",sx:{mt:4,mb:4},children:[m.jsxs(Xt,{sx:{p:3},children:[m.jsx(Q,{variant:"h6",gutterBottom:!0,children:"ASN Search"}),m.jsxs(wt,{sx:{display:"flex",gap:2,mb:4},children:[m.jsx(At,{fullWidth:!0,label:"Search ASNs",value:o,onChange:T=>n(T.target.value),placeholder:"e.g. Amazon"}),m.jsx(Zt,{variant:"contained",startIcon:m.jsx(Vi,{}),onClick:x,sx:{minWidth:120},children:"Search"})]}),l&&m.jsx(Q,{color:"error",sx:{mb:2},children:l}),i.length>0&&m.jsxs(m.Fragment,{children:[m.jsx(Sr,{children:m.jsxs(Cr,{children:[m.jsx(Ho,{children:m.jsxs(Dt,{children:[m.jsx(H,{padding:"checkbox",children:m.jsx(lo,{indeterminate:a.length>0&&a.length<i.length,checked:i.length>0&&a.length===i.length,onChange:()=>{a.length===i.length?u([]):u(i.map(T=>T.cityId))}})}),m.jsx(H,{children:"ASN"}),m.jsx(H,{children:"Country"}),m.jsx(H,{children:"Region"}),m.jsx(H,{children:"Type"}),m.jsx(H,{children:"IP Range"}),m.jsx(H,{children:"City ID"}),m.jsx(H,{children:"Location"})]})}),m.jsx(Lr,{children:i.map(T=>m.jsxs(Dt,{children:[m.jsx(H,{padding:"checkbox",children:m.jsx(lo,{checked:a.includes(T.cityId),onChange:()=>P(T.cityId)})}),m.jsx(H,{children:T.asn}),m.jsx(H,{children:T.country}),m.jsx(H,{children:T.region}),m.jsx(H,{children:T.asnType}),m.jsx(H,{children:T.ipRange.join(" - ")}),m.jsx(H,{children:T.cityId}),m.jsx(H,{children:`${T.latitude}, ${T.longitude}`})]},T.cityId))})]})}),m.jsx(wt,{sx:{mt:2,display:"flex",justifyContent:"flex-end"},children:m.jsx(Zt,{variant:"contained",startIcon:m.jsx(wa,{}),onClick:()=>v(!0),disabled:a.length===0,children:"Save as Set"})}),m.jsx(wt,{sx:{mt:3,height:400},children:m.jsxs(Nr,{bounds:M(),style:{height:"100%",width:"100%"},children:[m.jsx(Dr,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),i.map(T=>m.jsx(Zi,{position:[T.latitude,T.longitude],children:m.jsxs(ui,{children:[T.asn,m.jsx("br",{}),T.cityId]})},T.cityId))]})})]})]}),m.jsxs($o,{open:f,onClose:()=>v(!1),maxWidth:"sm",fullWidth:!0,children:[m.jsx(qo,{children:"Save City Set"}),m.jsx(Uo,{children:m.jsx(At,{autoFocus:!0,margin:"dense",label:"Set Name",fullWidth:!0,value:y,onChange:T=>_(T.target.value)})}),m.jsxs(Wo,{children:[m.jsx(Zt,{onClick:()=>v(!1),children:"Cancel"}),m.jsx(Zt,{onClick:A,disabled:!y.trim(),children:"Save"})]})]})]})}delete qe.Icon.Default.prototype._getIconUrl;qe.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"});function yc(){const[o,n]=E.useState([]),[i,s]=E.useState(""),[a,u]=E.useState([]),[l,d]=E.useState(""),[f,v]=E.useState([]),[y,_]=E.useState(""),[x,P]=E.useState([]),[A,M]=E.useState([]),[T,j]=E.useState(""),[U,rt]=E.useState([]),[yt,he]=E.useState(""),[Ue,We]=E.useState([]),[Le,Ke]=E.useState([]),[mt,vt]=E.useState(null);E.useEffect(()=>{(async()=>{try{const[K,st]=await Promise.all([fetch("/api/cityset"),fetch("/api/country")]),[J,F]=await Promise.all([K.json(),st.json()]);n(J),u(F)}catch(K){console.error("Error fetching initial data:",K)}})()},[]),E.useEffect(()=>{l?fetch(`/api/city?country=${l}`).then(S=>S.json()).then(S=>v(S)).catch(S=>console.error("Error fetching cities:",S)):v([])},[l]),E.useEffect(()=>{l&&y?fetch(`/api/asn?country=${l}&city=${y}`).then(S=>S.json()).then(S=>P(S)).catch(S=>console.error("Error fetching ASNs:",S)):P([])},[l,y]),E.useEffect(()=>{T?fetch(`/api/city?country=${T}`).then(S=>S.json()).then(S=>rt(S)).catch(S=>console.error("Error fetching destination cities:",S)):rt([])},[T]),E.useEffect(()=>{T&&yt?fetch(`/api/asn?country=${T}&city=${yt}`).then(S=>S.json()).then(S=>We(S)).catch(S=>console.error("Error fetching destination ASNs:",S)):We([])},[T,yt]);const bt=async()=>{var st;const S=i?(st=o.find(J=>J.id===i))==null?void 0:st.cityIds:A.map(J=>J.cityId),K=Le.map(J=>J.cityId);try{const F=await(await fetch(`/api/performance?src=${S.join(",")}&dist=${K.join(",")}`)).json();vt(F)}catch(J){console.error("Error fetching performance data:",J)}},hn=()=>{if(!mt)return[[0,0],[0,0]];const S=[...mt.sourceLocations.map(J=>[J.latitude,J.longitude]),...mt.destLocations.map(J=>[J.latitude,J.longitude])];if(S.length===0)return[[0,0],[0,0]];const K=S.map(J=>J[0]),st=S.map(J=>J[1]);return[[Math.min(...K),Math.min(...st)],[Math.max(...K),Math.max(...st)]]};return m.jsx(ci,{maxWidth:"lg",sx:{mt:4,mb:4},children:m.jsxs(Lt,{container:!0,spacing:3,children:[m.jsx(Lt,{item:!0,xs:12,md:6,children:m.jsxs(Xt,{sx:{p:2},children:[m.jsx(Q,{variant:"h6",gutterBottom:!0,children:"Source Selection"}),m.jsxs(Eu,{fullWidth:!0,sx:{mb:2},children:[m.jsx(Iu,{children:"City Set"}),m.jsxs(Ru,{value:i,onChange:S=>s(S.target.value),label:"City Set",children:[m.jsx(co,{value:"",children:m.jsx("em",{children:"None"})}),o.map(S=>m.jsx(co,{value:S.id,children:S.name},S.id))]})]}),!i&&m.jsxs(m.Fragment,{children:[m.jsx(Fe,{options:a,getOptionLabel:S=>S.name,value:a.find(S=>S.code===l)||null,onChange:(S,K)=>d((K==null?void 0:K.code)||""),renderInput:S=>m.jsx(At,{...S,label:"Country",fullWidth:!0,sx:{mb:2}})}),m.jsx(Fe,{options:f,getOptionLabel:S=>S.name,value:f.find(S=>S.id===y)||null,onChange:(S,K)=>_((K==null?void 0:K.id)||""),disabled:!l,renderInput:S=>m.jsx(At,{...S,label:"City",fullWidth:!0,sx:{mb:2}})}),m.jsx(Fe,{multiple:!0,options:x,getOptionLabel:S=>S.name,value:A,onChange:(S,K)=>M(K),disabled:!y,renderInput:S=>m.jsx(At,{...S,label:"ASNs",fullWidth:!0})})]})]})}),m.jsx(Lt,{item:!0,xs:12,md:6,children:m.jsxs(Xt,{sx:{p:2},children:[m.jsx(Q,{variant:"h6",gutterBottom:!0,children:"Destination Selection"}),m.jsx(Fe,{options:a,getOptionLabel:S=>S.name,value:a.find(S=>S.code===T)||null,onChange:(S,K)=>j((K==null?void 0:K.code)||""),renderInput:S=>m.jsx(At,{...S,label:"Country",fullWidth:!0,sx:{mb:2}})}),m.jsx(Fe,{options:U,getOptionLabel:S=>S.name,value:U.find(S=>S.id===yt)||null,onChange:(S,K)=>he((K==null?void 0:K.id)||""),disabled:!T,renderInput:S=>m.jsx(At,{...S,label:"City",fullWidth:!0,sx:{mb:2}})}),m.jsx(Fe,{multiple:!0,options:Ue,getOptionLabel:S=>S.name,value:Le,onChange:(S,K)=>Ke(K),disabled:!yt,renderInput:S=>m.jsx(At,{...S,label:"ASNs",fullWidth:!0})})]})}),m.jsx(Lt,{item:!0,xs:12,children:m.jsx(wt,{sx:{display:"flex",justifyContent:"center",mb:3},children:m.jsx(Zt,{variant:"contained",onClick:bt,disabled:!i&&!A.length||!Le.length,children:"Search"})})}),mt&&m.jsxs(m.Fragment,{children:[m.jsx(Lt,{item:!0,xs:12,children:m.jsxs(Lt,{container:!0,spacing:2,children:[m.jsx(Lt,{item:!0,xs:3,children:m.jsx(ji,{children:m.jsxs(Ni,{children:[m.jsx(Q,{color:"textSecondary",gutterBottom:!0,children:"Sample Count"}),m.jsx(Q,{variant:"h5",children:mt.samples})]})})}),m.jsx(Lt,{item:!0,xs:3,children:m.jsx(ji,{children:m.jsxs(Ni,{children:[m.jsx(Q,{color:"textSecondary",gutterBottom:!0,children:"Average Latency"}),m.jsxs(Q,{variant:"h5",children:[mt.avgLatency,"ms"]})]})})}),m.jsx(Lt,{item:!0,xs:3,children:m.jsx(ji,{children:m.jsxs(Ni,{children:[m.jsx(Q,{color:"textSecondary",gutterBottom:!0,children:"Median Latency"}),m.jsxs(Q,{variant:"h5",children:[mt.medianLatency,"ms"]})]})})}),m.jsx(Lt,{item:!0,xs:3,children:m.jsx(ji,{children:m.jsxs(Ni,{children:[m.jsx(Q,{color:"textSecondary",gutterBottom:!0,children:"P70 Latency"}),m.jsxs(Q,{variant:"h5",children:[mt.p70Latency,"ms"]})]})})})]})}),m.jsx(Lt,{item:!0,xs:12,children:m.jsxs(Xt,{sx:{p:2},children:[m.jsx(Q,{variant:"h6",gutterBottom:!0,children:"Latency Trend (Last 7 Days)"}),m.jsx($n,{width:"100%",height:300,children:m.jsxs(Uu,{data:mt.timeSeriesData,children:[m.jsx(qn,{strokeDasharray:"3 3"}),m.jsx(Un,{dataKey:"date"}),m.jsx(Wn,{}),m.jsx(Kn,{}),m.jsx(Wu,{type:"monotone",dataKey:"avgLatency",stroke:"#8884d8"})]})})]})}),m.jsx(Lt,{item:!0,xs:12,md:6,children:m.jsxs(Xt,{sx:{p:2},children:[m.jsx(Q,{variant:"h6",gutterBottom:!0,children:"ASN Latency Distribution"}),m.jsx($n,{width:"100%",height:300,children:m.jsxs(fo,{data:mt.asnData,children:[m.jsx(qn,{strokeDasharray:"3 3"}),m.jsx(Un,{dataKey:"asn"}),m.jsx(Wn,{}),m.jsx(Kn,{}),m.jsx(po,{dataKey:"avgLatency",fill:"#8884d8"})]})})]})}),m.jsx(Lt,{item:!0,xs:12,md:6,children:m.jsxs(Xt,{sx:{p:2},children:[m.jsx(Q,{variant:"h6",gutterBottom:!0,children:"City Latency Distribution"}),m.jsx($n,{width:"100%",height:300,children:m.jsxs(fo,{data:mt.cityData,children:[m.jsx(qn,{strokeDasharray:"3 3"}),m.jsx(Un,{dataKey:"city"}),m.jsx(Wn,{}),m.jsx(Kn,{}),m.jsx(po,{dataKey:"avgLatency",fill:"#82ca9d"})]})})]})}),m.jsx(Lt,{item:!0,xs:12,children:m.jsxs(Xt,{sx:{p:2},children:[m.jsx(Q,{variant:"h6",gutterBottom:!0,children:"Location Distribution"}),m.jsx(wt,{sx:{height:400},children:m.jsxs(Nr,{bounds:hn(),style:{height:"100%",width:"100%"},children:[m.jsx(Dr,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),mt.sourceLocations.map(S=>m.jsx(Zi,{position:[S.latitude,S.longitude],children:m.jsxs(ui,{children:["Source ASN: ",S.asn,m.jsx("br",{}),S.cityId]})},`src-${S.cityId}`)),mt.destLocations.map(S=>m.jsx(Zi,{position:[S.latitude,S.longitude],children:m.jsxs(ui,{children:["Destination ASN: ",S.asn,m.jsx("br",{}),S.cityId]})},`dst-${S.cityId}`)),mt.latencyData.map(S=>m.jsx(rc,{positions:[[S.sourceLat,S.sourceLon],[S.destLat,S.destLon]],color:"#1976d2",weight:2,opacity:.5,children:m.jsxs(ui,{children:["Source: ",S.sourceAsn,m.jsx("br",{}),"Destination: ",S.destAsn,m.jsx("br",{}),"Latency: ",S.latency,"ms"]})},`${S.sourceCityId}-${S.destCityId}`))]})})]})})]})]})})}function xc(){const[o,n]=E.useState([]),[i,s]=E.useState(!1),[a,u]=E.useState(null),[l,d]=E.useState(""),[f,v]=E.useState(""),[y,_]=E.useState("");E.useEffect(()=>{x()},[]);const x=async()=>{try{const j=await fetch("/api/cityset");if(j.ok){const U=await j.json();n(U)}else _("Failed to fetch city sets")}catch{_("An error occurred while fetching city sets")}},P=(j=null)=>{j?(u(j),d(j.name),v(j.cityIds.join(","))):(u(null),d(""),v("")),s(!0)},A=()=>{s(!1),u(null),d(""),v(""),_("")},M=async()=>{try{const j=f.split(",").map(yt=>yt.trim()).filter(Boolean);(await fetch("/api/cityset",{method:a?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:l,cityIds:j})})).ok?(A(),x()):_("Failed to save city set")}catch{_("An error occurred while saving")}},T=async j=>{if(window.confirm("Are you sure you want to delete this city set?"))try{(await fetch(`/api/cityset/${j}`,{method:"DELETE"})).ok?x():_("Failed to delete city set")}catch{_("An error occurred while deleting")}};return m.jsxs(ci,{maxWidth:"lg",sx:{mt:4,mb:4},children:[m.jsxs(Xt,{sx:{p:2},children:[m.jsxs(wt,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[m.jsx(Q,{variant:"h6",children:"City Sets"}),m.jsx(Zt,{variant:"contained",startIcon:m.jsx(ga,{}),onClick:()=>P(),children:"Add New Set"})]}),y&&m.jsx(Q,{color:"error",sx:{mb:2},children:y}),m.jsx(Sr,{children:m.jsxs(Cr,{children:[m.jsx(Ho,{children:m.jsxs(Dt,{children:[m.jsx(H,{children:"Name"}),m.jsx(H,{children:"City IDs"}),m.jsx(H,{align:"right",children:"Actions"})]})}),m.jsx(Lr,{children:o.map(j=>m.jsxs(Dt,{children:[m.jsx(H,{children:j.name}),m.jsx(H,{children:m.jsx(Ou,{direction:"row",spacing:1,flexWrap:"wrap",children:j.cityIds.map(U=>m.jsx(zu,{label:U,size:"small",sx:{my:.5}},U))})}),m.jsxs(H,{align:"right",children:[m.jsx(Di,{color:"primary",onClick:()=>P(j),children:m.jsx(ya,{})}),m.jsx(Di,{color:"error",onClick:()=>T(j.id),children:m.jsx(xa,{})})]})]},j.id))})]})})]}),m.jsxs($o,{open:i,onClose:A,maxWidth:"sm",fullWidth:!0,children:[m.jsx(qo,{children:a?"Edit City Set":"New City Set"}),m.jsxs(Uo,{children:[m.jsx(At,{autoFocus:!0,margin:"dense",label:"Set Name",fullWidth:!0,value:l,onChange:j=>d(j.target.value),sx:{mb:2}}),m.jsx(At,{margin:"dense",label:"City IDs",fullWidth:!0,multiline:!0,rows:4,value:f,onChange:j=>v(j.target.value),helperText:"Enter comma-separated city IDs"})]}),m.jsxs(Wo,{children:[m.jsx(Zt,{onClick:A,children:"Cancel"}),m.jsx(Zt,{onClick:M,disabled:!l||!f,children:"Save"})]})]})]})}var wc=Object.prototype.toString;function bc(o){return wc.call(o)==="[object Function]"}var ba=function(o,n){if(!(o instanceof n))throw new TypeError("Cannot call a class as a function")},Hi=function(){function o(n,i){for(var s=0;s<i.length;s++){var a=i[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(n,a.key,a)}}return function(n,i,s){return i&&o(n.prototype,i),s&&o(n,s),n}}();function go(o){return o.split("").map(function(n){return"(?:"+n.toUpperCase()+"|"+n.toLowerCase()+")"}).join("")}function je(o,n){for(var i=o.length-1;i>=0;i--)o[i]===n&&Array.prototype.splice.call(o,i,1)}function Pc(o,n){return Object.prototype.hasOwnProperty.call(o,n)}var Vn={},yo=function(){Hi(o,null,[{key:"getInstance",value:function(i){return Vn[i]=Vn[i]||new o,Vn[i]}}]);function o(){ba(this,o),this.plurals=[],this.singulars=[],this.uncountables=[],this.humans=[],this.acronyms={},this.acronymRegex=/(?=a)b/}return Hi(o,[{key:"acronym",value:function(i){this.acronyms[i.toLowerCase()]=i;var s=[];for(var a in this.acronyms)Pc(this.acronyms,a)&&s.push(this.acronyms[a]);this.acronymRegex=new RegExp(s.join("|"))}},{key:"plural",value:function(i,s){typeof i=="string"&&je(this.uncountables,i),je(this.uncountables,s),this.plurals.unshift([i,s])}},{key:"singular",value:function(i,s){typeof i=="string"&&je(this.uncountables,i),je(this.uncountables,s),this.singulars.unshift([i,s])}},{key:"irregular",value:function(i,s){je(this.uncountables,i),je(this.uncountables,s);var a=i[0],u=i.substr(1),l=s[0],d=s.substr(1);if(a.toUpperCase()===l.toUpperCase())this.plural(new RegExp("("+a+")"+u+"$","i"),"$1"+d),this.plural(new RegExp("("+l+")"+d+"$","i"),"$1"+d),this.singular(new RegExp("("+a+")"+u+"$","i"),"$1"+u),this.singular(new RegExp("("+l+")"+d+"$","i"),"$1"+u);else{var f=go(u),v=go(d);this.plural(new RegExp(a.toUpperCase()+f+"$"),l.toUpperCase()+d),this.plural(new RegExp(a.toLowerCase()+f+"$"),l.toLowerCase()+d),this.plural(new RegExp(l.toUpperCase()+v+"$"),l.toUpperCase()+d),this.plural(new RegExp(l.toLowerCase()+v+"$"),l.toLowerCase()+d),this.singular(new RegExp(a.toUpperCase()+f+"$"),a.toUpperCase()+u),this.singular(new RegExp(a.toLowerCase()+f+"$"),a.toLowerCase()+u),this.singular(new RegExp(l.toUpperCase()+v+"$"),a.toUpperCase()+u),this.singular(new RegExp(l.toLowerCase()+v+"$"),a.toLowerCase()+u)}}},{key:"uncountable",value:function(){for(var i=arguments.length,s=Array(i),a=0;a<i;a++)s[a]=arguments[a];this.uncountables=this.uncountables.concat(s)}},{key:"human",value:function(i,s){this.humans.unshift([i,s])}},{key:"clear",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"all";i==="all"?(this.plurals=[],this.singulars=[],this.uncountables=[],this.humans=[]):this[i]=[]}}]),o}();function Sc(o){o.plural(/$/,"s"),o.plural(/s$/i,"s"),o.plural(/^(ax|test)is$/i,"$1es"),o.plural(/(octop|vir)us$/i,"$1i"),o.plural(/(octop|vir)i$/i,"$1i"),o.plural(/(alias|status)$/i,"$1es"),o.plural(/(bu)s$/i,"$1ses"),o.plural(/(buffal|tomat)o$/i,"$1oes"),o.plural(/([ti])um$/i,"$1a"),o.plural(/([ti])a$/i,"$1a"),o.plural(/sis$/i,"ses"),o.plural(/(?:([^f])fe|([lr])f)$/i,"$1$2ves"),o.plural(/(hive)$/i,"$1s"),o.plural(/([^aeiouy]|qu)y$/i,"$1ies"),o.plural(/(x|ch|ss|sh)$/i,"$1es"),o.plural(/(matr|vert|ind)(?:ix|ex)$/i,"$1ices"),o.plural(/^(m|l)ouse$/i,"$1ice"),o.plural(/^(m|l)ice$/i,"$1ice"),o.plural(/^(ox)$/i,"$1en"),o.plural(/^(oxen)$/i,"$1"),o.plural(/(quiz)$/i,"$1zes"),o.singular(/s$/i,""),o.singular(/(ss)$/i,"$1"),o.singular(/(n)ews$/i,"$1ews"),o.singular(/([ti])a$/i,"$1um"),o.singular(/((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)(sis|ses)$/i,"$1sis"),o.singular(/(^analy)(sis|ses)$/i,"$1sis"),o.singular(/([^f])ves$/i,"$1fe"),o.singular(/(hive)s$/i,"$1"),o.singular(/(tive)s$/i,"$1"),o.singular(/([lr])ves$/i,"$1f"),o.singular(/([^aeiouy]|qu)ies$/i,"$1y"),o.singular(/(s)eries$/i,"$1eries"),o.singular(/(m)ovies$/i,"$1ovie"),o.singular(/(x|ch|ss|sh)es$/i,"$1"),o.singular(/^(m|l)ice$/i,"$1ouse"),o.singular(/(bus)(es)?$/i,"$1"),o.singular(/(o)es$/i,"$1"),o.singular(/(shoe)s$/i,"$1"),o.singular(/(cris|test)(is|es)$/i,"$1is"),o.singular(/^(a)x[ie]s$/i,"$1xis"),o.singular(/(octop|vir)(us|i)$/i,"$1us"),o.singular(/(alias|status)(es)?$/i,"$1"),o.singular(/^(ox)en/i,"$1"),o.singular(/(vert|ind)ices$/i,"$1ex"),o.singular(/(matr)ices$/i,"$1ix"),o.singular(/(quiz)zes$/i,"$1"),o.singular(/(database)s$/i,"$1"),o.irregular("person","people"),o.irregular("man","men"),o.irregular("child","children"),o.irregular("sex","sexes"),o.irregular("move","moves"),o.irregular("zombie","zombies"),o.uncountable("equipment","information","rice","money","species","series","fish","sheep","jeans","police")}var xo={en:Sc};function Se(o,n){if(bc(o)&&(n=o,o=null),o=o||"en",n)n(yo.getInstance(o));else return yo.getInstance(o)}for(var wo in xo)Se(wo,xo[wo]);function Pa(o,n){var i=""+o,s,a,u;if(i.length===0)return i;var l=i.toLowerCase().match(/\b\w+$/);if(l&&Se().uncountables.indexOf(l[0])>-1)return i;for(var d=0,f=n.length;d<f;d++)if(s=n[d],a=s[0],u=s[1],i.match(a)){i=i.replace(a,u);break}return i}function Sa(o){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"en";return Pa(o,Se(n).plurals)}function Ca(o){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"en";return Pa(o,Se(n).singulars)}function La(o){var n=o==null?"":String(o);return n.charAt(0).toUpperCase()+n.slice(1)}function Cc(o,n){var i=""+o;return i=i.replace(new RegExp("^(?:"+Se().acronymRegex.source+"(?=\\b|[A-Z_])|\\w)"),function(s){return s.toLowerCase()}),i=i.replace(/(?:_|(\/))([a-z\d]*)/gi,function(s,a,u,l,d){return a||(a=""),""+a+(Se().acronyms[u]||La(u))}),i}function Lc(o){var n=""+o;return n=n.replace(new RegExp("(?:([A-Za-z\\d])|^)("+Se().acronymRegex.source+")(?=\\b|[^a-z])","g"),function(i,s,a){return""+(s||"")+(s?"_":"")+a.toLowerCase()}),n=n.replace(/([A-Z\d]+)([A-Z][a-z])/g,"$1_$2"),n=n.replace(/([a-z\d])([A-Z])/g,"$1_$2"),n=n.replace(/-/g,"_"),n.toLowerCase()}function Tc(o){return o.replace(/_/g,"-")}var bo={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",Æ:"AE",Ç:"C",È:"E",É:"E",Ê:"E",Ë:"E",Ì:"I",Í:"I",Î:"I",Ï:"I",Ð:"D",Ñ:"N",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O","×":"x",Ø:"O",Ù:"U",Ú:"U",Û:"U",Ü:"U",Ý:"Y",Þ:"Th",ß:"ss",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",æ:"ae",ç:"c",è:"e",é:"e",ê:"e",ë:"e",ì:"i",í:"i",î:"i",ï:"i",ð:"d",ñ:"n",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",ù:"u",ú:"u",û:"u",ü:"u",ý:"y",þ:"th",ÿ:"y",Ā:"A",ā:"a",Ă:"A",ă:"a",Ą:"A",ą:"a",Ć:"C",ć:"c",Ĉ:"C",ĉ:"c",Ċ:"C",ċ:"c",Č:"C",č:"c",Ď:"D",ď:"d",Đ:"D",đ:"d",Ē:"E",ē:"e",Ĕ:"E",ĕ:"e",Ė:"E",ė:"e",Ę:"E",ę:"e",Ě:"E",ě:"e",Ĝ:"G",ĝ:"g",Ğ:"G",ğ:"g",Ġ:"G",ġ:"g",Ģ:"G",ģ:"g",Ĥ:"H",ĥ:"h",Ħ:"H",ħ:"h",Ĩ:"I",ĩ:"i",Ī:"I",ī:"i",Ĭ:"I",ĭ:"i",Į:"I",į:"i",İ:"I",ı:"i",Ĳ:"IJ",ĳ:"ij",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",ĺ:"l",Ļ:"L",ļ:"l",Ľ:"L",ľ:"l",Ŀ:"L",ŀ:"l",Ł:"L",ł:"l",Ń:"N",ń:"n",Ņ:"N",ņ:"n",Ň:"N",ň:"n",ŉ:"'n",Ŋ:"NG",ŋ:"ng",Ō:"O",ō:"o",Ŏ:"O",ŏ:"o",Ő:"O",ő:"o",Œ:"OE",œ:"oe",Ŕ:"R",ŕ:"r",Ŗ:"R",ŗ:"r",Ř:"R",ř:"r",Ś:"S",ś:"s",Ŝ:"S",ŝ:"s",Ş:"S",ş:"s",Š:"S",š:"s",Ţ:"T",ţ:"t",Ť:"T",ť:"t",Ŧ:"T",ŧ:"t",Ũ:"U",ũ:"u",Ū:"U",ū:"u",Ŭ:"U",ŭ:"u",Ů:"U",ů:"u",Ű:"U",ű:"u",Ų:"U",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",ź:"z",Ż:"Z",ż:"z",Ž:"Z",ž:"z",А:"A",Б:"B",В:"V",Г:"G",Д:"D",Е:"E",Ё:"E",Ж:"ZH",З:"Z",И:"I",Й:"J",К:"K",Л:"L",М:"M",Н:"N",О:"O",П:"P",Р:"R",С:"S",Т:"T",У:"U",Ф:"F",Х:"KH",Ц:"C",Ч:"CH",Ш:"SH",Щ:"SHCH",Ъ:"",Ы:"Y",Ь:"",Э:"E",Ю:"YU",Я:"YA",а:"a",б:"b",в:"v",г:"g",д:"d",е:"e",ё:"e",ж:"zh",з:"z",и:"i",й:"j",к:"k",л:"l",м:"m",н:"n",о:"o",п:"p",р:"r",с:"s",т:"t",у:"u",ф:"f",х:"kh",ц:"c",ч:"ch",ш:"sh",щ:"shch",ъ:"",ы:"y",ь:"",э:"e",ю:"yu",я:"ya"},Ac="?",Jn={};(function(){Hi(o,null,[{key:"getInstance",value:function(i){return Jn[i]=Jn[i]||new o,Jn[i]}}]);function o(){ba(this,o),this.approximations={};for(var n in bo)this.approximate(n,bo[n])}return Hi(o,[{key:"approximate",value:function(i,s){this.approximations[i]=s}},{key:"transliterate",value:function(i,s){var a=this;return i.replace(/[^\u0000-\u007f]/g,function(u){return a.approximations[u]||s||Ac})}}]),o})();var Mc=Ku,kc=Mc("toLowerCase"),Ec=kc;const Ic=Ft(Ec);var Rc=Gu,Oc=1,zc=4;function Fc(o){return Rc(o,Oc|zc)}var jc=Fc;const Nc=Ft(jc);var Dc=Vo,Bc=Tr,Zc=Yu,Hc=Vu,$c=Jo;function qc(o,n,i){n=Bc(n,o),o=Hc(o,n);var s=o==null?o:o[$c(Zc(n))];return s==null?void 0:Dc(s,o,i)}var Uc=qc,Wc=Vo,Kc=Ju,Gc=Uc,Yc=Xo,Vc=Ar,Jc=Yc(function(o,n,i){var s=-1,a=typeof n=="function",u=Vc(o)?Array(o.length):[];return Kc(o,function(l){u[++s]=a?Wc(n,l,i):Gc(l,n,i)}),u}),Xc=Jc;const me=Ft(Xc);function Qc(o){for(var n=-1,i=o==null?0:o.length,s=0,a=[];++n<i;){var u=o[n];u&&(a[s++]=u)}return a}var td=Qc;const tn=Ft(td);var ed=Object.prototype,id=ed.hasOwnProperty;function nd(o,n){return o!=null&&id.call(o,n)}var rd=nd,sd=rd,od=Xu;function ad(o,n){return o!=null&&od(o,n,sd)}var hd=ad;const ud=Ft(hd);var ld=Qu;function cd(o,n){return ld(n,function(i){return o[i]})}var dd=cd,fd=dd,pd=Qo;function md(o){return o==null?[]:fd(o,pd(o))}var _d=md;const Xn=Ft(_d);var vd=tl,gd=el,yd=il,xd=nl,wd=Ar,bd=rl,Pd=ta,Sd=sl,Cd="[object Map]",Ld="[object Set]",Td=Object.prototype,Ad=Td.hasOwnProperty;function Md(o){if(o==null)return!0;if(wd(o)&&(xd(o)||typeof o=="string"||typeof o.splice=="function"||bd(o)||Sd(o)||yd(o)))return!o.length;var n=gd(o);if(n==Cd||n==Ld)return!o.size;if(Pd(o))return!vd(o).length;for(var i in o)if(Ad.call(o,i))return!1;return!0}var kd=Md;const vr=Ft(kd);var Ed=ol;function Id(o){return typeof o=="function"?o:Ed}var Rd=Id,Od=al,zd=Rd,Fd=hl;function jd(o,n){return o==null?o:Od(o,zd(n),Fd)}var Nd=jd;const Dd=Ft(Nd);var Bd=ea,Zd=Tr,Hd=ul,Po=ll,$d=Jo;function qd(o,n,i,s){if(!Po(o))return o;n=Zd(n,o);for(var a=-1,u=n.length,l=u-1,d=o;d!=null&&++a<u;){var f=$d(n[a]),v=i;if(f==="__proto__"||f==="constructor"||f==="prototype")return o;if(a!=l){var y=d[f];v=s?s(y,f,d):void 0,v===void 0&&(v=Po(y)?y:Hd(n[a+1])?[]:{})}Bd(d,f,v),d=d[f]}return o}var Ud=qd,Wd=cl,Kd=Ud,Gd=Tr;function Yd(o,n,i){for(var s=-1,a=n.length,u={};++s<a;){var l=n[s],d=Wd(o,l);i(d,l)&&Kd(u,Gd(l,o),d)}return u}var Vd=Yd,Jd=Vd,Xd=dl;function Qd(o,n){return Jd(o,n,function(i,s){return Xd(o,s)})}var tf=Qd,ef=tf,nf=fl,rf=nf(function(o,n){return o==null?{}:ef(o,n)}),sf=rf;const of=Ft(sf);var af=Xo,hf=pl;function uf(o){return af(function(n,i){var s=-1,a=i.length,u=a>1?i[a-1]:void 0,l=a>2?i[2]:void 0;for(u=o.length>3&&typeof u=="function"?(a--,u):void 0,l&&hf(i[0],i[1],l)&&(u=a<3?void 0:u,a=1),n=Object(n);++s<a;){var d=i[s];d&&o(n,d,s,u)}return n})}var lf=uf,cf=ea,df=ml,ff=lf,pf=Ar,mf=ta,_f=Qo,vf=Object.prototype,gf=vf.hasOwnProperty,yf=ff(function(o,n){if(mf(n)||pf(n)){df(n,_f(n),o);return}for(var i in n)gf.call(n,i)&&cf(o,i,n[i])}),xf=yf;const gr=Ft(xf);var wf=_l;function bf(o){return typeof o=="number"&&o==wf(o)}var Pf=bf;const So=Ft(Pf);typeof oe<"u"&&typeof oe.self>"u"&&(oe.self={},oe.__pretenderNodePolyfill=!0);var Sf=Object.create;function yr(){var o=Sf(null);return o.__=void 0,delete o.__,o}var Ta=function(n,i,s){this.path=n,this.matcher=i,this.delegate=s};Ta.prototype.to=function(n,i){var s=this.delegate;if(s&&s.willAddRoute&&(n=s.willAddRoute(this.matcher.target,n)),this.matcher.add(this.path,n),i){if(i.length===0)throw new Error("You must have an argument in the function passed to `to`");this.matcher.addChild(this.path,n,i,this.delegate)}};var $i=function(n){this.routes=yr(),this.children=yr(),this.target=n};$i.prototype.add=function(n,i){this.routes[n]=i};$i.prototype.addChild=function(n,i,s,a){var u=new $i(i);this.children[n]=u;var l=qr(n,u,a);a&&a.contextEntered&&a.contextEntered(i,l),s(l)};function qr(o,n,i){function s(a,u){var l=o+a;if(u)u(qr(l,n,i));else return new Ta(l,n,i)}return s}function Cf(o,n,i){for(var s=0,a=0;a<o.length;a++)s+=o[a].path.length;n=n.substr(s);var u={path:n,handler:i};o.push(u)}function Aa(o,n,i,s){for(var a=n.routes,u=Object.keys(a),l=0;l<u.length;l++){var d=u[l],f=o.slice();Cf(f,d,a[d]);var v=n.children[d];v?Aa(f,v,i,s):i.call(s,f)}}var Lf=function(o,n){var i=new $i;o(qr("",i,this.delegate)),Aa([],i,function(s){n?n(this,s):this.add(s)},this)};function Ma(o){return o.split("/").map(Ur).join("/")}var Tf=/%|\//g;function Ur(o){return o.length<3||o.indexOf("%")===-1?o:decodeURIComponent(o).replace(Tf,encodeURIComponent)}var Af=/%(?:2(?:4|6|B|C)|3(?:B|D|A)|40)/g;function ka(o){return encodeURIComponent(o).replace(Af,decodeURIComponent)}var Mf=/(\/|\.|\*|\+|\?|\||\(|\)|\[|\]|\{|\}|\\)/g,en=Array.isArray,kf=Object.prototype.hasOwnProperty;function Ea(o,n){if(typeof o!="object"||o===null)throw new Error("You must pass an object as the second argument to `generate`.");if(!kf.call(o,n))throw new Error("You must provide param `"+n+"` to `generate`.");var i=o[n],s=typeof i=="string"?i:""+i;if(s.length===0)throw new Error("You must provide a param `"+n+"`.");return s}var di=[];di[0]=function(o,n){for(var i=n,s=o.value,a=0;a<s.length;a++){var u=s.charCodeAt(a);i=i.put(u,!1,!1)}return i};di[1]=function(o,n){return n.put(47,!0,!0)};di[2]=function(o,n){return n.put(-1,!1,!0)};di[4]=function(o,n){return n};var fi=[];fi[0]=function(o){return o.value.replace(Mf,"\\$1")};fi[1]=function(){return"([^/]+)"};fi[2]=function(){return"(.+)"};fi[4]=function(){return""};var pi=[];pi[0]=function(o){return o.value};pi[1]=function(o,n){var i=Ea(n,o.value);return at.ENCODE_AND_DECODE_PATH_SEGMENTS?ka(i):i};pi[2]=function(o,n){return Ea(n,o.value)};pi[4]=function(){return""};var Co=Object.freeze({}),qi=Object.freeze([]);function Ef(o,n,i){n.length>0&&n.charCodeAt(0)===47&&(n=n.substr(1));for(var s=n.split("/"),a=void 0,u=void 0,l=0;l<s.length;l++){var d=s[l],f=0,v=0;d===""?v=4:d.charCodeAt(0)===58?v=1:d.charCodeAt(0)===42?v=2:v=0,f=2<<v,f&12&&(d=d.slice(1),a=a||[],a.push(d),u=u||[],u.push((f&4)!==0)),f&14&&i[v]++,o.push({type:v,value:Ur(d)})}return{names:a||qi,shouldDecodes:u||qi}}function Lo(o,n,i){return o.char===n&&o.negate===i}var He=function(n,i,s,a,u){this.states=n,this.id=i,this.char=s,this.negate=a,this.nextStates=u?i:null,this.pattern="",this._regex=void 0,this.handlers=void 0,this.types=void 0};He.prototype.regex=function(){return this._regex||(this._regex=new RegExp(this.pattern)),this._regex};He.prototype.get=function(n,i){var s=this,a=this.nextStates;if(a!==null)if(en(a))for(var u=0;u<a.length;u++){var l=s.states[a[u]];if(Lo(l,n,i))return l}else{var d=this.states[a];if(Lo(d,n,i))return d}};He.prototype.put=function(n,i,s){var a;if(a=this.get(n,i))return a;var u=this.states;return a=new He(u,u.length,n,i,s),u[u.length]=a,this.nextStates==null?this.nextStates=a.id:en(this.nextStates)?this.nextStates.push(a.id):this.nextStates=[this.nextStates,a.id],a};He.prototype.match=function(n){var i=this,s=this.nextStates;if(!s)return[];var a=[];if(en(s))for(var u=0;u<s.length;u++){var l=i.states[s[u]];To(l,n)&&a.push(l)}else{var d=this.states[s];To(d,n)&&a.push(d)}return a};function To(o,n){return o.negate?o.char!==n&&o.char!==-1:o.char===n||o.char===-1}function If(o){return o.sort(function(n,i){var s=n.types||[0,0,0],a=s[0],u=s[1],l=s[2],d=i.types||[0,0,0],f=d[0],v=d[1],y=d[2];if(l!==y)return l-y;if(l){if(a!==f)return f-a;if(u!==v)return v-u}return u!==v?u-v:a!==f?f-a:0})}function Rf(o,n){for(var i=[],s=0,a=o.length;s<a;s++){var u=o[s];i=i.concat(u.match(n))}return i}var nn=function(n){this.length=0,this.queryParams=n||{}};nn.prototype.splice=Array.prototype.splice;nn.prototype.slice=Array.prototype.slice;nn.prototype.push=Array.prototype.push;function Of(o,n,i){var s=o.handlers,a=o.regex();if(!a||!s)throw new Error("state not initialized");var u=n.match(a),l=1,d=new nn(i);d.length=s.length;for(var f=0;f<s.length;f++){var v=s[f],y=v.names,_=v.shouldDecodes,x=Co,P=!1;if(y!==qi&&_!==qi)for(var A=0;A<y.length;A++){P=!0;var M=y[A],T=u&&u[l++];x===Co&&(x={}),at.ENCODE_AND_DECODE_PATH_SEGMENTS&&_[A]?x[M]=T&&decodeURIComponent(T):x[M]=T}d[f]={handler:v.handler,params:x,isDynamic:P}}return d}function Ao(o){o=o.replace(/\+/gm,"%20");var n;try{n=decodeURIComponent(o)}catch{n=""}return n}var at=function(){this.names=yr();var n=[],i=new He(n,0,-1,!0,!1);n[0]=i,this.states=n,this.rootState=i};at.prototype.add=function(n,i){for(var s=this.rootState,a="^",u=[0,0,0],l=new Array(n.length),d=[],f=!0,v=0,y=0;y<n.length;y++){for(var _=n[y],x=Ef(d,_.path,u),P=x.names,A=x.shouldDecodes;v<d.length;v++){var M=d[v];M.type!==4&&(f=!1,s=s.put(47,!1,!1),a+="/",s=di[M.type](M,s),a+=fi[M.type](M))}l[y]={handler:_.handler,names:P,shouldDecodes:A}}f&&(s=s.put(47,!1,!1),a+="/"),s.handlers=l,s.pattern=a+"$",s.types=u;var T;typeof i=="object"&&i!==null&&i.as&&(T=i.as),T&&(this.names[T]={segments:d,handlers:l})};at.prototype.handlersFor=function(n){var i=this.names[n];if(!i)throw new Error("There is no route named "+n);for(var s=new Array(i.handlers.length),a=0;a<i.handlers.length;a++){var u=i.handlers[a];s[a]=u}return s};at.prototype.hasRoute=function(n){return!!this.names[n]};at.prototype.generate=function(n,i){var s=this.names[n],a="";if(!s)throw new Error("There is no route named "+n);for(var u=s.segments,l=0;l<u.length;l++){var d=u[l];d.type!==4&&(a+="/",a+=pi[d.type](d,i))}return a.charAt(0)!=="/"&&(a="/"+a),i&&i.queryParams&&(a+=this.generateQueryString(i.queryParams)),a};at.prototype.generateQueryString=function(n){var i=[],s=Object.keys(n);s.sort();for(var a=0;a<s.length;a++){var u=s[a],l=n[u];if(l!=null){var d=encodeURIComponent(u);if(en(l))for(var f=0;f<l.length;f++){var v=u+"[]="+encodeURIComponent(l[f]);i.push(v)}else d+="="+encodeURIComponent(l),i.push(d)}}return i.length===0?"":"?"+i.join("&")};at.prototype.parseQueryString=function(n){for(var i=n.split("&"),s={},a=0;a<i.length;a++){var u=i[a].split("="),l=Ao(u[0]),d=l.length,f=!1,v=void 0;u.length===1?v="true":(d>2&&l.slice(d-2)==="[]"&&(f=!0,l=l.slice(0,d-2),s[l]||(s[l]=[])),v=u[1]?Ao(u[1]):""),f?s[l].push(v):s[l]=v}return s};at.prototype.recognize=function(n){var i,s=[this.rootState],a={},u=!1,l=n.indexOf("#");l!==-1&&(n=n.substr(0,l));var d=n.indexOf("?");if(d!==-1){var f=n.substr(d+1,n.length);n=n.substr(0,d),a=this.parseQueryString(f)}n.charAt(0)!=="/"&&(n="/"+n);var v=n;at.ENCODE_AND_DECODE_PATH_SEGMENTS?n=Ma(n):(n=decodeURI(n),v=decodeURI(v));var y=n.length;y>1&&n.charAt(y-1)==="/"&&(n=n.substr(0,y-1),v=v.substr(0,v.length-1),u=!0);for(var _=0;_<n.length&&(s=Rf(s,n.charCodeAt(_)),!!s.length);_++);for(var x=[],P=0;P<s.length;P++)s[P].handlers&&x.push(s[P]);s=If(x);var A=x[0];return A&&A.handlers&&(u&&A.pattern&&A.pattern.slice(-5)==="(.+)$"&&(v=v+"/"),i=Of(A,v,a)),i};at.VERSION="0.3.4";at.ENCODE_AND_DECODE_PATH_SEGMENTS=!0;at.Normalizer={normalizeSegment:Ur,normalizePath:Ma,encodePathSegment:ka};at.prototype.map=Lf;/**
 * Minimal Event interface implementation
 *
 * Original implementation by Sven Fuchs: https://gist.github.com/995028
 * Modifications and tests by Christian Johansen.
 *
 * @author Sven Fuchs (svenfuchs@artweb-design.de)
 * @author Christian Johansen (christian@cjohansen.no)
 * @license BSD
 *
 * Copyright (c) 2011 Sven Fuchs, Christian Johansen
 */var fe=function(n,i,s,a){this.type=n,this.bubbles=i,this.cancelable=s,this.target=a};fe.prototype={stopPropagation:function(){},preventDefault:function(){this.defaultPrevented=!0}};var zf={100:"Continue",101:"Switching Protocols",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",300:"Multiple Choice",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported"};function Ff(o){var n;if(typeof DOMParser<"u"){var i=new DOMParser;n=i.parseFromString(o,"text/xml")}else n=new ActiveXObject("Microsoft.XMLDOM"),n.async="false",n.loadXML(o);return n}var jf={"Accept-Charset":!0,"Accept-Encoding":!0,Connection:!0,"Content-Length":!0,Cookie:!0,Cookie2:!0,"Content-Transfer-Encoding":!0,Date:!0,Expect:!0,Host:!0,"Keep-Alive":!0,Referer:!0,TE:!0,Trailer:!0,"Transfer-Encoding":!0,Upgrade:!0,"User-Agent":!0,Via:!0};function Nf(o,n){n.addEventListener(o,function(i){var s=n["on"+o];s&&typeof s=="function"&&s.call(i.target,i)})}function Ui(){this._eventListeners={};for(var o=["loadstart","progress","load","abort","loadend"],n=o.length-1;n>=0;n--)Nf(o[n],this)}Ui.prototype={addEventListener:function(n,i){this._eventListeners[n]=this._eventListeners[n]||[],this._eventListeners[n].push(i)},removeEventListener:function(n,i){for(var s=this._eventListeners[n]||[],a=0,u=s.length;a<u;++a)if(s[a]==i)return s.splice(a,1)},dispatchEvent:function(n){for(var i=n.type,s=this._eventListeners[i]||[],a=0;a<s.length;a++)typeof s[a]=="function"?s[a].call(this,n):s[a].handleEvent(n);return!!n.defaultPrevented},_progress:function(n,i,s){var a=new fe("progress");a.target=this,a.lengthComputable=n,a.loaded=i,a.total=s,this.dispatchEvent(a)}};function G(){Ui.call(this),this.readyState=G.UNSENT,this.requestHeaders={},this.requestBody=null,this.status=0,this.statusText="",this.upload=new Ui,this.onabort=null,this.onerror=null,this.onload=null,this.onloadend=null,this.onloadstart=null,this.onprogress=null,this.onreadystatechange=null,this.ontimeout=null}G.prototype=new Ui;G.UNSENT=0;G.OPENED=1;G.HEADERS_RECEIVED=2;G.LOADING=3;G.DONE=4;var Mo={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4,async:!0,withCredentials:!1,open:function(n,i,s,a,u){this.method=n,this.url=i,this.async=typeof s=="boolean"?s:!0,this.username=a,this.password=u,this.responseText=null,this.response=this.responseText,this.responseXML=null,this.responseURL=i,this.requestHeaders={},this.sendFlag=!1,this._readyStateChange(G.OPENED)},setRequestHeader:function(n,i){if(Eo(this),jf[n]||/^(Sec-|Proxy-)/.test(n))throw new Error('Refused to set unsafe header "'+n+'"');this.requestHeaders[n]?this.requestHeaders[n]+=","+i:this.requestHeaders[n]=i},send:function(n){if(Eo(this),!/^(get|head)$/i.test(this.method)){var i=!1;Object.keys(this.requestHeaders).forEach(function(s){s.toLowerCase()==="content-type"&&(i=!0)}),!i&&!(n||"").toString().match("FormData")&&(this.requestHeaders["Content-Type"]="text/plain;charset=UTF-8"),this.requestBody=n}this.errorFlag=!1,this.sendFlag=this.async,this._readyStateChange(G.OPENED),typeof this.onSend=="function"&&this.onSend(this),this.dispatchEvent(new fe("loadstart",!1,!1,this))},abort:function(){this.aborted=!0,this.responseText=null,this.response=this.responseText,this.errorFlag=!0,this.requestHeaders={},this.dispatchEvent(new fe("abort",!1,!1,this)),this.readyState>G.UNSENT&&this.sendFlag&&(this._readyStateChange(G.UNSENT),this.sendFlag=!1),typeof this.onerror=="function"&&this.onerror()},getResponseHeader:function(n){if(this.readyState<G.HEADERS_RECEIVED||/^Set-Cookie2?$/i.test(n))return null;n=n.toLowerCase();for(var i in this.responseHeaders)if(i.toLowerCase()==n)return this.responseHeaders[i];return null},getAllResponseHeaders:function(){if(this.readyState<G.HEADERS_RECEIVED)return"";var n="";for(var i in this.responseHeaders)this.responseHeaders.hasOwnProperty(i)&&!/^Set-Cookie2?$/i.test(i)&&(n+=i+": "+this.responseHeaders[i]+`\r
`);return n},overrideMimeType:function(n){typeof n=="string"&&(this.forceMimeType=n.toLowerCase())},_readyStateChange:function(n){this.readyState=n,typeof this.onreadystatechange=="function"&&this.onreadystatechange(new fe("readystatechange")),this.dispatchEvent(new fe("readystatechange")),this.readyState==G.DONE&&this.dispatchEvent(new fe("load",!1,!1,this)),(this.readyState==G.UNSENT||this.readyState==G.DONE)&&this.dispatchEvent(new fe("loadend",!1,!1,this))},_setResponseHeaders:function(n){this.responseHeaders={};for(var i in n)n.hasOwnProperty(i)&&(this.responseHeaders[i]=n[i]);this.forceMimeType&&(this.responseHeaders["Content-Type"]=this.forceMimeType),this.async?this._readyStateChange(G.HEADERS_RECEIVED):this.readyState=G.HEADERS_RECEIVED},_setResponseBody:function(n){Df(this),Bf(this),Zf(n);var i=this.chunkSize||10,s=0;this.responseText="",this.response=this.responseText;do this.async&&this._readyStateChange(G.LOADING),this.responseText+=n.substring(s,s+i),this.response=this.responseText,s+=i;while(s<n.length);var a=this.getResponseHeader("Content-Type");if(this.responseText&&(!a||/(text\/xml)|(application\/xml)|(\+xml)/.test(a)))try{this.responseXML=Ff(this.responseText)}catch{}this.async?this._readyStateChange(G.DONE):this.readyState=G.DONE},respond:function(n,i,s){this._setResponseHeaders(i||{}),this.status=typeof n=="number"?n:200,this.statusText=zf[this.status],this._setResponseBody(s||"")}};for(var ko in Mo)G.prototype[ko]=Mo[ko];function Eo(o){if(o.readyState!==G.OPENED)throw new Error("INVALID_STATE_ERR");if(o.sendFlag)throw new Error("INVALID_STATE_ERR")}function Df(o){if(o.readyState==G.DONE)throw new Error("Request done")}function Bf(o){if(o.async&&o.readyState!=G.HEADERS_RECEIVED)throw new Error("No headers received")}function Zf(o){if(typeof o!="string"){var n=new Error("Attempted to respond to fake XMLHttpRequest with "+o+", which is not a string.");throw n.name="InvalidBodyException",n}}var Io=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ia=function(n,i){if(i=i.split(":")[0],n=+n,!n)return!1;switch(i){case"http":case"ws":return n!==80;case"https":case"wss":return n!==443;case"ftp":return n!==21;case"gopher":return n!==70;case"file":return!1}return n!==0},Hf=Object.prototype.hasOwnProperty,$f;function Ro(o){try{return decodeURIComponent(o.replace(/\+/g," "))}catch{return null}}function qf(o){for(var n=/([^=?&]+)=?([^&]*)/g,i={},s;s=n.exec(o);){var a=Ro(s[1]),u=Ro(s[2]);a===null||u===null||a in i||(i[a]=u)}return i}function Uf(o,n){n=n||"";var i=[],s,a;typeof n!="string"&&(n="?");for(a in o)if(Hf.call(o,a)){if(s=o[a],!s&&(s===null||s===$f||isNaN(s))&&(s=""),a=encodeURIComponent(a),s=encodeURIComponent(s),a===null||s===null)continue;i.push(a+"="+s)}return i.length?n+i.join("&"):""}var Wf=Uf,Kf=qf,rn={stringify:Wf,parse:Kf},Gf=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,Yf=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,Vf=/^[a-zA-Z]:/,Jf="[\\x09\\x0A\\x0B\\x0C\\x0D\\x20\\xA0\\u1680\\u180E\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u202F\\u205F\\u3000\\u2028\\u2029\\uFEFF]",Xf=new RegExp("^"+Jf+"+");function Wr(o){return(o||"").toString().replace(Xf,"")}var xr=[["#","hash"],["?","query"],function(n,i){return ae(i.protocol)?n.replace(/\\/g,"/"):n},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d+)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],Oo={hash:1,query:1};function Ra(o){var n;typeof window<"u"?n=window:typeof Io<"u"?n=Io:typeof self<"u"?n=self:n={};var i=n.location||{};o=o||i;var s={},a=typeof o,u;if(o.protocol==="blob:")s=new te(unescape(o.pathname),{});else if(a==="string"){s=new te(o,{});for(u in Oo)delete s[u]}else if(a==="object"){for(u in o)u in Oo||(s[u]=o[u]);s.slashes===void 0&&(s.slashes=Gf.test(o.href))}return s}function ae(o){return o==="file:"||o==="ftp:"||o==="http:"||o==="https:"||o==="ws:"||o==="wss:"}function Oa(o,n){o=Wr(o),n=n||{};var i=Yf.exec(o),s=i[1]?i[1].toLowerCase():"",a=!!i[2],u=!!i[3],l=0,d;return a?u?(d=i[2]+i[3]+i[4],l=i[2].length+i[3].length):(d=i[2]+i[4],l=i[2].length):u?(d=i[3]+i[4],l=i[3].length):d=i[4],s==="file:"?l>=2&&(d=d.slice(2)):ae(s)?d=i[4]:s?a&&(d=d.slice(2)):l>=2&&ae(n.protocol)&&(d=i[4]),{protocol:s,slashes:a||ae(s),slashesCount:l,rest:d}}function Qf(o,n){if(o==="")return n;for(var i=(n||"/").split("/").slice(0,-1).concat(o.split("/")),s=i.length,a=i[s-1],u=!1,l=0;s--;)i[s]==="."?i.splice(s,1):i[s]===".."?(i.splice(s,1),l++):l&&(s===0&&(u=!0),i.splice(s,1),l--);return u&&i.unshift(""),(a==="."||a==="..")&&i.push(""),i.join("/")}function te(o,n,i){if(o=Wr(o),!(this instanceof te))return new te(o,n,i);var s,a,u,l,d,f,v=xr.slice(),y=typeof n,_=this,x=0;for(y!=="object"&&y!=="string"&&(i=n,n=null),i&&typeof i!="function"&&(i=rn.parse),n=Ra(n),a=Oa(o||"",n),s=!a.protocol&&!a.slashes,_.slashes=a.slashes||s&&n.slashes,_.protocol=a.protocol||n.protocol||"",o=a.rest,(a.protocol==="file:"&&(a.slashesCount!==2||Vf.test(o))||!a.slashes&&(a.protocol||a.slashesCount<2||!ae(_.protocol)))&&(v[3]=[/(.*)/,"pathname"]);x<v.length;x++){if(l=v[x],typeof l=="function"){o=l(o,_);continue}u=l[0],f=l[1],u!==u?_[f]=o:typeof u=="string"?~(d=o.indexOf(u))&&(typeof l[2]=="number"?(_[f]=o.slice(0,d),o=o.slice(d+l[2])):(_[f]=o.slice(d),o=o.slice(0,d))):(d=u.exec(o))&&(_[f]=d[1],o=o.slice(0,d.index)),_[f]=_[f]||s&&l[3]&&n[f]||"",l[4]&&(_[f]=_[f].toLowerCase())}i&&(_.query=i(_.query)),s&&n.slashes&&_.pathname.charAt(0)!=="/"&&(_.pathname!==""||n.pathname!=="")&&(_.pathname=Qf(_.pathname,n.pathname)),_.pathname.charAt(0)!=="/"&&ae(_.protocol)&&(_.pathname="/"+_.pathname),Ia(_.port,_.protocol)||(_.host=_.hostname,_.port=""),_.username=_.password="",_.auth&&(l=_.auth.split(":"),_.username=l[0]||"",_.password=l[1]||""),_.origin=_.protocol!=="file:"&&ae(_.protocol)&&_.host?_.protocol+"//"+_.host:"null",_.href=_.toString()}function tp(o,n,i){var s=this;switch(o){case"query":typeof n=="string"&&n.length&&(n=(i||rn.parse)(n)),s[o]=n;break;case"port":s[o]=n,Ia(n,s.protocol)?n&&(s.host=s.hostname+":"+n):(s.host=s.hostname,s[o]="");break;case"hostname":s[o]=n,s.port&&(n+=":"+s.port),s.host=n;break;case"host":s[o]=n,/:\d+$/.test(n)?(n=n.split(":"),s.port=n.pop(),s.hostname=n.join(":")):(s.hostname=n,s.port="");break;case"protocol":s.protocol=n.toLowerCase(),s.slashes=!i;break;case"pathname":case"hash":if(n){var a=o==="pathname"?"/":"#";s[o]=n.charAt(0)!==a?a+n:n}else s[o]=n;break;default:s[o]=n}for(var u=0;u<xr.length;u++){var l=xr[u];l[4]&&(s[l[1]]=s[l[1]].toLowerCase())}return s.origin=s.protocol!=="file:"&&ae(s.protocol)&&s.host?s.protocol+"//"+s.host:"null",s.href=s.toString(),s}function ep(o){(!o||typeof o!="function")&&(o=rn.stringify);var n,i=this,s=i.protocol;s&&s.charAt(s.length-1)!==":"&&(s+=":");var a=s+(i.slashes||ae(i.protocol)?"//":"");return i.username&&(a+=i.username,i.password&&(a+=":"+i.password),a+="@"),a+=i.host+i.pathname,n=typeof i.query=="object"?o(i.query):i.query,n&&(a+=n.charAt(0)!=="?"?"?"+n:n),i.hash&&(a+=i.hash),a}te.prototype={set:tp,toString:ep};te.extractProtocol=Oa;te.location=Ra;te.trimLeft=Wr;te.qs=rn;var ip=te;function Be(o){var n=new ip(o);n.host||(n.href=n.href);var i=n.pathname;i.charAt(0)!=="/"&&(i="/"+i);var s=n.host;return(n.port==="80"||n.port==="443")&&(s=n.hostname),{host:s,protocol:n.protocol,search:n.query,hash:n.hash,href:n.href,pathname:i,fullpath:i+(n.query||"")+(n.hash||"")}}var Kr=function(){function o(){this.verbs={GET:new at,PUT:new at,POST:new at,DELETE:new at,PATCH:new at,HEAD:new at,OPTIONS:new at}}return o}(),wr=function(){function o(){this.registries={}}return o.prototype.forURL=function(n){var i=Be(n).host,s=this.registries[i];return s===void 0&&(s=this.registries[i]=new Kr),s.verbs},o}(),gt=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof gt<"u"&&gt,Tt={searchParams:"URLSearchParams"in gt,iterable:"Symbol"in gt&&"iterator"in Symbol,blob:"FileReader"in gt&&"Blob"in gt&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in gt,arrayBuffer:"ArrayBuffer"in gt};function np(o){return o&&DataView.prototype.isPrototypeOf(o)}if(Tt.arrayBuffer)var rp=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],sp=ArrayBuffer.isView||function(o){return o&&rp.indexOf(Object.prototype.toString.call(o))>-1};function mi(o){if(typeof o!="string"&&(o=String(o)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(o)||o==="")throw new TypeError('Invalid character in header field name: "'+o+'"');return o.toLowerCase()}function Gr(o){return typeof o!="string"&&(o=String(o)),o}function Yr(o){var n={next:function(){var i=o.shift();return{done:i===void 0,value:i}}};return Tt.iterable&&(n[Symbol.iterator]=function(){return n}),n}function dt(o){this.map={},o instanceof dt?o.forEach(function(n,i){this.append(i,n)},this):Array.isArray(o)?o.forEach(function(n){this.append(n[0],n[1])},this):o&&Object.getOwnPropertyNames(o).forEach(function(n){this.append(n,o[n])},this)}dt.prototype.append=function(o,n){o=mi(o),n=Gr(n);var i=this.map[o];this.map[o]=i?i+", "+n:n};dt.prototype.delete=function(o){delete this.map[mi(o)]};dt.prototype.get=function(o){return o=mi(o),this.has(o)?this.map[o]:null};dt.prototype.has=function(o){return this.map.hasOwnProperty(mi(o))};dt.prototype.set=function(o,n){this.map[mi(o)]=Gr(n)};dt.prototype.forEach=function(o,n){for(var i in this.map)this.map.hasOwnProperty(i)&&o.call(n,this.map[i],i,this)};dt.prototype.keys=function(){var o=[];return this.forEach(function(n,i){o.push(i)}),Yr(o)};dt.prototype.values=function(){var o=[];return this.forEach(function(n){o.push(n)}),Yr(o)};dt.prototype.entries=function(){var o=[];return this.forEach(function(n,i){o.push([i,n])}),Yr(o)};Tt.iterable&&(dt.prototype[Symbol.iterator]=dt.prototype.entries);function Qn(o){if(o.bodyUsed)return Promise.reject(new TypeError("Already read"));o.bodyUsed=!0}function za(o){return new Promise(function(n,i){o.onload=function(){n(o.result)},o.onerror=function(){i(o.error)}})}function op(o){var n=new FileReader,i=za(n);return n.readAsArrayBuffer(o),i}function ap(o){var n=new FileReader,i=za(n);return n.readAsText(o),i}function hp(o){for(var n=new Uint8Array(o),i=new Array(n.length),s=0;s<n.length;s++)i[s]=String.fromCharCode(n[s]);return i.join("")}function zo(o){if(o.slice)return o.slice(0);var n=new Uint8Array(o.byteLength);return n.set(new Uint8Array(o)),n.buffer}function Fa(){return this.bodyUsed=!1,this._initBody=function(o){this.bodyUsed=this.bodyUsed,this._bodyInit=o,o?typeof o=="string"?this._bodyText=o:Tt.blob&&Blob.prototype.isPrototypeOf(o)?this._bodyBlob=o:Tt.formData&&FormData.prototype.isPrototypeOf(o)?this._bodyFormData=o:Tt.searchParams&&URLSearchParams.prototype.isPrototypeOf(o)?this._bodyText=o.toString():Tt.arrayBuffer&&Tt.blob&&np(o)?(this._bodyArrayBuffer=zo(o.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):Tt.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(o)||sp(o))?this._bodyArrayBuffer=zo(o):this._bodyText=o=Object.prototype.toString.call(o):this._bodyText="",this.headers.get("content-type")||(typeof o=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):Tt.searchParams&&URLSearchParams.prototype.isPrototypeOf(o)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},Tt.blob&&(this.blob=function(){var o=Qn(this);if(o)return o;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var o=Qn(this);return o||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else return this.blob().then(op)}),this.text=function(){var o=Qn(this);if(o)return o;if(this._bodyBlob)return ap(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(hp(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},Tt.formData&&(this.formData=function(){return this.text().then(cp)}),this.json=function(){return this.text().then(JSON.parse)},this}var up=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function lp(o){var n=o.toUpperCase();return up.indexOf(n)>-1?n:o}function _e(o,n){if(!(this instanceof _e))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');n=n||{};var i=n.body;if(o instanceof _e){if(o.bodyUsed)throw new TypeError("Already read");this.url=o.url,this.credentials=o.credentials,n.headers||(this.headers=new dt(o.headers)),this.method=o.method,this.mode=o.mode,this.signal=o.signal,!i&&o._bodyInit!=null&&(i=o._bodyInit,o.bodyUsed=!0)}else this.url=String(o);if(this.credentials=n.credentials||this.credentials||"same-origin",(n.headers||!this.headers)&&(this.headers=new dt(n.headers)),this.method=lp(n.method||this.method||"GET"),this.mode=n.mode||this.mode||null,this.signal=n.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&i)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(i),(this.method==="GET"||this.method==="HEAD")&&(n.cache==="no-store"||n.cache==="no-cache")){var s=/([?&])_=[^&]*/;if(s.test(this.url))this.url=this.url.replace(s,"$1_="+new Date().getTime());else{var a=/\?/;this.url+=(a.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}_e.prototype.clone=function(){return new _e(this,{body:this._bodyInit})};function cp(o){var n=new FormData;return o.trim().split("&").forEach(function(i){if(i){var s=i.split("="),a=s.shift().replace(/\+/g," "),u=s.join("=").replace(/\+/g," ");n.append(decodeURIComponent(a),decodeURIComponent(u))}}),n}function dp(o){var n=new dt,i=o.replace(/\r?\n[\t ]+/g," ");return i.split("\r").map(function(s){return s.indexOf(`
`)===0?s.substr(1,s.length):s}).forEach(function(s){var a=s.split(":"),u=a.shift().trim();if(u){var l=a.join(":").trim();n.append(u,l)}}),n}Fa.call(_e.prototype);function Ht(o,n){if(!(this instanceof Ht))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');n||(n={}),this.type="default",this.status=n.status===void 0?200:n.status,this.ok=this.status>=200&&this.status<300,this.statusText=n.statusText===void 0?"":""+n.statusText,this.headers=new dt(n.headers),this.url=n.url||"",this._initBody(o)}Fa.call(Ht.prototype);Ht.prototype.clone=function(){return new Ht(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new dt(this.headers),url:this.url})};Ht.error=function(){var o=new Ht(null,{status:0,statusText:""});return o.type="error",o};var fp=[301,302,303,307,308];Ht.redirect=function(o,n){if(fp.indexOf(n)===-1)throw new RangeError("Invalid status code");return new Ht(null,{status:n,headers:{location:o}})};var pe=gt.DOMException;try{new pe}catch{pe=function(n,i){this.message=n,this.name=i;var s=Error(n);this.stack=s.stack},pe.prototype=Object.create(Error.prototype),pe.prototype.constructor=pe}function Vr(o,n){return new Promise(function(i,s){var a=new _e(o,n);if(a.signal&&a.signal.aborted)return s(new pe("Aborted","AbortError"));var u=new XMLHttpRequest;function l(){u.abort()}u.onload=function(){var f={status:u.status,statusText:u.statusText,headers:dp(u.getAllResponseHeaders()||"")};f.url="responseURL"in u?u.responseURL:f.headers.get("X-Request-URL");var v="response"in u?u.response:u.responseText;setTimeout(function(){i(new Ht(v,f))},0)},u.onerror=function(){setTimeout(function(){s(new TypeError("Network request failed"))},0)},u.ontimeout=function(){setTimeout(function(){s(new TypeError("Network request failed"))},0)},u.onabort=function(){setTimeout(function(){s(new pe("Aborted","AbortError"))},0)};function d(f){try{return f===""&&gt.location.href?gt.location.href:f}catch{return f}}u.open(a.method,d(a.url),!0),a.credentials==="include"?u.withCredentials=!0:a.credentials==="omit"&&(u.withCredentials=!1),"responseType"in u&&(Tt.blob?u.responseType="blob":Tt.arrayBuffer&&a.headers.get("Content-Type")&&a.headers.get("Content-Type").indexOf("application/octet-stream")!==-1&&(u.responseType="arraybuffer")),n&&typeof n.headers=="object"&&!(n.headers instanceof dt)?Object.getOwnPropertyNames(n.headers).forEach(function(f){u.setRequestHeader(f,Gr(n.headers[f]))}):a.headers.forEach(function(f,v){u.setRequestHeader(v,f)}),a.signal&&(a.signal.addEventListener("abort",l),u.onreadystatechange=function(){u.readyState===4&&a.signal.removeEventListener("abort",l)}),u.send(typeof a._bodyInit>"u"?null:a._bodyInit)})}Vr.polyfill=!0;gt.fetch||(gt.fetch=Vr,gt.Headers=dt,gt.Request=_e,gt.Response=Ht);var Fo=Object.freeze({__proto__:null,Headers:dt,Request:_e,Response:Ht,get DOMException(){return pe},fetch:Vr});function pp(o,n){var i=["error","timeout","abort","readystatechange"],s=[],a=["readyState","responseText","response","responseXML","responseURL","status","statusText"],u=o._passthroughRequest=new n;u.open(o.method,o.url,o.async,o.username,o.password),o.responseType==="arraybuffer"&&(a=["readyState","response","status","statusText"],u.responseType=o.responseType),"onload"in u&&i.push("load"),o.async&&o.responseType!=="arraybuffer"&&(i.push("progress"),s.push("progress"));function l(x,P,A){for(var M=0;M<x.length;M++){var T=x[M];T in P&&(A[T]=P[T])}}function d(x,P,A){x.dispatchEvent(A),x["on"+P]&&x["on"+P](A)}function f(x){u["on"+x]=function(P){l(a,u,o),d(o,x,P)}}function v(x){u.upload&&o.upload&&o.upload["on"+x]&&(u.upload["on"+x]=function(P){d(o.upload,x,P)})}var y;for(y=0;y<i.length;y++)f(i[y]);for(y=0;y<s.length;y++)v(s[y]);o.async&&(u.timeout=o.timeout,u.withCredentials=o.withCredentials),!u.timeout&&u.timeout!==0&&(u.timeout=0);for(var _ in o.requestHeaders)u.setRequestHeader(_,o.requestHeaders[_]);return u}function mp(o){function n(){G.call(this)}return n.prototype=Object.create(G.prototype),n.prototype.constructor=n,n.prototype.send=function(){if(this.sendArguments=arguments,!o.pretender.running)throw new Error("You shut down a Pretender instance while there was a pending request. That request just tried to complete. Check to see if you accidentally shut down a pretender earlier than you intended to");G.prototype.send.apply(this,arguments),o.pretender.checkPassthrough(this)?this.passthrough():o.pretender.handleRequest(this)},n.prototype.passthrough=function(){if(!this.sendArguments)throw new Error("You attempted to passthrough a FakeRequest that was never sent. Call `.send()` on the original request first");var s=pp(this,o.pretender._nativeXMLHttpRequest);return s.send.apply(s,this.sendArguments),s},n.prototype._passthroughCheck=function(i,s){return this._passthroughRequest?this._passthroughRequest[i].apply(this._passthroughRequest,s):G.prototype[i].apply(this,s)},n.prototype.abort=function(){return this._passthroughCheck("abort",arguments)},n.prototype.getResponseHeader=function(){return this._passthroughCheck("getResponseHeader",arguments)},n.prototype.getAllResponseHeaders=function(){return this._passthroughCheck("getAllResponseHeaders",arguments)},o.pretender._nativeXMLHttpRequest.prototype._passthroughCheck&&console.warn("You created a second Pretender instance while there was already one running. Running two Pretender servers at once will lead to unexpected results and will be removed entirely in a future major version.Please call .shutdown() on your instances when you no longer need them to respond."),n}var tr=function(){function o(){this.length=0}return o.prototype.push=function(){return 0},o}();function ja(o,n,i){var s=0,a=o.requestBody;a&&(a instanceof FormData?a.forEach(function(u){u instanceof File?s+=u.size:s+=u.length}):s=a.byteLength||a.size||a.length||0),setTimeout(function(){if(!o.aborted&&!o.status){var u=new Date().getTime()-n.getTime(),l=i<=0?0:u/i*s;o.upload._progress(!0,l,s),o._progress(!0,l,s),ja(o,n,i)}else o.status&&(o.upload._progress(!0,s,s),o._progress(!0,s,s))},50)}function _p(o){return Object.prototype.toString.call(o)==="[object Array]"}var jo={};function Pe(o){return function(n,i,s){return this.register(o,n,i,s)}}var sn=function(){function o(){var n=this;this.hosts=new wr,this.handlers=[],this.get=Pe("GET"),this.post=Pe("POST"),this.put=Pe("PUT"),this.delete=Pe("DELETE"),this.patch=Pe("PATCH"),this.head=Pe("HEAD"),this.options=Pe("OPTIONS"),this.passthrough=jo;var i=arguments[arguments.length-1],s=typeof i=="object"?i:null,a=s&&s.trackRequests===!1;this.handledRequests=a?new tr:[],this.passthroughRequests=a?new tr:[],this.unhandledRequests=a?new tr:[],this.requestReferences=[],this.forcePassthrough=s&&s.forcePassthrough===!0,this.disableUnhandled=s&&s.disableUnhandled===!0,this._nativeXMLHttpRequest=self.XMLHttpRequest,this.running=!1;var u={pretender:this};this.ctx=u,self.XMLHttpRequest=mp(u),this._fetchProps=Fo?["fetch","Headers","Request","Response"]:[],this._fetchProps.forEach(function(f){n["_native"+f]=self[f],self[f]=Fo[f]},this),this.running=!0;for(var l=s?arguments.length-1:arguments.length,d=0;d<l;d++)this.map(arguments[d])}return o.prototype.map=function(n){n.call(this)},o.prototype.register=function(n,i,s,a){if(!s)throw new Error("The function you tried passing to Pretender to handle "+n+" "+i+" is undefined or missing.");var u=s;u.numberOfCalls=0,u.async=a,this.handlers.push(u);var l=this.hosts.forURL(i)[n];return l.add([{path:Be(i).fullpath,handler:u}]),u},o.prototype.checkPassthrough=function(n){var i=n.method.toUpperCase(),s=Be(n.url).fullpath,a=this.hosts.forURL(n.url)[i].recognize(s),u=a&&a[0];return u&&u.handler===jo||this.forcePassthrough?(this.passthroughRequests.push(n),this.passthroughRequest(i,s,n),!0):!1},o.prototype.handleRequest=function(n){var i=n.method.toUpperCase(),s=n.url,a=this._handlerFor(i,s,n);if(a){a.handler.numberOfCalls++;var u=a.handler.async;this.handledRequests.push(n);var l=this,d=function(v){if(!_p(v)){var y="Remember to `return [status, headers, body];` in your route handler.";throw new Error("Nothing returned by handler for "+s+". "+y)}var _=v[0],x=l.prepareHeaders(v[1]),P=l.prepareBody(v[2],x);l.handleResponse(n,u,function(){n.respond(_,x,P),l.handledRequest(i,s,n)})};try{var f=a.handler(n);f&&typeof f.then=="function"?f.then(function(v){d(v)}):d(f)}catch(v){this.erroredRequest(i,s,n,v),this.resolve(n)}}else this.disableUnhandled||(this.unhandledRequests.push(n),this.unhandledRequest(i,s,n))},o.prototype.handleResponse=function(n,i,s){var a=typeof i=="function"?i():i;if(a=typeof a=="boolean"||typeof a=="number"?a:0,a===!1)s();else{var u=this;u.requestReferences.push({request:n,callback:s}),a!==!0&&(ja(n,new Date,a),setTimeout(function(){u.resolve(n)},a))}},o.prototype.resolve=function(n){for(var i=0,s=this.requestReferences.length;i<s;i++){var a=this.requestReferences[i];if(a.request===n){a.callback(),this.requestReferences.splice(i,1);break}}},o.prototype.requiresManualResolution=function(n,i){var s=this._handlerFor(n.toUpperCase(),i,{});if(!s)return!1;var a=s.handler.async;return typeof a=="function"?a()===!0:a===!0},o.prototype.prepareBody=function(n,i){return n},o.prototype.prepareHeaders=function(n){return n},o.prototype.handledRequest=function(n,i,s){},o.prototype.passthroughRequest=function(n,i,s){},o.prototype.unhandledRequest=function(n,i,s){throw new Error("Pretender intercepted "+n+" "+i+" but no handler was defined for this type of request")},o.prototype.erroredRequest=function(n,i,s,a){throw a.message="Pretender intercepted "+n+" "+i+" but encountered an error: "+a.message,a},o.prototype.shutdown=function(){var n=this;self.XMLHttpRequest=this._nativeXMLHttpRequest,this._fetchProps.forEach(function(i){self[i]=n["_native"+i]},this),this.ctx.pretender=void 0,this.running=!1},o.prototype._handlerFor=function(n,i,s){var a=this.hosts.forURL(i)[n],u=a.recognize(Be(i).fullpath),l=u?u[0]:null;return l&&(s.params=l.params,s.queryParams=u.queryParams),l},o.parseURL=Be,o.Hosts=wr,o.Registry=Kr,o}();sn.parseURL=Be;sn.Hosts=wr;sn.Registry=Kr;typeof oe<"u"&&oe.__pretenderNodePolyfill&&(delete oe.self,delete oe.__pretenderNodePolyfill);function No(o,n){var i=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(o,a).enumerable})),i.push.apply(i,s)}return i}function vp(o){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?No(Object(i),!0).forEach(function(s){ct(o,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(i)):No(Object(i)).forEach(function(s){Object.defineProperty(o,s,Object.getOwnPropertyDescriptor(i,s))})}return o}function ft(o){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ft=function(n){return typeof n}:ft=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},ft(o)}function V(o,n){if(!(o instanceof n))throw new TypeError("Cannot call a class as a function")}function gp(o,n){for(var i=0;i<n.length;i++){var s=n[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(o,s.key,s)}}function et(o,n,i){return n&&gp(o.prototype,n),o}function ct(o,n,i){return n in o?Object.defineProperty(o,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):o[n]=i,o}function Ut(o,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),n&&Ki(o,n)}function Wi(o){return Wi=Object.setPrototypeOf?Object.getPrototypeOf:function(i){return i.__proto__||Object.getPrototypeOf(i)},Wi(o)}function Ki(o,n){return Ki=Object.setPrototypeOf||function(s,a){return s.__proto__=a,s},Ki(o,n)}function Na(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Bt(o,n,i){return Na()?Bt=Reflect.construct:Bt=function(a,u,l){var d=[null];d.push.apply(d,u);var f=Function.bind.apply(a,d),v=new f;return l&&Ki(v,l.prototype),v},Bt.apply(null,arguments)}function Da(o){if(o===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}function yp(o,n){if(n&&(typeof n=="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Da(o)}function Wt(o){var n=Na();return function(){var s=Wi(o),a;if(n){var u=Wi(this).constructor;a=Reflect.construct(s,arguments,u)}else a=s.apply(this,arguments);return yp(this,a)}}function Mt(o,n){return Ba(o)||bp(o,n)||Jr(o,n)||Ha()}function xp(o){return Ba(o)||Za(o)||Jr(o)||Ha()}function Ze(o){return wp(o)||Za(o)||Jr(o)||Pp()}function wp(o){if(Array.isArray(o))return br(o)}function Ba(o){if(Array.isArray(o))return o}function Za(o){if(typeof Symbol<"u"&&o[Symbol.iterator]!=null||o["@@iterator"]!=null)return Array.from(o)}function bp(o,n){var i=o==null?null:typeof Symbol<"u"&&o[Symbol.iterator]||o["@@iterator"];if(i!=null){var s=[],a=!0,u=!1,l,d;try{for(i=i.call(o);!(a=(l=i.next()).done)&&(s.push(l.value),!(n&&s.length===n));a=!0);}catch(f){u=!0,d=f}finally{try{!a&&i.return!=null&&i.return()}finally{if(u)throw d}}return s}}function Jr(o,n){if(o){if(typeof o=="string")return br(o,n);var i=Object.prototype.toString.call(o).slice(8,-1);if(i==="Object"&&o.constructor&&(i=o.constructor.name),i==="Map"||i==="Set")return Array.from(o);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return br(o,n)}}function br(o,n){(n==null||n>o.length)&&(n=o.length);for(var i=0,s=new Array(n);i<n;i++)s[i]=o[i];return s}function Pp(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ha(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Sp(o){return(+o).toString()===o.toString()}var Cp=function(){function o(){V(this,o),this._nextId=1,this._ids={}}return et(o,[{key:"get",value:function(){return this._nextId}},{key:"set",value:function(i){if(this._ids[i])throw new Error("Attempting to use the ID ".concat(i,", but it's already been used"));Sp(i)&&+i>=this._nextId&&(this._nextId=+i+1),this._ids[i]=!0}},{key:"inc",value:function(){var i=this.get()+1;return this._nextId=i,i}},{key:"fetch",value:function(){var i=this.get();return this._ids[i]=!0,this.inc(),i.toString()}},{key:"reset",value:function(){this._nextId=1,this._ids={}}}]),o}(),Lp=console.warn,kt=function(){function o(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0;V(this,o),this.code=n,this.headers=i,n===204?s!==void 0&&s!==""?Lp(`Mirage: One of your route handlers is returning a custom
          204 Response that has data, but this is a violation of the HTTP spec
          and could lead to unexpected behavior. 204 responses should have no
          content (an empty string) as their body.`):this.data="":(s===void 0||s==="")&&!Object.prototype.hasOwnProperty.call(this.headers,"Content-Type")?this.data={}:this.data=s,n!==204&&!Object.prototype.hasOwnProperty.call(this.headers,"Content-Type")&&(this.headers["Content-Type"]="application/json")}return et(o,[{key:"toRackResponse",value:function(){return[this.code,this.headers,this.data]}}]),o}(),er={},ir={},nr={},rr={};function z(o){if(typeof er[o]!="string"){var n=Cc(Jt(o)),i=n.split("/").map(Ic).join("/");er[o]=i}return er[o]}function tt(o){if(typeof ir[o]!="string"){var n=Tc(Jt(o));ir[o]=n}return ir[o]}function Jt(o){if(typeof nr[o]!="string"){var n=Lc(o);nr[o]=n}return nr[o]}function Gi(o){if(typeof rr[o]!="string"){var n=La(o);rr[o]=n}return rr[o]}function Tp(o){return cr(o)&&o.__isAssociation__===!0}var Do=["description","fileName","lineNumber","message","name","number","stack"];function O(o,n){if(typeof o=="string"&&!n)throw new Yi(o);if(!o)throw new Yi(n.replace(/^ +/gm,"")||"Assertion failed")}function Yi(o,n){var i=Error(o);n&&(i.stack=n);for(var s=0;s<Do.length;s++){var a=Do[s];["description","message","stack"].indexOf(a)>-1?this[a]="Mirage: ".concat(i[a]):this[a]=i[a]}}Yi.prototype=Object.create(Error.prototype);var _i=function(){function o(n,i){V(this,o),this.modelName=void 0,ft(n)==="object"?(this.modelName=void 0,this.opts=n):(this.modelName=n?tt(n):"",this.opts=i||{}),this.name="",this.ownerModelName=""}return et(o,[{key:"setSchema",value:function(i){this.schema=i}},{key:"isReflexive",value:function(){var i=!!(this.modelName===this.ownerModelName&&this.opts.inverse),s=this.opts.inverse===void 0&&this.ownerModelName===this.modelName;return i||s}},{key:"isPolymorphic",get:function(){return this.opts.polymorphic}},{key:"type",get:function(){throw new Error("Subclasses of Association must implement a getter for type")}},{key:"foreignKey",get:function(){return this.getForeignKey()}},{key:"identifier",get:function(){throw new Error("Subclasses of Association must implement a getter for identifier")}}]),o}(),Ne={},li=function(o){Ut(i,o);var n=Wt(i);function i(){return V(this,i),n.apply(this,arguments)}return et(i,[{key:"identifier",get:function(){if(typeof Ne[this.name]!="string"){var a="".concat(z(this.name),"Id");Ne[this.name]=a}return Ne[this.name]}},{key:"type",get:function(){return"belongsTo"}},{key:"getForeignKeyArray",value:function(){return[z(this.ownerModelName),this.getForeignKey()]}},{key:"getForeignKey",value:function(){if(typeof Ne[this.name]!="string"){var a="".concat(z(this.name),"Id");Ne[this.name]=a}return Ne[this.name]}},{key:"addMethodsToModelClass",value:function(a,u){var l=a.prototype,d=this,f=this.getForeignKey(),v=ct({},u,this);l.belongsToAssociations=Object.assign(l.belongsToAssociations,v),Object.keys(l.belongsToAssociations).forEach(function(y){var _=l.belongsToAssociations[y];l.belongsToAssociationFks[_.getForeignKey()]=_}),this.schema.addDependentAssociation(this,this.modelName),l.associationKeys.add(u),l.associationIdKeys.add(f),Object.defineProperty(l,f,{get:function(){this._tempAssociations=this._tempAssociations||{};var _=this._tempAssociations[u],x;return _===null?x=null:d.isPolymorphic?_?x={id:_.id,type:_.modelName}:x=this.attrs[f]:_?x=_.id:x=this.attrs[f],x},set:function(_){var x;_===null?x=null:_!==void 0&&(d.isPolymorphic?(O(ft(_)==="object","You're setting an ID on the polymorphic association '".concat(d.name,"' but you didn't pass in an object. Polymorphic IDs need to be in the form { type, id }.")),x=d.schema[d.schema.toCollectionName(_.type)].find(_.id)):(x=d.schema[d.schema.toCollectionName(d.modelName)].find(_),O(x,"Couldn't find ".concat(d.modelName," with id = ").concat(_)))),this[u]=x}}),Object.defineProperty(l,u,{get:function(){this._tempAssociations=this._tempAssociations||{};var _=this._tempAssociations[u],x=this[f],P=null;return _?P=_:x!==null&&(d.isPolymorphic?P=d.schema[d.schema.toCollectionName(x.type)].find(x.id):P=d.schema[d.schema.toCollectionName(d.modelName)].find(x)),P},set:function(_){if(this._tempAssociations=this._tempAssociations||{},this._tempAssociations[u]=_,_&&_.hasInverseFor(d)){var x=_.inverseFor(d);_.associate(this,x)}}}),l["new".concat(Gi(u))]=function(){var y,_;d.isPolymorphic?(y=arguments.length<=0?void 0:arguments[0],_=arguments.length<=1?void 0:arguments[1]):(y=d.modelName,_=arguments.length<=0?void 0:arguments[0]);var x=d.schema[d.schema.toCollectionName(y)].new(_);return this[u]=x,x},l["create".concat(Gi(u))]=function(){var y,_;d.isPolymorphic?(y=arguments.length<=0?void 0:arguments[0],_=arguments.length<=1?void 0:arguments[1]):(y=d.modelName,_=arguments.length<=0?void 0:arguments[0]);var x=d.schema[d.schema.toCollectionName(y)].create(_);return this[u]=x,this.save(),x.reload()}}},{key:"disassociateAllDependentsFromTarget",value:function(a){var u=this,l=this.ownerModelName,d;this.isPolymorphic?d={type:a.modelName,id:a.id}:d=a.id;var f=this.schema[this.schema.toCollectionName(l)].where(function(v){var y=v[u.getForeignKey()];return y?ft(y)==="object"?y.type===d.type&&y.id===d.id:y===d:!1});f.models.forEach(function(v){v.disassociate(a,u),v.save()})}}]),i}(_i);function de(o){return Array.isArray(o)?o.map(de):Object.assign({},o)}var Ap=function(){function o(n,i,s){V(this,o),this.name=n,this._records=[],this.identityManager=new s,i&&this.insert(i)}return et(o,[{key:"all",value:function(){return de(this._records)}},{key:"insert",value:function(i){var s=this;return Array.isArray(i)?vl(i,function(a){return s._insertRecord(a)}):this._insertRecord(i)}},{key:"find",value:function(i){if(Array.isArray(i)){var s=this._findRecords(i).filter(Boolean).map(de);return s}else{var a=this._findRecord(i);return a?de(a):null}}},{key:"findBy",value:function(i){var s=this._findRecordBy(i);return s?de(s):null}},{key:"where",value:function(i){return this._findRecordsWhere(i).map(de)}},{key:"firstOrCreate",value:function(i){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=this.where(i),u=Mt(a,1),l=u[0];if(l)return l;var d=Object.assign(s,i),f=this.insert(d);return f}},{key:"update",value:function(i,s){var a=this,u;if(typeof s>"u"){s=i;var l=[];return this._records.forEach(function(_){var x=Object.assign({},_);a._updateRecord(_,s),dr(x,_)||l.push(_)}),l}else if(typeof i=="number"||typeof i=="string"){var d=i,f=this._findRecord(d);return this._updateRecord(f,s),f}else if(Array.isArray(i)){var v=i;return u=this._findRecords(v),u.forEach(function(_){a._updateRecord(_,s)}),u}else if(ft(i)==="object"){var y=i;return u=this._findRecordsWhere(y),u.forEach(function(_){a._updateRecord(_,s)}),u}}},{key:"remove",value:function(i){var s=this,a;if(typeof i>"u")this._records=[],this.identityManager.reset();else if(typeof i=="number"||typeof i=="string"){var u=this._findRecord(i),l=this._records.indexOf(u);this._records.splice(l,1)}else Array.isArray(i)?(a=this._findRecords(i),a.forEach(function(d){var f=s._records.indexOf(d);s._records.splice(f,1)})):ft(i)==="object"&&(a=this._findRecordsWhere(i),a.forEach(function(d){var f=s._records.indexOf(d);s._records.splice(f,1)}))}},{key:"_findRecord",value:function(i){return i=i.toString(),this._records.find(function(s){return s.id===i})}},{key:"_findRecordBy",value:function(i){return this._findRecordsWhere(i)[0]}},{key:"_findRecords",value:function(i){return i.map(this._findRecord,this)}},{key:"_findRecordsWhere",value:function(i){var s=this._records;function a(l){var d=Object.keys(i);return d.every(function(f){return String(l[f])===String(i[f])})}var u=ft(i)==="object"?a:i;return s.filter(u)}},{key:"_insertRecord",value:function(i){var s=de(i);return s&&(s.id===void 0||s.id===null)?s.id=this.identityManager.fetch(s):(s.id=s.id.toString(),this.identityManager.set(s.id)),this._records.push(s),de(s)}},{key:"_updateRecord",value:function(i,s){var a=s&&Object.prototype.hasOwnProperty.call(s,"id")?s.id.toString():null,u=i.id;if(a&&u!==a)throw new Error("Updating the ID of a record is not permitted");for(var l in s)l!=="id"&&(i[l]=s[l])}}]),o}(),$a=function(){function o(n,i){V(this,o),this._collections=[],this.registerIdentityManagers(i),n&&this.loadData(n)}return et(o,[{key:"loadData",value:function(i){for(var s in i)this.createCollection(s,Nc(i[s]))}},{key:"dump",value:function(){return this._collections.reduce(function(i,s){return i[s.name]=s.all(),i},{})}},{key:"createCollection",value:function(i,s){if(this[i])s&&this[i].insert(s);else{var a=this.identityManagerFor(i),u=new Ap(i,s,a);Object.defineProperty(this,i,{get:function(){var d=u.all();return["insert","find","findBy","where","update","remove","firstOrCreate"].forEach(function(f){d[f]=function(){return u[f].apply(u,arguments)}}),d}}),Object.defineProperty(this,"_".concat(i),{get:function(){var d=[];return["insert","find","findBy","where","update","remove","firstOrCreate"].forEach(function(f){d[f]=function(){return u[f].apply(u,arguments)}}),d}}),this._collections.push(u)}return this}},{key:"createCollections",value:function(){for(var i=this,s=arguments.length,a=new Array(s),u=0;u<s;u++)a[u]=arguments[u];a.forEach(function(l){return i.createCollection(l)})}},{key:"emptyData",value:function(){this._collections.forEach(function(i){return i.remove()})}},{key:"identityManagerFor",value:function(i){return this._identityManagers[this._container.inflector.singularize(i)]||this._identityManagers.application||Cp}},{key:"registerIdentityManagers",value:function(i){this._identityManagers=i||{}}}]),o}(),Qt=function(){function o(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];V(this,o),O(n&&typeof n=="string","You must pass a `modelName` into a Collection"),this.modelName=n,this.models=i}return et(o,[{key:"length",get:function(){return this.models.length}},{key:"update",value:function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return me.apply(void 0,[this.models,"update"].concat(s)),this}},{key:"save",value:function(){return me(this.models,"save"),this}},{key:"reload",value:function(){return me(this.models,"reload"),this}},{key:"destroy",value:function(){return me(this.models,"destroy"),this}},{key:"add",value:function(i){return this.models.push(i),this}},{key:"remove",value:function(i){var s=this.models.find(function(u){return u.toString()===i.toString()});if(s){var a=this.models.indexOf(s);this.models.splice(a,1)}return this}},{key:"includes",value:function(i){return this.models.some(function(s){return s.toString()===i.toString()})}},{key:"filter",value:function(i){var s=this.models.filter(i);return new o(this.modelName,s)}},{key:"sort",value:function(i){var s=this.models.concat().sort(i);return new o(this.modelName,s)}},{key:"slice",value:function(){var i,s=(i=this.models).slice.apply(i,arguments);return new o(this.modelName,s)}},{key:"mergeCollection",value:function(i){return this.models=this.models.concat(i.models),this}},{key:"toString",value:function(){return"collection:".concat(this.modelName,"(").concat(this.models.map(function(i){return i.id}).join(","),")")}}]),o}(),Et=function(){function o(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];V(this,o),this.models=n}return et(o,[{key:"length",get:function(){return this.models.length}},{key:"update",value:function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return me.apply(void 0,[this.models,"update"].concat(s)),this}},{key:"destroy",value:function(){return me(this.models,"destroy"),this}},{key:"save",value:function(){return me(this.models,"save"),this}},{key:"reload",value:function(){return me(this.models,"reload"),this}},{key:"add",value:function(i){return this.models.push(i),this}},{key:"remove",value:function(i){var s=this.models.find(function(u){return dr(u.attrs,i.attrs)});if(s){var a=this.models.indexOf(s);this.models.splice(a,1)}return this}},{key:"includes",value:function(i){return this.models.some(function(s){return dr(s.attrs,i.attrs)})}},{key:"filter",value:function(i){var s=this.models.filter(i);return new o(s)}},{key:"sort",value:function(i){var s=this.models.concat().sort(i);return new o(s)}},{key:"slice",value:function(){var i,s=(i=this.models).slice.apply(i,arguments);return new o(s)}},{key:"mergeCollection",value:function(i){return this.models=this.models.concat(i.models),this}},{key:"toString",value:function(){return"collection:".concat(this.modelName,"(").concat(this.models.map(function(i){return i.id}).join(","),")")}}]),o}(),De={},hi=function(o){Ut(i,o);var n=Wt(i);function i(){return V(this,i),n.apply(this,arguments)}return et(i,[{key:"identifier",get:function(){if(typeof De[this.name]!="string"){var a="".concat(z(this._container.inflector.singularize(this.name)),"Ids");De[this.name]=a}return De[this.name]}},{key:"type",get:function(){return"hasMany"}},{key:"getForeignKeyArray",value:function(){return[z(this.ownerModelName),this.getForeignKey()]}},{key:"getForeignKey",value:function(){if(typeof De[this.name]!="string"){var a="".concat(this._container.inflector.singularize(z(this.name)),"Ids");De[this.name]=a}return De[this.name]}},{key:"addMethodsToModelClass",value:function(a,u){var l=a.prototype,d=this,f=this.getForeignKey(),v=ct({},u,this);l.hasManyAssociations=Object.assign(l.hasManyAssociations,v),Object.keys(l.hasManyAssociations).forEach(function(y){var _=l.hasManyAssociations[y];l.hasManyAssociationFks[_.getForeignKey()]=_}),this.schema.addDependentAssociation(this,this.modelName),l.associationKeys.add(u),l.associationIdKeys.add(f),Object.defineProperty(l,f,{get:function(){this._tempAssociations=this._tempAssociations||{};var _=this._tempAssociations[u],x=[];return _?d.isPolymorphic?x=_.models.map(function(P){return{type:P.modelName,id:P.id}}):x=_.models.map(function(P){return P.id}):x=this.attrs[f]||[],x},set:function(_){var x;if(_===null)x=[];else if(_!==void 0)if(O(Array.isArray(_),"You must pass an array in when setting ".concat(f," on ").concat(this)),d.isPolymorphic){O(_.every(function(A){return ft(A)==="object"&&ft(A.type)!==void 0&&ft(A.id)!==void 0}),"You must pass in an array of polymorphic identifiers (objects of shape { type, id }) when setting ".concat(f," on ").concat(this));var P=_.map(function(A){var M=A.type,T=A.id;return d.schema[d.schema.toCollectionName(M)].find(T)});x=new Et(P)}else x=d.schema[d.schema.toCollectionName(d.modelName)].find(_);this[u]=x}}),Object.defineProperty(l,u,{get:function(){this._tempAssociations=this._tempAssociations||{};var _=null;if(this._tempAssociations[u])_=this._tempAssociations[u];else{if(d.isPolymorphic)if(this[f]){var x=this[f],P=x.map(function(A){var M=A.type,T=A.id;return d.schema[d.schema.toCollectionName(M)].find(T)});_=new Et(P)}else _=new Et(d.modelName);else this[f]?_=d.schema[d.schema.toCollectionName(d.modelName)].find(this[f]):_=new Qt(d.modelName);this._tempAssociations[u]=_}return _},set:function(_){var x=this;(_ instanceof Qt||_ instanceof Et)&&(_=_.models),_=_?tn(_):[],this._tempAssociations=this._tempAssociations||{};var P;d.isPolymorphic?P=new Et(_):P=new Qt(d.modelName,_),this._tempAssociations[u]=P,_.forEach(function(A){if(A.hasInverseFor(d)){var M=A.inverseFor(d);A.associate(x,M)}})}}),l["new".concat(Gi(z(this._container.inflector.singularize(d.name))))]=function(){var y,_;d.isPolymorphic?(y=arguments.length<=0?void 0:arguments[0],_=arguments.length<=1?void 0:arguments[1]):(y=d.modelName,_=arguments.length<=0?void 0:arguments[0]);var x=d.schema[d.schema.toCollectionName(y)].new(_),P=this[u].models;return P.push(x),this[u]=P,x},l["create".concat(Gi(z(this._container.inflector.singularize(d.name))))]=function(){var y,_;d.isPolymorphic?(y=arguments.length<=0?void 0:arguments[0],_=arguments.length<=1?void 0:arguments[1]):(y=d.modelName,_=arguments.length<=0?void 0:arguments[0]);var x=d.schema[d.schema.toCollectionName(y)].create(_),P=this[u].models;return P.push(x),this[u]=P,this.save(),x.reload()}}},{key:"disassociateAllDependentsFromTarget",value:function(a){var u=this,l=this.ownerModelName,d;this.isPolymorphic?d={type:a.modelName,id:a.id}:d=a.id;var f=this.schema[this.schema.toCollectionName(l)].where(function(v){var y=v[u.getForeignKey()];return y&&y.find(function(_){return ft(_)==="object"?_.type===d.type&&_.id===d.id:_===d})});f.models.forEach(function(v){v.disassociate(a,u),v.save()})}}]),i}(_i),sr={},on=function(){function o(){V(this,o)}return et(o,[{key:"getModelClassFromPath",value:function(i){if(i){if(typeof sr[i]!="string"){for(var s=i.split("/"),a,u=s.length-1;u>=0;u--){var l=s[u];if(l.length&&l[0]!==":"){a=l;break}}sr[i]=tt(z(this._container.inflector.singularize(a)))}return sr[i]}}},{key:"_getIdForRequest",value:function(i,s){var a;return i&&i.params&&i.params.id?a=i.params.id:s&&s.data&&s.data.id&&(a=s.data.id),a}},{key:"_getJsonApiDocForRequest",value:function(i,s){var a;return i&&i.requestBody&&(a=JSON.parse(i.requestBody)),this.serializerOrRegistry.normalize(a,s)}},{key:"_getAttrsForRequest",value:function(i,s){var a=this,u=this._getJsonApiDocForRequest(i,s),l=this._getIdForRequest(i,u),d={};return O(u.data&&(u.data.attributes||u.data.type||u.data.relationships),"You're using a shorthand or #normalizedRequestAttrs, but your serializer's normalize function did not return a valid JSON:API document. Consult the docs for the normalize hook on the Serializer class."),u.data.attributes&&(d=Object.keys(u.data.attributes).reduce(function(f,v){return f[z(v)]=u.data.attributes[v],f},{})),u.data.relationships&&Object.keys(u.data.relationships).forEach(function(f){var v=u.data.relationships[f],y=a.schema.modelClassFor(s),_=y.associationFor(z(f)),x;O(_,"You're passing the relationship '".concat(f,"' to the '").concat(s,"' model via a ").concat(i.method," to '").concat(i.url,"', but you did not define the '").concat(f,"' association on the '").concat(s,"' model.")),_.isPolymorphic?x=v.data:_ instanceof hi?x=v.data&&v.data.map(function(P){return P.id}):x=v.data&&v.data.id,d[_.identifier]=x},{}),l&&(d.id=l),d}},{key:"_getAttrsForFormRequest",value:function(i){var s=i.requestBody,a,u=[];return O(s&&typeof s=="string","You're using the helper method #normalizedFormData, but the request body is empty or not a valid url encoded string."),u=s.split("&"),a=u.reduce(function(l,d){var f=d.split("="),v=Mt(f,2),y=v[0],_=v[1];return l[y]=decodeURIComponent(_.replace(/\+/g," ")),l},{}),a}}]),o}(),qa=function(o){Ut(i,o);var n=Wt(i);function i(s,a,u,l,d){var f;return V(this,i),f=n.call(this,d),f.schema=s,f.serializerOrRegistry=a,f.userFunction=u,f.path=l,f}return et(i,[{key:"handle",value:function(a){return this.userFunction(this.schema,a)}},{key:"setRequest",value:function(a){this.request=a}},{key:"serialize",value:function(a,u){var l;return u?l=this.serializerOrRegistry.serializerFor(u,{explicit:!0}):l=this.serializerOrRegistry,l.serialize(a,this.request)}},{key:"normalizedRequestAttrs",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,u=this.path,l=this.request,d=this.request.requestHeaders,f,v={};for(var y in d)v[y.toLowerCase()]=d[y];return/x-www-form-urlencoded/.test(v["content-type"])?f=this._getAttrsForFormRequest(l):(a?O(tt(a)===a,"You called normalizedRequestAttrs('".concat(a,"'), but normalizedRequestAttrs was intended to be used with the dasherized version of the model type. Please change this to normalizedRequestAttrs('").concat(tt(a),"').")):a=this.getModelClassFromPath(u),O(this.schema.hasModelForModelName(a),"You're using a shorthand or the #normalizedRequestAttrs helper but the detected model of '".concat(a,"' does not exist. You might need to pass in the correct modelName as the first argument to #normalizedRequestAttrs.")),f=this._getAttrsForRequest(l,a)),f}}]),i}(on),Mp=function(){function o(n,i,s){V(this,o),this.schema=n,this.serializerOrRegistry=i,this.object=s}return et(o,[{key:"handle",value:function(){return this.object}}]),o}(),vi=function(o){Ut(i,o);var n=Wt(i);function i(s,a,u,l){var d,f=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};V(this,i),d=n.call(this),u=u||d.getModelClassFromPath(l),d.schema=s,d.serializerOrRegistry=a,d.shorthand=u,d.options=f;var v=Array.isArray(u)?"array":ft(u);if(v==="string"){var y=d.schema[d.schema.toCollectionName(u)];d.handle=function(x){return d.handleStringShorthand(x,y)}}else if(v==="array"){var _=u.map(function(x){return d.schema[d.schema.toCollectionName(x)]});d.handle=function(x){return d.handleArrayShorthand(x,_)}}return d}return i}(on),kp=function(o){Ut(i,o);var n=Wt(i);function i(){return V(this,i),n.apply(this,arguments)}return et(i,[{key:"handleStringShorthand",value:function(a,u){var l=this.shorthand,d=z(l);O(u,"The route handler for ".concat(a.url," is trying to access the ").concat(d," model, but that model doesn't exist."));var f=this._getIdForRequest(a);if(f){var v=u.find(f);return v||new kt(404)}else if(this.options.coalesce){var y=this.serializerOrRegistry.getCoalescedIds(a,d);if(y)return u.find(y)}return u.all()}},{key:"handleArrayShorthand",value:function(a,u){var l=this.shorthand,d=this._getIdForRequest(a);return O(!d||this._container.inflector.singularize(l[0])!==l[0],`It looks like you're using the "Single record with
      related records" version of the array shorthand, in addition to opting
      in to the model layer. This shorthand was made when there was no
      serializer layer. Now that you're using models, please ensure your
      relationships are defined, and create a serializer for the parent
      model, adding the relationships there.`),u.map(function(f){return f.all()})}}]),i}(vi),Ep=function(o){Ut(i,o);var n=Wt(i);function i(){return V(this,i),n.apply(this,arguments)}return et(i,[{key:"handleStringShorthand",value:function(a,u){var l=this.shorthand,d=z(l);O(u,"The route handler for ".concat(a.url," is trying to access the ").concat(d," model, but that model doesn't exist."));var f=this._getAttrsForRequest(a,u.camelizedModelName);return u.create(f)}}]),i}(vi),Ip=function(o){Ut(i,o);var n=Wt(i);function i(){return V(this,i),n.apply(this,arguments)}return et(i,[{key:"handleStringShorthand",value:function(a,u){var l=this.shorthand,d=z(l);O(u,"The route handler for ".concat(a.url," is trying to access the ").concat(d," model, but that model doesn't exist."));var f=this._getIdForRequest(a),v=u.find(f);if(!v)return new kt(404);var y=this._getAttrsForRequest(a,u.camelizedModelName);return v.update(y)}}]),i}(vi),Rp=function(o){Ut(i,o);var n=Wt(i);function i(){return V(this,i),n.apply(this,arguments)}return et(i,[{key:"handleStringShorthand",value:function(a,u){var l=this.shorthand,d=z(l);O(u,"The route handler for ".concat(a.url," is trying to access the ").concat(d," model, but that model doesn't exist."));var f=this._getIdForRequest(a),v=u.find(f);if(!v)return new kt(404);v.destroy()}},{key:"handleArrayShorthand",value:function(a,u){var l=this,d=this._getIdForRequest(a),f=u[0].find(d),v=u.slice(1).map(function(y){return l._container.inflector.pluralize(y.camelizedModelName)});v.forEach(function(y){return f[y].destroy()}),f.destroy()}}]),i}(vi),Op=function(o){Ut(i,o);var n=Wt(i);function i(){return V(this,i),n.apply(this,arguments)}return et(i,[{key:"handleStringShorthand",value:function(a,u){var l=this.shorthand,d=z(l);O(u,"The route handler for ".concat(a.url," is trying to access the ").concat(d," model, but that model doesn't exist."));var f=this._getIdForRequest(a);if(f){var v=u.find(f);return v?new kt(204):new kt(404)}else if(this.options.coalesce&&a.queryParams&&a.queryParams.ids){var y=u.find(a.queryParams.ids);return y?new kt(204):new kt(404)}else return new kt(204)}}]),i}(vi),zp={get:200,put:204,post:201,delete:204};function Fp(o){var n=o.verb,i=o.schema,s=o.serializerOrRegistry,a=o.path,u=o.rawHandler,l=o.options,d=o.middleware,f,v=[i,s,u,a,l,d],y=ft(u);return y==="function"?f=Bt(qa,v):y==="object"&&u?f=Bt(Mp,v):n==="get"?f=Bt(kp,v):n==="post"?f=Bt(Ep,v):n==="put"||n==="patch"?f=Bt(Ip,v):n==="delete"?f=Bt(Rp,v):n==="head"&&(f=Bt(Op,v)),f}var Ua=function(){function o(n){var i=n.schema,s=n.verb,a=n.rawHandler,u=n.customizedCode,l=n.options,d=n.path,f=n.serializerOrRegistry,v=n.middleware;V(this,o),this.verb=s,this.customizedCode=u,this.serializerOrRegistry=f,this.middleware=v||[],this.handler=Fp({verb:s,schema:i,path:d,serializerOrRegistry:f,rawHandler:a,options:l})}return et(o,[{key:"handle",value:function(i){var s=this;return this._getMirageResponseForRequest(i,this.middleware).then(function(a){return s.serialize(a,i)}).then(function(a){return a.toRackResponse()})}},{key:"_getMirageResponseForRequest",value:function(i){var s=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],u;try{this.handler instanceof qa&&this.handler.setRequest(i),u=this.handleWithMiddleware(i,[].concat(Ze(a),[function(d,f){return s.handler.handle(f)}]))}catch(d){if(d instanceof Yi)u=new kt(500,{},d);else{var l=d.message||d;u=new kt(500,{},{message:l,stack:"Mirage: Your ".concat(i.method," handler for the url ").concat(i.url,` threw an error:

`).concat(d.stack||d)})}}return this._toMirageResponse(u)}},{key:"handleWithMiddleware",value:function(i,s){var a=this,u=xp(s),l=u[0],d=u.slice(1);return l(this.schema,i,function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:i;return a.handleWithMiddleware(f,d)})}},{key:"_toMirageResponse",value:function(i){var s=this,a;return new Promise(function(u,l){Promise.resolve(i).then(function(d){if(d instanceof kt)a=i;else{var f=s._getCodeForResponse(d);a=new kt(f,{},d)}u(a)}).catch(l)})}},{key:"_getCodeForResponse",value:function(i){var s;return this.customizedCode?s=this.customizedCode:(s=zp[this.verb],s===204&&i!==void 0&&i!==""&&(s=200)),s}},{key:"serialize",value:function(i,s){return i.data=this.serializerOrRegistry.serialize(i.data,s),i}}]),o}();function Wa(o,n){var i=function(s){Ut(u,s);var a=Wt(u);function u(){var l;V(this,u);for(var d=arguments.length,f=new Array(d),v=0;v<d;v++)f[v]=arguments[v];if(l=a.call.apply(a,[this].concat(f)),o&&ud(o,"constructor")){var y;(y=o.constructor).call.apply(y,[Da(l)].concat(f))}return l}return u}(this);return Object.assign(i,this,n),o&&Object.assign(i.prototype,o),i}var an=function(){function o(n,i,s,a){var u=this;return V(this,o),O(n,"A model requires a schema"),O(i,"A model requires a modelName"),this._schema=n,this.modelName=i,this.fks=a||[],this.attrs={},s=s||{},this.fks.forEach(function(l){u.attrs[l]=s[l]!==void 0?s[l]:null}),Object.keys(s).forEach(function(l){var d=s[l];u._validateAttr(l,d),u._setupAttr(l,d),u._setupRelationship(l,d)}),this}return et(o,[{key:"save",value:function(){var i=this._schema.toInternalCollectionName(this.modelName);return this.isNew()?(this.attrs=this._schema.db[i].insert(this.attrs),this._definePlainAttribute("id")):(this._schema.isSaving[this.toString()]=!0,this._schema.db[i].update(this.attrs.id,this.attrs)),this._saveAssociations(),this._schema.isSaving[this.toString()]=!1,this}},{key:"update",value:function(i,s){var a;return i==null?this:(ft(i)==="object"?a=i:(a={})[i]=s,Object.keys(a).forEach(function(u){!this.associationKeys.has(u)&&!this.associationIdKeys.has(u)&&this._definePlainAttribute(u),this[u]=a[u]},this),this.save(),this)}},{key:"destroy",value:function(){if(this.isSaved()){this._disassociateFromDependents();var i=this._schema.toInternalCollectionName(this.modelName);this._schema.db[i].remove(this.attrs.id)}}},{key:"isNew",value:function(){var i=!1,s=this.attrs.id!==void 0&&this.attrs.id!==null;if(s){var a=this._schema.toInternalCollectionName(this.modelName),u=this._schema.db[a].find(this.attrs.id);u&&(i=!0)}return!i}},{key:"isSaved",value:function(){return!this.isNew()}},{key:"reload",value:function(){if(this.id){var i=this._schema.toInternalCollectionName(this.modelName),s=this._schema.db[i].find(this.id);Object.keys(s).filter(function(a){return a!=="id"}).forEach(function(a){this.attrs[a]=s[a]},this)}return this._tempAssociations={},this}},{key:"toJSON",value:function(){return vp({},this.attrs)}},{key:"associations",get:function(){return this._schema.associationsFor(this.modelName)}},{key:"associationFor",value:function(i){return this.associations[i]}},{key:"inverseFor",value:function(i){return this._explicitInverseFor(i)||this._implicitInverseFor(i)}},{key:"_explicitInverseFor",value:function(i){this._checkForMultipleExplicitInverses(i);var s=this._schema.associationsFor(this.modelName),a=i.opts.inverse,u=a?s[a]:null,l=u&&u.isPolymorphic,d=u&&u.modelName===i.ownerModelName,f=u&&u.opts.inverse;return f&&u.opts.inverse!==i.name&&O(!1,"You specified an inverse of ".concat(a," for ").concat(i.name,", but it does not match ").concat(u.modelName," ").concat(u.name,"'s inverse")),l||d?u:null}},{key:"_checkForMultipleExplicitInverses",value:function(i){var s=this._schema.associationsFor(this.modelName),a=Object.keys(s).filter(function(u){var l=s[u],d=i.ownerModelName===l.modelName,f=i.name===l.opts.inverse;return d&&f});O(a.length<=1,"The ".concat(this.modelName," model has defined multiple explicit inverse associations for the ").concat(i.ownerModelName,".").concat(i.name," association."))}},{key:"_implicitInverseFor",value:function(i){var s=this,a=this._schema.associationsFor(this.modelName),u=i.ownerModelName;return Xn(a).filter(function(l){return l.modelName===u}).reduce(function(l,d){var f=d.opts.inverse,v=f===void 0,y=f===i.name,_=v||y;return _&&(O(!l,"The ".concat(s.modelName," model has multiple possible inverse associations for the ").concat(i.ownerModelName,".").concat(i.name," association.")),l=d),l},null)}},{key:"hasInverseFor",value:function(i){return!!this.inverseFor(i)}},{key:"alreadyAssociatedWith",value:function(i,s){var a=this[s.name];if(a&&i)return a instanceof o?a.isSaved()&&i.isSaved()?a.toString()===i.toString():a===i:a.includes(i)}},{key:"associate",value:function(i,s){if(!this.alreadyAssociatedWith(i,s)){var a=s.name;s instanceof hi?this[a].includes(i)||this[a].add(i):this[a]=i}}},{key:"disassociate",value:function(i,s){var a=s.getForeignKey();if(s instanceof hi){var u;if(s.isPolymorphic){var l=this[a].find(function(d){var f=d.type,v=d.id;return f===i.modelName&&v===i.id});u=l&&this[a].indexOf(l)}else u=this[a].map(function(d){return d.toString()}).indexOf(i.id.toString());u>-1&&this.attrs[a].splice(u,1)}else this.attrs[a]=null}},{key:"isSaving",get:function(){return this._schema.isSaving[this.toString()]}},{key:"_setupAttr",value:function(i,s){var a=this.associationKeys.has(i)||this.associationIdKeys.has(i);a||(this.attrs[i]=s,this._definePlainAttribute(i))}},{key:"_definePlainAttribute",value:function(i){var s=Object.getOwnPropertyDescriptor(this,i);s&&s.get||(Object.prototype.hasOwnProperty.call(this.attrs,i)||(this.attrs[i]=null),Object.defineProperty(this,i,{get:function(){return this.attrs[i]},set:function(u){this.attrs[i]=u}}))}},{key:"_setupRelationship",value:function(i,s){var a=this.associationIdKeys.has(i)||this.fks.includes(i),u=this.associationKeys.has(i);a&&(s!=null&&this._validateForeignKeyExistsInDatabase(i,s),this.attrs[i]=s),u&&(this[i]=s)}},{key:"_validateAttr",value:function(i,s){if(this.associationKeys.has(i)){var a=this.associationFor(i),u=s===null;if(a instanceof hi){var l=s instanceof Qt||s instanceof Et,d=Array.isArray(s)&&s.every(function(P){return P instanceof o});O(l||d||u,"You're trying to create a ".concat(this.modelName,' model and you passed in "').concat(s,'" under the ').concat(i," key, but that key is a HasMany relationship. You must pass in a Collection, PolymorphicCollection, array of Models, or null."))}else a instanceof li&&O(s instanceof o||u,"You're trying to create a ".concat(this.modelName,' model and you passed in "').concat(s,'" under the ').concat(i," key, but that key is a BelongsTo relationship. You must pass in a Model or null."))}if(this.associationIdKeys.has(i)&&i.endsWith("Ids")){var f=Array.isArray(s),v=s===null;O(f||v,"You're trying to create a ".concat(this.modelName,' model and you passed in "').concat(s,'" under the ').concat(i," key, but that key is a foreign key for a HasMany relationship. You must pass in an array of ids or null."))}{var y=s instanceof o||s instanceof Qt||s instanceof Et,_=Array.isArray(s)&&s.length&&s.every(function(P){return P instanceof o});if(y||_){var x=s;O(this.associationKeys.has(i),"You're trying to create a ".concat(this.modelName," model and you passed in a ").concat(x.toString()," under the ").concat(i," key, but you haven't defined that key as an association on your model."))}}}},{key:"_validateForeignKeyExistsInDatabase",value:function(i,s){var a=this;if(Array.isArray(s)){var u=this.hasManyAssociationFks[i],l;u.isPolymorphic?(l=s.map(function(_){var x=_.type,P=_.id;return a._schema.db[a._schema.toInternalCollectionName(x)].find(P)}),l=tn(l)):l=this._schema.db[this._schema.toInternalCollectionName(u.modelName)].find(s);var d=u.isPolymorphic?s.map(function(_){return"".concat(_.type,":").concat(_.id)}).join(","):s;O(l.length===s.length,"You're instantiating a ".concat(this.modelName," that has a ").concat(i," of ").concat(d,", but some of those records don't exist in the database."))}else{var f=this.belongsToAssociationFks[i],v;f.isPolymorphic?v=this._schema.db[this._schema.toInternalCollectionName(s.type)].find(s.id):v=this._schema.db[this._schema.toInternalCollectionName(f.modelName)].find(s);var y=f.isPolymorphic?"".concat(s.type,":").concat(s.id):s;O(v,"You're instantiating a ".concat(this.modelName," that has a ").concat(i," of ").concat(y,", but that record doesn't exist in the database."))}}},{key:"_saveAssociations",value:function(){this._saveBelongsToAssociations(),this._saveHasManyAssociations()}},{key:"_saveBelongsToAssociations",value:function(){var i=this;Xn(this.belongsToAssociations).forEach(function(s){i._disassociateFromOldInverses(s),i._saveNewAssociates(s),i._associateWithNewInverses(s)})}},{key:"_saveHasManyAssociations",value:function(){var i=this;Xn(this.hasManyAssociations).forEach(function(s){i._disassociateFromOldInverses(s),i._saveNewAssociates(s),i._associateWithNewInverses(s)})}},{key:"_disassociateFromOldInverses",value:function(i){i instanceof hi?this._disassociateFromHasManyInverses(i):i instanceof li&&this._disassociateFromBelongsToInverse(i)}},{key:"_disassociateFromHasManyInverses",value:function(i){var s=this,a=i.getForeignKey(),u=this._tempAssociations&&this._tempAssociations[i.name],l=this.attrs[a];if(u&&l){var d;i.isPolymorphic?d=l.map(function(f){var v=f.type,y=f.id;return s._schema[s._schema.toCollectionName(v)].find(y)}):d=this._schema[this._schema.toCollectionName(i.modelName)].find(l||[]).models,d.filter(function(f){return!f.isSaving&&!u.includes(f)&&f.hasInverseFor(i)}).forEach(function(f){var v=f.inverseFor(i);f.disassociate(s,v),f.save()})}}},{key:"_disassociateFromBelongsToInverse",value:function(i){var s=i.getForeignKey(),a=this._tempAssociations&&this._tempAssociations[i.name],u=this.attrs[s];if(a!==void 0&&u){var l;if(i.isPolymorphic?l=this._schema[this._schema.toCollectionName(u.type)].find(u.id):l=this._schema[this._schema.toCollectionName(i.modelName)].find(u),l.hasInverseFor(i)){var d=l.inverseFor(i);l.disassociate(this,d),l._updateInDb(l.attrs)}}}},{key:"_disassociateFromDependents",value:function(){var i=this;this._schema.dependentAssociationsFor(this.modelName).forEach(function(s){s.disassociateAllDependentsFromTarget(i)})}},{key:"_saveNewAssociates",value:function(i){var s=i.getForeignKey(),a=this._tempAssociations&&this._tempAssociations[i.name];if(a!==void 0){if(this.__isSavingNewChildren=!0,delete this._tempAssociations[i.name],a instanceof Qt)a.models.filter(function(l){return!l.isSaving}).forEach(function(l){l.save()}),this._updateInDb(ct({},s,a.models.map(function(l){return l.id})));else if(a instanceof Et)a.models.filter(function(l){return!l.isSaving}).forEach(function(l){l.save()}),this._updateInDb(ct({},s,a.models.map(function(l){return{type:l.modelName,id:l.id}})));else if(a===null)this._updateInDb(ct({},s,null));else if(this.equals(a))this._updateInDb(ct({},s,this.id));else if(!a.isSaving){a.save(),this._syncTempAssociations(a);var u;i.isPolymorphic?u={id:a.id,type:a.modelName}:u=a.id,this._updateInDb(ct({},s,u))}this.__isSavingNewChildren=!1}}},{key:"_associateWithNewInverses",value:function(i){var s=this;if(!this.__isSavingNewChildren){var a=this[i.name];a instanceof o?this._associateModelWithInverse(a,i):(a instanceof Qt||a instanceof Et)&&a.models.forEach(function(u){s._associateModelWithInverse(u,i)}),delete this._tempAssociations[i.name]}}},{key:"_associateModelWithInverse",value:function(i,s){var a=this;if(i.hasInverseFor(s)){var u=i.inverseFor(s),l=u.getForeignKey(),d=this.id;if(u instanceof li){var f;u.isPolymorphic?f={type:this.modelName,id:d}:f=d,this._schema.db[this._schema.toInternalCollectionName(i.modelName)].update(i.id,ct({},l,f))}else{var v=this._schema.db[this._schema.toInternalCollectionName(i.modelName)],y=v.find(i.id)[u.getForeignKey()]||[],_=Object.assign([],y),x,P;u.isPolymorphic?(x={type:this.modelName,id:d},P=_.some(function(A){return A.type==a.modelName&&A.id==d})):(x=d,P=_.includes(d)),P||_.push(x),v.update(i.id,ct({},l,_))}}}},{key:"_updateInDb",value:function(i){this.attrs=this._schema.db[this._schema.toInternalCollectionName(this.modelName)].update(this.attrs.id,i)}},{key:"_syncTempAssociations",value:function(i){var s=this;Object.keys(this._tempAssociations).forEach(function(a){s._tempAssociations[a]&&s._tempAssociations[a].toString()===i.toString()&&(s._tempAssociations[a]=i)})}},{key:"toString",value:function(){var i=this.id?"(".concat(this.id,")"):"";return"model:".concat(this.modelName).concat(i)}},{key:"equals",value:function(i){return this.toString()===i.toString()}}]),o}();an.extend=Wa;an.findBelongsToAssociation=function(o){return this.prototype.belongsToAssociations[o]};var zt=function(){function o(n,i){var s=this,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};V(this,o),this.registry=n,this.type=i,this.request=a,this.attrs=this.attrs||void 0,this.include=this.include||[],this.root=this.root||void 0,this.embed=this.embed||void 0,this._embedFn=mo(this.embed)?this.embed:function(){return!!s.embed},this.serializeIds=this.serializeIds||void 0,this.primaryKey=this.primaryKey||void 0}return et(o,[{key:"serialize",value:function(i){return this.primaryResource=i,this.buildPayload(i)}},{key:"normalize",value:function(i){return i}},{key:"buildPayload",value:function(i,s,a,u){if(!i&&vr(s))return u;if(i){var l=this.getHashForPrimaryResource(i),d=Mt(l,2),f=d[0],v=d[1],y=this.isCollection(i)?i.models:[i];return this.buildPayload(void 0,v,y,f)}else{var _=s.shift(),x=this.getHashForIncludedResource(_),P=Mt(x,2),A=P[0],M=P[1],T=M.filter(function(rt){return!a.map(function(yt){return yt.toString()}).includes(rt.toString())}).concat(s),j=(this.isCollection(_)?_.models:[_]).concat(a),U=this.mergePayloads(u,A);return this.buildPayload(void 0,T,j,U)}}},{key:"getHashForPrimaryResource",value:function(i){var s=this.getHashForResource(i),a=Mt(s,2),u=a[0],l=a[1],d;if(this.root){O(!(i instanceof Et),"The base Serializer class cannot serialize a top-level PolymorphicCollection when root is true, since PolymorphicCollections have no type.");var f=this.serializerFor(i.modelName),v=f.keyForResource(i);d=ct({},v,u)}else d=u;return[d,l]}},{key:"getHashForIncludedResource",value:function(i){var s,a;if(i instanceof Et)s={},a=i.models;else{var u=this.serializerFor(i.modelName),l=u.getHashForResource(i),d=Mt(l,2),f=d[0],v=d[1],y=u.keyForRelationship(i.modelName);s=Array.isArray(f)?ct({},y,f):ct({},y,[f]),a=v}return[s,a]}},{key:"getHashForResource",value:function(i){var s=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,d=this,f;l&&i.modelName&&(d=this.serializerFor(i.modelName)),this.isModel(i)?f=d._hashForModel(i,a,u):f=i.models.map(function(y){var _=d;return _||(_=s.serializerFor(y.modelName)),_._hashForModel(y,a,u)});var v=ia(tn(na(d.getKeysForIncluded().map(function(y){return s.isCollection(i)?i.models.map(function(_){return _[y]}):i[y]}))),function(y){return y.toString()});return[f,v]}},{key:"mergePayloads",value:function(i,s){var a,u=Object.keys(s),l=Mt(u,1),d=l[0];return i[d]?(a=i,a[d]=i[d].concat(s[d])):a=Object.assign(i,s),a}},{key:"keyForResource",value:function(i){var s=i.modelName;return this.isModel(i)?this.keyForModel(s):this.keyForCollection(s)}},{key:"keyForModel",value:function(i){return z(i)}},{key:"keyForCollection",value:function(i){return this._container.inflector.pluralize(this.keyForModel(i))}},{key:"_hashForModel",value:function(i,s){var a=this,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},l=this._attrsForModel(i);if(s&&i.fks.forEach(function(f){delete l[f]}),this.embed){var d=Object.assign({},u);d[i.modelName]=d[i.modelName]||{},d[i.modelName][i.id]=!0,this.getKeysForEmbedded().forEach(function(f){var v=i[f];if(v&&!ra(d,"".concat(v.modelName,".").concat(v.id))){var y=a.getHashForResource(v,!0,d,!0),_=Mt(y,1),x=_[0],P=a.keyForEmbeddedRelationship(f);if(l[P]=x,a.isModel(v)){var A="".concat(z(f),"Id");delete l[A]}}})}return this._maybeAddAssociationIds(i,l)}},{key:"_attrsForModel",value:function(i){var s={};return this.attrs?s=this.attrs.reduce(function(a,u){return a[u]=i[u],a},{}):s=Object.assign(s,i.attrs),i.fks.forEach(function(a){return delete s[a]}),this._formatAttributeKeys(s)}},{key:"_maybeAddAssociationIds",value:function(i,s){var a=this,u=Object.assign({},s);return this.serializeIds==="always"?Ze(i.associationKeys).filter(function(l){return!a._embedFn(l)}).forEach(function(l){var d=i[l],f=i.associationFor(l);if(a.isCollection(d)){var v=a.keyForRelationshipIds(l);u[v]=i["".concat(a._container.inflector.singularize(l),"Ids")]}else if(a.isModel(d)&&f.isPolymorphic){var y=a.keyForPolymorphicForeignKeyType(l),_=a.keyForPolymorphicForeignKeyId(l);u[y]=i["".concat(l,"Id")].type,u[_]=i["".concat(l,"Id")].id}else if(d){var x=a.keyForForeignKey(l);u[x]=i["".concat(l,"Id")]}}):this.serializeIds==="included"&&this.getKeysForIncluded().forEach(function(l){var d=i[l],f=i.associationFor(l);if(a.isCollection(d)){var v=a.keyForRelationshipIds(l);u[v]=i["".concat(a._container.inflector.singularize(l),"Ids")]}else if(a.isModel(d)&&f.isPolymorphic){var y=a.keyForPolymorphicForeignKeyType(l),_=a.keyForPolymorphicForeignKeyId(l);u[y]=i["".concat(l,"Id")].type,u[_]=i["".concat(l,"Id")].id}else if(a.isModel(d)){var x=a.keyForForeignKey(l);u[x]=i["".concat(l,"Id")]}}),u}},{key:"keyForAttribute",value:function(i){return i==="id"?this.keyForId():i}},{key:"keyForRelationship",value:function(i){return z(this._container.inflector.pluralize(i))}},{key:"keyForEmbeddedRelationship",value:function(i){return z(i)}},{key:"keyForRelationshipIds",value:function(i){return"".concat(this._container.inflector.singularize(z(i)),"Ids")}},{key:"keyForForeignKey",value:function(i){return"".concat(z(i),"Id")}},{key:"keyForPolymorphicForeignKeyId",value:function(i){return"".concat(z(i),"Id")}},{key:"keyForPolymorphicForeignKeyType",value:function(i){return"".concat(z(i),"Type")}},{key:"isModel",value:function(i){return i instanceof an}},{key:"isCollection",value:function(i){return i instanceof Qt||i instanceof Et}},{key:"isModelOrCollection",value:function(i){return this.isModel(i)||this.isCollection(i)}},{key:"serializerFor",value:function(i){return this.registry.serializerFor(i)}},{key:"getAssociationKeys",value:function(){return mo(this.include)?this.include(this.request,this.primaryResource):this.include}},{key:"getKeysForEmbedded",value:function(){var i=this;return this.getAssociationKeys().filter(function(s){return i._embedFn(s)})}},{key:"getKeysForIncluded",value:function(){var i=this;return this.getAssociationKeys().filter(function(s){return!i._embedFn(s)})}},{key:"schema",get:function(){return this.registry.schema}},{key:"keyForId",value:function(){return this.primaryKey}},{key:"valueForId",value:function(i){return i}},{key:"_formatAttributeKeys",value:function(i){var s={};for(var a in i){var u=i[a];a==="id"&&(u=this.valueForId(u));var l=this.keyForAttribute(a);s[l]=u}return s}},{key:"getCoalescedIds",value:function(){}}]),o}();zt.prototype.include=[];zt.prototype.root=!0;zt.prototype.embed=!1;zt.prototype.primaryKey="id";zt.prototype.serializeIds="included";zt.extend=Wa;var Ka=function(o){Ut(i,o);var n=Wt(i);function i(){var s;return V(this,i),s=n.apply(this,arguments),s.alwaysIncludeLinkageData=s.alwaysIncludeLinkageData||void 0,s}return et(i,[{key:"keyForModel",value:function(a){return tt(a)}},{key:"keyForCollection",value:function(a){return tt(a)}},{key:"keyForAttribute",value:function(a){return tt(a)}},{key:"keyForRelationship",value:function(a){return tt(a)}},{key:"links",value:function(){}},{key:"getHashForPrimaryResource",value:function(a){this._createRequestedIncludesGraph(a);var u=this.getHashForResource(a),l={data:u},d=this.getAddToIncludesForResource(a);return[l,d]}},{key:"getHashForIncludedResource",value:function(a){var u=this.serializerFor(a.modelName),l=u.getHashForResource(a),d={included:this.isModel(a)?[l]:l},f=[];return this.hasQueryParamIncludes()||(f=this.getAddToIncludesForResource(a)),[d,f]}},{key:"getHashForResource",value:function(a){var u=this,l;return this.isModel(a)?l=this.getResourceObjectForModel(a):l=a.models.map(function(d){return u.getResourceObjectForModel(d)}),l}},{key:"getAddToIncludesForResource",value:function(a){var u;if(this.hasQueryParamIncludes())u=this.getQueryParamIncludes();else{var l=this.serializerFor(a.modelName);u=l.getKeysForIncluded()}return this.getAddToIncludesForResourceAndPaths(a,u)}},{key:"getAddToIncludesForResourceAndPaths",value:function(a,u){var l=this,d=[];return u.forEach(function(f){var v=f.split("."),y=l.getIncludesForResourceAndPath.apply(l,[a].concat(Ze(v)));d.push(y)}),ia(tn(na(d)),function(f){return f.toString()})}},{key:"getIncludesForResourceAndPath",value:function(a){for(var u=this,l=arguments.length,d=new Array(l>1?l-1:0),f=1;f<l;f++)d[f-1]=arguments[f];var v=z(d.shift()),y=[],_=[];if(this.isModel(a)){var x=a[v];this.isModel(x)?_=[x]:this.isCollection(x)&&(_=x.models)}else a.models.forEach(function(P){var A=P[v];u.isModel(A)?_.push(A):u.isCollection(A)&&(_=_.concat(A.models))});return y=y.concat(_),d.length&&_.forEach(function(P){y=y.concat(u.getIncludesForResourceAndPath.apply(u,[P].concat(d)))}),y}},{key:"getResourceObjectForModel",value:function(a){var u=this._attrsForModel(a,!0);delete u.id;var l={type:this.typeKeyForModel(a),id:a.id,attributes:u};return this._maybeAddRelationshipsToResourceObjectForModel(l,a)}},{key:"_maybeAddRelationshipsToResourceObjectForModel",value:function(a,u){var l=this,d={};return u.associationKeys.forEach(function(f){var v=u[f],y=l.keyForRelationship(f),_={};if(l.hasLinksForRelationship(u,f)){var x=l.serializerFor(u.modelName),P=x.links(u);_.links=P[f]}if(l.alwaysIncludeLinkageData||l.shouldIncludeLinkageData(f,u)||l._relationshipIsIncludedForModel(f,u)){var A=null;l.isModel(v)?A={type:l.typeKeyForModel(v),id:v.id}:l.isCollection(v)&&(A=v.models.map(function(M){return{type:l.typeKeyForModel(M),id:M.id}})),_.data=A}vr(_)||(d[y]=_)}),vr(d)||(a.relationships=d),a}},{key:"hasLinksForRelationship",value:function(a,u){var l=this.serializerFor(a.modelName),d=l.links&&l.links(a);return d&&d[u]!=null}},{key:"_relationshipIsIncludedForModel",value:function(a,u){if(this.hasQueryParamIncludes()){var l=this.request._includesGraph,d=this._graphKeyForModel(u),f;return l.data[d]?f=l.data[d]:l.included[this._container.inflector.pluralize(u.modelName)]&&(f=l.included[this._container.inflector.pluralize(u.modelName)][d]),f&&f.relationships&&Object.prototype.hasOwnProperty.call(f.relationships,tt(a))}else{var v=this.getKeysForIncluded();return v.includes(a)}}},{key:"_createRequestedIncludesGraph",value:function(a){var u=this,l={data:{}};if(this.isModel(a)){var d=this._graphKeyForModel(a);l.data[d]={},this._addPrimaryModelToRequestedIncludesGraph(l,a)}else this.isCollection(a)&&a.models.forEach(function(f){var v=u._graphKeyForModel(f);l.data[v]={},u._addPrimaryModelToRequestedIncludesGraph(l,f)});this.request._includesGraph=l}},{key:"_addPrimaryModelToRequestedIncludesGraph",value:function(a,u){var l=this;if(this.hasQueryParamIncludes()){var d=this._graphKeyForModel(u);this.getQueryParamIncludes().filter(function(f){return!!f.trim()}).forEach(function(f){a.data[d].relationships=a.data[d].relationships||{};var v=f.split(".").map(tt),y=v[0],_=y,x=z(y),P=u.associationKeys.has(x);O(P,'You tried to include "'.concat(y,'" with ').concat(u,' but no association named "').concat(x,'" is defined on the model.'));var A=u[x],M;l.isModel(A)?M=l._graphKeyForModel(A):l.isCollection(A)?M=A.models.map(l._graphKeyForModel):M=null,a.data[d].relationships[_]=M,A&&l._addResourceToRequestedIncludesGraph(a,A,v.slice(1))})}}},{key:"_addResourceToRequestedIncludesGraph",value:function(a,u,l){var d=this;a.included=a.included||{};var f=this.isCollection(u)?u.models:[u];f.forEach(function(v){var y=d._container.inflector.pluralize(v.modelName);a.included[y]=a.included[y]||{},d._addModelToRequestedIncludesGraph(a,v,l)})}},{key:"_addModelToRequestedIncludesGraph",value:function(a,u,l){var d=this._container.inflector.pluralize(u.modelName),f=this._graphKeyForModel(u);a.included[d][f]=a.included[d][f]||{},l.length&&this._addResourceRelationshipsToRequestedIncludesGraph(a,d,f,u,l)}},{key:"_addResourceRelationshipsToRequestedIncludesGraph",value:function(a,u,l,d,f){a.included[u][l].relationships=a.included[u][l].relationships||{};var v=f[0],y=d[z(v)],_;this.isModel(y)?_=this._graphKeyForModel(y):this.isCollection(y)&&(_=y.models.map(this._graphKeyForModel)),a.included[u][l].relationships[v]=_,y&&this._addResourceToRequestedIncludesGraph(a,y,f.slice(1))}},{key:"_graphKeyForModel",value:function(a){return"".concat(a.modelName,":").concat(a.id)}},{key:"getQueryParamIncludes",value:function(){var a=ra(this,"request.queryParams.include");return a&&!Array.isArray(a)&&(a=a.split(",")),a}},{key:"hasQueryParamIncludes",value:function(){return!!this.getQueryParamIncludes()}},{key:"typeKeyForModel",value:function(a){return tt(this._container.inflector.pluralize(a.modelName))}},{key:"getCoalescedIds",value:function(a){var u=a.queryParams&&a.queryParams["filter[id]"];return typeof u=="string"?u.split(","):u}},{key:"shouldIncludeLinkageData",value:function(a,u){return!1}}]),i}(zt);Ka.prototype.alwaysIncludeLinkageData=!1;var Ga=function(){function o(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};V(this,o),this.schema=n,this._serializerMap=i}return et(o,[{key:"normalize",value:function(i,s){return this.serializerFor(s).normalize(i)}},{key:"serialize",value:function(i,s){var a=this;if(this.request=s,this._isModelOrCollection(i)){var u=this.serializerFor(i.modelName);return u.serialize(i,s)}else return Array.isArray(i)&&i.some(this._isCollection)?i.reduce(function(l,d){var f=a.serializerFor(d.modelName);return f.embed?l[a._container.inflector.pluralize(d.modelName)]=f.serialize(d,s):l=Object.assign(l,f.serialize(d,s)),l},{}):i}},{key:"serializerFor",value:function(i){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=s.explicit,u=a===void 0?!1:a,l=i&&this._serializerMap&&this._serializerMap[z(i)];return u?O(!!l,"You passed in ".concat(i," as an explicit serializer type but that serializer doesn't exist.")):(l=l||this._serializerMap.application||zt,O(!l||l.prototype.embed||l.prototype.root||new l instanceof Ka,"You cannot have a serializer that sideloads (embed: false) and disables the root (root: false).")),new l(this,i,this.request)}},{key:"_isModel",value:function(i){return i instanceof an}},{key:"_isCollection",value:function(i){return i instanceof Qt||i instanceof Et}},{key:"_isModelOrCollection",value:function(i){return this._isModel(i)||this._isCollection(i)}},{key:"registerSerializers",value:function(i){var s=this._serializerMap||{};this._serializerMap=Object.assign(s,i)}},{key:"getCoalescedIds",value:function(i,s){return this.serializerFor(s).getCoalescedIds(i)}}]),o}(),or={},ar={},hr={},Ya=function(){function o(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};V(this,o),O(n,"A schema requires a db"),this.db=n,this._registry={},this._dependentAssociations={polymorphic:[]},this.registerModels(i),this.isSaving={}}return et(o,[{key:"registerModels",value:function(){var i=this,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Dd(s,function(a,u){i.registerModel(u,s[u])})}},{key:"registerModel",value:function(i,s){var a=this,u=z(i),l=tt(u);s=s.extend(),this._registry[u]=this._registry[u]||{class:null,foreignKeys:[]},this._registry[u].class=s,s.prototype._schema=this,s.prototype.modelName=l,s.prototype.hasManyAssociations={},s.prototype.hasManyAssociationFks={},s.prototype.belongsToAssociations={},s.prototype.belongsToAssociationFks={},s.prototype.associationKeys=new Set,s.prototype.associationIdKeys=new Set,s.prototype.dependentAssociations=[];var d={};for(var f in s.prototype)if(s.prototype[f]instanceof _i){var v=s.prototype[f];v.name=f,v.modelName=v.modelName||this.toModelName(f),v.ownerModelName=l,v.setSchema(this);var y=v.getForeignKeyArray(),_=Mt(y,2),x=_[0],P=_[1];d[x]=d[x]||[],O(!d[x].includes(P),"Your '".concat(i,"' model definition has multiple possible inverse relationships of type '").concat(x,"'. Please use explicit inverses.")),d[x].push(P),this._addForeignKeyToRegistry(x,P),v.addMethodsToModelClass(s,f)}var A=this.toCollectionName(l);return this.db[A]||this.db.createCollection(A),this[A]={camelizedModelName:u,new:function(T){return a.new(u,T)},create:function(T){return a.create(u,T)},all:function(T){return a.all(u,T)},find:function(T){return a.find(u,T)},findBy:function(T){return a.findBy(u,T)},findOrCreateBy:function(T){return a.findOrCreateBy(u,T)},where:function(T){return a.where(u,T)},none:function(T){return a.none(u,T)},first:function(T){return a.first(u,T)}},this}},{key:"modelFor",value:function(i){return this._registry[i]}},{key:"new",value:function(i,s){return this._instantiateModel(tt(i),s)}},{key:"create",value:function(i,s){return this.new(i,s).save()}},{key:"all",value:function(i){var s=this.collectionForType(i);return this._hydrate(s,tt(i))}},{key:"none",value:function(i){return this._hydrate([],tt(i))}},{key:"find",value:function(i,s){var a=this.collectionForType(i),u=a.find(s);return Array.isArray(s)&&O(u.length===s.length,"Couldn't find all ".concat(this._container.inflector.pluralize(i)," with ids: (").concat(s.join(","),") (found ").concat(u.length," results, but was looking for ").concat(s.length,")")),this._hydrate(u,tt(i))}},{key:"findBy",value:function(i,s){var a=this.collectionForType(i),u=a.findBy(s);return this._hydrate(u,tt(i))}},{key:"findOrCreateBy",value:function(i,s){var a=this.collectionForType(i),u=a.findBy(s),l;return u?l=this._hydrate(u,tt(i)):l=this.create(i,s),l}},{key:"where",value:function(i,s){var a=this.collectionForType(i),u=a.where(s);return this._hydrate(u,tt(i))}},{key:"first",value:function(i){var s=this.collectionForType(i),a=s[0];return this._hydrate(a,tt(i))}},{key:"modelClassFor",value:function(i){var s=this._registry[z(i)];return O(s,"Model not registered: ".concat(i)),s.class.prototype}},{key:"addDependentAssociation",value:function(i,s){i.isPolymorphic?this._dependentAssociations.polymorphic.push(i):(this._dependentAssociations[s]=this._dependentAssociations[s]||[],this._dependentAssociations[s].push(i))}},{key:"dependentAssociationsFor",value:function(i){var s=this._dependentAssociations[i]||[],a=this._dependentAssociations.polymorphic||[];return s.concat(a)}},{key:"associationsFor",value:function(i){var s=this.modelClassFor(i);return Object.assign({},s.belongsToAssociations,s.hasManyAssociations)}},{key:"hasModelForModelName",value:function(i){return this.modelFor(z(i))}},{key:"collectionForType",value:function(i){var s=this.toCollectionName(i);return O(this.db[s],"You're trying to find model(s) of type ".concat(i," but this collection doesn't exist in the database.")),this.db[s]}},{key:"toCollectionName",value:function(i){if(typeof or[i]!="string"){var s=tt(i),a=z(this._container.inflector.pluralize(s));or[i]=a}return or[i]}},{key:"toInternalCollectionName",value:function(i){if(typeof ar[i]!="string"){var s="_".concat(this.toCollectionName(i));ar[i]=s}return ar[i]}},{key:"toModelName",value:function(i){if(typeof hr[i]!="string"){var s=tt(i),a=this._container.inflector.singularize(s);hr[i]=a}return hr[i]}},{key:"_addForeignKeyToRegistry",value:function(i,s){this._registry[i]=this._registry[i]||{class:null,foreignKeys:[]};var a=this._registry[i].foreignKeys;a.includes(s)||a.push(s)}},{key:"_instantiateModel",value:function(i,s){var a=this._modelFor(i),u=this._foreignKeysFor(i);return new a(this,i,s,u)}},{key:"_modelFor",value:function(i){return this._registry[z(i)].class}},{key:"_foreignKeysFor",value:function(i){return this._registry[z(i)].foreignKeys}},{key:"_hydrate",value:function(i,s){if(Array.isArray(i)){var a=i.map(function(u){return this._instantiateModel(s,u)},this);return new Qt(s,a)}else return i?this._instantiateModel(s,i):null}}]),o}(),jp={Db:$a,Association:_i,RouteHandler:Ua,BaseRouteHandler:on,Serializer:zt,SerializerRegistry:Ga,Schema:Ya},Np={singularize:Ca,pluralize:Sa},Va=function(){function o(){V(this,o),this.inflector=Np}return et(o,[{key:"register",value:function(i,s){this[i]=s}},{key:"create",value:function(i){var s=jp[i];s.prototype._container=this;for(var a=arguments.length,u=new Array(a>1?a-1:0),l=1;l<a;l++)u[l-1]=arguments[l];return Bt(s,u)}}]),o}(),Ce=new Va;$a.prototype._container=Ce;_i.prototype._container=Ce;on.prototype._container=Ce;Ua.prototype._container=Ce;zt.prototype._container=Ce;Ga.prototype._container=Ce;Ya.prototype._container=Ce;var Dp=["http://localhost:0/chromecheckurl","http://localhost:30820/socket.io",function(o){return/.+\.hot-update.json$/.test(o.url)}],Pr={coalesce:!1,timing:void 0};function Bp(o){if(!o||ft(o)!=="object")return!1;for(var n=Object.keys(Pr),i=Object.keys(o),s=0;s<i.length;s++){var a=i[s];if(n.indexOf(a)>-1)return!0}return!1}function Zp(o){var n=o.splice(-1),i=Mt(n,1),s=i[0];Bp(s)?s=gr({},Pr,s):(o.push(s),s=Pr);for(var a=2-o.length;a-- >0;)o.push(void 0);return o.push(s),o}var Hp=function(){function o(){V(this,o),ct(this,"urlPrefix",void 0),ct(this,"namespace",void 0),ct(this,"timing",void 0),ct(this,"passthroughChecks",void 0),ct(this,"pretender",void 0),ct(this,"mirageServer",void 0),ct(this,"trackRequests",void 0)}return et(o,[{key:"create",value:function(i,s){var a=this;this.mirageServer=i,this.pretender=this._create(i,s),i.pretender=this.pretender,this.passthroughChecks=this.passthroughChecks||[],this.config(s),[["get"],["post"],["put"],["delete","del"],["patch"],["head"],["options"]].forEach(function(u){var l=Mt(u,2),d=l[0],f=l[1];a[d]=function(v){for(var y,_=arguments.length,x=new Array(_>1?_-1:0),P=1;P<_;P++)x[P-1]=arguments[P];var A=Zp(x),M=Mt(A,3),T=M[0],j=M[1],U=M[2],rt=i.registerRouteHandler(d,v,T,j,U),yt=a._getFullPath(v),he=U.timing!==void 0?U.timing:function(){return a.timing};return(y=a.pretender)===null||y===void 0?void 0:y[d](yt,rt,he)},i[d]=a[d],f&&(a[f]=a[d],i[f]=a[d])})}},{key:"config",value:function(i){var s,a,u=typeof i.useDefaultPassthroughs<"u"?i.useDefaultPassthroughs:!0;u&&this._configureDefaultPassthroughs();var l=i.trackRequests!==void 0&&i.trackRequests!==this.trackRequests;O(!l,"You cannot modify Pretender's request tracking once the server is created"),this.timing=(s=(a=i.timing)!==null&&a!==void 0?a:this.timing)!==null&&s!==void 0?s:400,this.urlPrefix=this.urlPrefix||i.urlPrefix||"",this.namespace=this.namespace||i.namespace||""}},{key:"_configureDefaultPassthroughs",value:function(){var i=this;Dp.forEach(function(s){i.passthrough(s)})}},{key:"_create",value:function(i,s){if(typeof window<"u")return this.trackRequests=s.trackRequests||!1,new sn(function(){this.passthroughRequest=function(u,l,d){i.shouldLog()&&console.log("Mirage: Passthrough request for ".concat(u.toUpperCase()," ").concat(d.url))},this.handledRequest=function(u,l,d){if(i.shouldLog()){console.groupCollapsed("Mirage: [".concat(d.status,"] ").concat(u.toUpperCase()," ").concat(d.url));var f=d.requestBody,v=d.responseText,y,_;try{y=JSON.parse(f)}catch{y=f}try{_=JSON.parse(v)}catch{_=v}console.groupCollapsed("Response"),console.log(_),console.groupEnd(),console.groupCollapsed("Request (data)"),console.log(y),console.groupEnd(),console.groupCollapsed("Request (raw)"),console.log(d),console.groupEnd(),console.groupEnd()}};var a=this.checkPassthrough;this.checkPassthrough=function(u){var l=i.passthroughChecks.some(function(f){return f(u)});if(l){var d=u.url.includes("?")?u.url.substr(0,u.url.indexOf("?")):u.url;this[u.method.toLowerCase()](d,this.passthrough)}return a.apply(this,arguments)},this.unhandledRequest=function(u,l){l=decodeURI(l);var d="";this.namespace===""?d="There is no existing namespace defined. Please define one":d="The existing namespace is ".concat(this.namespace),O("Your app tried to ".concat(u," '").concat(l,"', but there was no route defined to handle this request. Define a route for this endpoint in your routes() config. Did you forget to define a namespace? ").concat(d))}},{trackRequests:this.trackRequests})}},{key:"passthrough",value:function(){for(var i=this,s=arguments.length,a=new Array(s),u=0;u<s;u++)a[u]=arguments[u];if(typeof window<"u"){var l=["get","post","put","delete","patch","options","head"],d=a[a.length-1];a.length===0?a=["/**","/"]:a.length>1&&Array.isArray(d)&&(l=a.pop()),a.forEach(function(f){typeof f=="function"?i.passthroughChecks.push(f):l.forEach(function(v){var y=i._getFullPath(f);i.pretender[v](y,i.pretender.passthrough)})})}}},{key:"_getFullPath",value:function(i){i=i[0]==="/"?i.slice(1):i;var s="",a=this.urlPrefix?this.urlPrefix.trim():"",u="";if(this.urlPrefix&&this.namespace&&(this.namespace[0]==="/"&&this.namespace[this.namespace.length-1]==="/"&&(u=this.namespace.substring(0,this.namespace.length-1).substring(1)),this.namespace[0]==="/"&&this.namespace[this.namespace.length-1]!=="/"&&(u=this.namespace.substring(1)),this.namespace[0]!=="/"&&this.namespace[this.namespace.length-1]==="/"&&(u=this.namespace.substring(0,this.namespace.length-1)),this.namespace[0]!=="/"&&this.namespace[this.namespace.length-1]!=="/"&&(u=this.namespace)),this.namespace&&!this.urlPrefix){if(this.namespace[0]==="/"&&this.namespace[this.namespace.length-1]==="/"&&(u=this.namespace.substring(0,this.namespace.length-1)),this.namespace[0]==="/"&&this.namespace[this.namespace.length-1]!=="/"&&(u=this.namespace),this.namespace[0]!=="/"&&this.namespace[this.namespace.length-1]==="/"){var l=this.namespace.substring(0,this.namespace.length-1);u="/".concat(l)}this.namespace[0]!=="/"&&this.namespace[this.namespace.length-1]!=="/"&&(u="/".concat(this.namespace))}return this.namespace||(u=""),/^https?:\/\//.test(i)?s+=i:(a.length&&(s+=a[a.length-1]==="/"?a:"".concat(a,"/")),s+=u,s[s.length-1]!=="/"&&(s+="/"),s+=i,/^https?:\/\//.test(s)||(s="/".concat(s),s=s.replace(/\/+/g,"/"))),s}},{key:"start",value:function(){}},{key:"shutdown",value:function(){this.pretender.shutdown()}}]),o}(),ur={},$p={singularize:Ca,pluralize:Sa};function qp(o){return new Up(o)}var Up=function(){function o(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};V(this,o),this._container=new Va,this.config(n),this.db=this.db||void 0,this.schema=this.schema||void 0,this.middleware=[]}return et(o,[{key:"namespace",get:function(){return this.interceptor.namespace},set:function(i){this.interceptor.namespace=i}},{key:"urlPrefix",get:function(){return this.interceptor.urlPrefix},set:function(i){this.interceptor.urlPrefix=i}},{key:"timing",get:function(){return this.interceptor.timing},set:function(i){this.interceptor.timing=i}},{key:"passthroughChecks",get:function(){return this.interceptor.passthroughChecks},set:function(i){this.interceptor.passthroughChecks=i}},{key:"config",value:function(){var i,s,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};a.interceptor||(a.interceptor=new Hp),this.interceptor?this.interceptor.config(a):(this.interceptor=a.interceptor,this.interceptor.create(this,a));var u=a.environment&&this.environment&&this.environment!==a.environment;O(!u,"You cannot modify Mirage's environment once the server is created"),this.environment=a.environment||this.environment||"development",a.routes&&(O(!a.baseConfig,"The routes option is an alias for the baseConfig option. You can't pass both options into your server definition."),a.baseConfig=a.routes),a.seeds&&(O(!a.scenarios,"The seeds option is an alias for the scenarios.default option. You can't pass both options into your server definition."),a.scenarios={default:a.seeds}),this._config=a,this.inflector=a.inflector||$p,this._container.register("inflector",this.inflector),this.logging=a.logging!==void 0?this.logging:void 0,this.testConfig=this.testConfig||void 0,this.trackRequests=a.trackRequests,this.db?this.db.registerIdentityManagers(a.identityManagers):this.db=this._container.create("Db",void 0,a.identityManagers),this.schema?(this.schema.registerModels(a.models),this.serializerOrRegistry.registerSerializers(a.serializers||{})):(this.schema=this._container.create("Schema",this.db,a.models),this.serializerOrRegistry=this._container.create("SerializerRegistry",this.schema,a.serializers));var l=this._hasModulesOfType(a,"factories"),d=a.scenarios&&Object.prototype.hasOwnProperty.call(a.scenarios,"default");a.baseConfig&&this.loadConfig(a.baseConfig),this.isTest()&&(this.loadConfig(a.testConfig),typeof window<"u"&&(window.server=this)),this.isTest()&&l?this.loadFactories(a.factories):!this.isTest()&&d?(this.loadFactories(a.factories),a.scenarios.default(this)):this.loadFixtures(),(i=(s=this.interceptor).start)===null||i===void 0||i.call(s)}},{key:"isTest",value:function(){return this.environment==="test"}},{key:"shouldLog",value:function(){return typeof this.logging<"u"?this.logging:!this.isTest()}},{key:"loadConfig",value:function(i){i==null||i.call(this),this.timing=this.isTest()?0:this.timing||0}},{key:"passthrough",value:function(){for(var i,s,a=arguments.length,u=new Array(a),l=0;l<a;l++)u[l]=arguments[l];(i=(s=this.interceptor).passthrough)===null||i===void 0||i.call.apply(i,[s].concat(u))}},{key:"loadFixtures",value:function(){for(var i=this._config.fixtures,s=arguments.length,a=new Array(s),u=0;u<s;u++)a[u]=arguments[u];if(a.length){var l=a.map(z),d=l.filter(function(f){return!i[f]});if(d.length)throw new Error("Fixtures not found: ".concat(d.join(", ")));i=of.apply(void 0,[i].concat(Ze(l)))}this.db.loadData(i)}},{key:"loadFactories",value:function(){var i=this,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=this._factoryMap||{};this._factoryMap=gr(a,s),Object.keys(s).forEach(function(u){var l=i.schema.toCollectionName(u);i.db.createCollection(l)})}},{key:"factoryFor",value:function(i){var s=z(i);if(this._factoryMap&&this._factoryMap[s])return this._factoryMap[s]}},{key:"build",value:function(i){for(var s=arguments.length,a=new Array(s>1?s-1:0),u=1;u<s;u++)a[u-1]=arguments[u];var l=a.filter(function(M){return M&&typeof M=="string"}),d=Gn(a,function(M){return cr(M)}),f=z(i);this.factorySequences=this.factorySequences||{},this.factorySequences[f]=this.factorySequences[f]+1||0;var v=this.factoryFor(i);if(v){v=v.extend({});var y=v.attrs||{};this._validateTraits(l,v,i);var _=this._mergeExtensions(y,l,d);this._mapAssociationsFromAttributes(i,y,d),this._mapAssociationsFromAttributes(i,_);var x=v.extend(_),P=new x,A=this.factorySequences[f];return P.build(A)}else return d}},{key:"buildList",value:function(i,s){O(So(s),"second argument has to be an integer, you passed: ".concat(ft(s)));for(var a=[],u=arguments.length,l=new Array(u>2?u-2:0),d=2;d<u;d++)l[d-2]=arguments[d];for(var f=[i].concat(l),v=0;v<s;v++)a.push(this.build.apply(this,f));return a}},{key:"create",value:function(i){var s=this;O(this._modelOrFactoryExistsForType(i),"You called server.create('".concat(i,"') but no model or factory was found. Make sure you're passing in the singularized version of the model or factory name."));for(var a=arguments.length,u=new Array(a>1?a-1:0),l=1;l<a;l++)u[l-1]=arguments[l];var d=u.filter(function(T){return T&&typeof T=="string"}),f=Gn(u,function(T){return cr(T)}),v=Gn(u,function(T){return T&&Array.isArray(T)}),y=this.build.apply(this,[i].concat(Ze(d),[f])),_;if(this.schema&&this.schema[this.schema.toCollectionName(i)]){var x=this.schema[this.schema.toCollectionName(i)];_=x.create(y)}else{var P,A;v?P=v:(A=this.schema?this.schema.toInternalCollectionName(i):"_".concat(this.inflector.pluralize(i)),P=this.db[A]),O(P,"You called server.create('".concat(i,"') but no model or factory was found.")),_=P.insert(y)}var M=this.factoryFor(i);return M&&M.extractAfterCreateCallbacks({traits:d}).forEach(function(T){T(_,s)}),_}},{key:"createList",value:function(i,s){O(this._modelOrFactoryExistsForType(i),"You called server.createList('".concat(i,"') but no model or factory was found. Make sure you're passing in the singularized version of the model or factory name.")),O(So(s),"second argument has to be an integer, you passed: ".concat(ft(s)));for(var a=[],u=this.schema?this.schema.toInternalCollectionName(i):"_".concat(this.inflector.pluralize(i)),l=this.db[u],d=arguments.length,f=new Array(d>2?d-2:0),v=2;v<d;v++)f[v-2]=arguments[v];for(var y=[i].concat(f,[l]),_=0;_<s;_++)a.push(this.create.apply(this,y));return a}},{key:"shutdown",value:function(){typeof window<"u"&&this.interceptor.shutdown(),typeof window<"u"&&this.environment==="test"&&(window.server=void 0)}},{key:"resource",value:function(i){var s=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},u=a.only,l=a.except,d=a.path;if(i=this.inflector.pluralize(i),d=d||"/".concat(i),u=u||[],l=l||[],u.length>0&&l.length>0)throw"cannot use both :only and :except options";var f={index:{methods:["get"],path:"".concat(d)},show:{methods:["get"],path:"".concat(d,"/:id")},create:{methods:["post"],path:"".concat(d)},update:{methods:["put","patch"],path:"".concat(d,"/:id")},delete:{methods:["del"],path:"".concat(d,"/:id")}},v=Object.keys(f),y=u.length>0&&u||l.length>0&&v.filter(function(_){return l.indexOf(_)===-1})||v;y.forEach(function(_){var x=f[_];x.methods.forEach(function(P){return d===i?s[P](x.path):s[P](x.path,i)})})}},{key:"_serialize",value:function(i){return typeof i=="string"?i:JSON.stringify(i)}},{key:"registerRouteHandler",value:function(i,s,a,u,l){var d=this,f=arguments.length>5&&arguments[5]!==void 0?arguments[5]:this.middleware,v=this._container.create("RouteHandler",{schema:this.schema,verb:i,rawHandler:a,customizedCode:u,options:l,path:s,serializerOrRegistry:this.serializerOrRegistry,middleware:f});return function(y){return v.handle(y).then(function(_){var x=Mt(_,3),P=x[0],A=x[1],M=x[2];return[P,A,d._serialize(M)]})}}},{key:"_hasModulesOfType",value:function(i,s){var a=i[s];return a?Object.keys(a).length>0:!1}},{key:"_typeIsPluralForModel",value:function(i){if(typeof ur[i]!="boolean"){var s=this._modelOrFactoryExistsForTypeOrCollectionName(i),a=i===this.inflector.pluralize(i),u=this.inflector.singularize(i)===this.inflector.pluralize(i),l=a&&!u&&s;ur[i]=l}return ur[i]}},{key:"_modelOrFactoryExistsForType",value:function(i){var s=this.schema&&this.schema.modelFor(z(i)),a=this.db[this.schema.toInternalCollectionName(i)];return(s||a)&&!this._typeIsPluralForModel(i)}},{key:"_modelOrFactoryExistsForTypeOrCollectionName",value:function(i){var s=this.schema&&this.schema.modelFor(z(i)),a=this.db[this.schema.toInternalCollectionName(i)];return s||a}},{key:"_validateTraits",value:function(i,s,a){i.forEach(function(u){if(!s.isTrait(u))throw new Error("'".concat(u,"' trait is not registered in '").concat(a,"' factory"))})}},{key:"_mergeExtensions",value:function(i,s,a){var u=s.map(function(l){return i[l].extension});return u.push(a||{}),u.reduce(function(l,d){return gr(l,d)},{})}},{key:"_mapAssociationsFromAttributes",value:function(i,s){var a=this,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.keys(s||{}).filter(function(l){return Tp(s[l])}).forEach(function(l){var d=a.schema.modelClassFor(i),f=d.associationFor(l);O(f&&f instanceof li,"You're using the `association` factory helper on the '".concat(l,"' attribute of your ").concat(i," factory, but that attribute is not a `belongsTo` association."));var v=f&&f instanceof li&&f.modelName===i;O(!v,"You're using the association() helper on your ".concat(i," factory for ").concat(l,", which is a belongsTo self-referential relationship. You can't do this as it will lead to infinite recursion. You can move the helper inside of a trait and use it selectively."));var y=f&&f.opts&&f.opts.polymorphic;O(!y,"You're using the association() helper on your ".concat(i," factory for ").concat(l,", which is a polymorphic relationship. This is not currently supported."));var _=s[l],x="".concat(z(l),"Id");u[l]||(s[x]=a.create.apply(a,[f.modelName].concat(Ze(_.traitsAndOverrides))).id),delete s[l]})}}]),o}(),Bo=zt.extend({serializeIds:"always",normalizeIds:!0,keyForModel:function(n){return Jt(n)},keyForAttribute:function(n){return n=zt.prototype.keyForAttribute.apply(this,arguments),Jt(n)},keyForRelationship:function(n){return this._container.inflector.pluralize(Jt(n))},keyForEmbeddedRelationship:function(n){return Jt(n)},keyForRelationshipIds:function(n){return"".concat(Jt(this._container.inflector.singularize(n)),"_ids")},keyForForeignKey:function(n){return"".concat(Jt(n),"_id")},keyForPolymorphicForeignKeyId:function(n){return"".concat(Jt(n),"_id")},keyForPolymorphicForeignKeyType:function(n){return"".concat(Jt(n),"_type")},normalize:function(n){var i=this,s=Object.keys(n)[0],a=n[s],u=z(s),l=this.schema.modelClassFor(u),d=l.belongsToAssociations,f=l.hasManyAssociations,v=Object.keys(d),y=Object.keys(f);this.primaryKey!=="id"&&(a.id=a[this.primaryKey],delete a[this.primaryKey]);var _={data:{type:this._container.inflector.pluralize(s),attributes:{}}};a.id&&(_.data.id=a.id);var x={};return Object.keys(a).forEach(function(P){if(P!=="id")if(i.normalizeIds)if(v.includes(P)){var A=d[P],M=A.modelName;x[tt(P)]={data:{type:M,id:a[P]}}}else if(y.includes(P)){var T=f[P],j=T.modelName,U=a[P].map(function(rt){return{type:j,id:rt}});x[tt(P)]={data:U}}else _.data.attributes[tt(P)]=a[P];else _.data.attributes[tt(P)]=a[P]}),Object.keys(x).length&&(_.data.relationships=x),_},getCoalescedIds:function(n){return n.queryParams&&n.queryParams.ids}});Bo.extend({serializeIds:"always",keyForModel:function(n){return z(n)},keyForAttribute:function(n){return n=Bo.prototype.keyForAttribute.apply(this,arguments),z(n)},keyForRelationship:function(n){return z(this._container.inflector.pluralize(n))},keyForEmbeddedRelationship:function(n){return z(n)},keyForRelationshipIds:function(n){return z(this._container.inflector.pluralize(n))},keyForForeignKey:function(n){return z(this._container.inflector.singularize(n))},getCoalescedIds:function(n){return n.queryParams&&n.queryParams.ids}});const Wp=[{code:"US",name:"United States"},{code:"CN",name:"China"},{code:"JP",name:"Japan"},{code:"GB",name:"United Kingdom"},{code:"DE",name:"Germany"}],Kp={US:[{id:"US-NYC",name:"New York",lat:40.7128,lon:-74.006},{id:"US-SFO",name:"San Francisco",lat:37.7749,lon:-122.4194}],CN:[{id:"CN-SHA",name:"Shanghai",lat:31.2304,lon:121.4737},{id:"CN-BEJ",name:"Beijing",lat:39.9042,lon:116.4074}]},Gp={US:{"US-NYC":[{id:"AS7922",name:"Comcast",cityId:"US-NYC-7922"},{id:"AS3356",name:"Level 3",cityId:"US-NYC-3356"}],"US-SFO":[{id:"AS16509",name:"Amazon",cityId:"US-SFO-16509"},{id:"AS15169",name:"Google",cityId:"US-SFO-15169"}]}},lr=[{id:1,name:"US East Coast",cityIds:["US-NYC-7922","US-NYC-3356"]},{id:2,name:"US West Coast",cityIds:["US-SFO-16509","US-SFO-15169"]}],Yp={samples:1e3,avgLatency:45,medianLatency:42,p70Latency:50,timeSeriesData:Array(7).fill().map((o,n)=>({date:new Date(Date.now()-n*24*60*60*1e3).toISOString().split("T")[0],avgLatency:Math.floor(Math.random()*20+35)})),asnData:[{asn:"AS7922",avgLatency:42},{asn:"AS3356",avgLatency:48}],cityData:[{city:"New York",avgLatency:45},{city:"San Francisco",avgLatency:55}]};function Vp(){return qp({routes(){this.namespace="api",this.post("/login",(o,n)=>{const{username:i,password:s}=JSON.parse(n.requestBody);return i==="admin"&&s==="admin"?{token:"mock-jwt-token"}:new kt(401,{},{error:"Invalid credentials"})}),this.get("/status",()=>({activeNodes:Math.floor(Math.random()*100+200),avgLatency:Math.floor(Math.random()*20+30),uptime:(Math.random()*2+97).toFixed(1),lastUpdate:new Date().toISOString()})),this.get("/ipinfo",(o,n)=>({ip:n.queryParams.ip,asn:"AS15169",country:"US",region:"California",asnType:"Content",ipRange:["2.3.4.0","2.3.4.255"],cityId:"US-SFO-15169",latitude:37.7749,longitude:-122.4194})),this.get("/asninfo",(o,n)=>(n.queryParams.filter,[{asn:"AS16509",country:"US",region:"Virginia",asnType:"Cloud",ipRange:["3.2.34.0","3.2.34.255"],cityId:"US-IAD-16509",latitude:38.9519,longitude:-77.448},{asn:"AS16510",country:"US",region:"Virginia",asnType:"Cloud",ipRange:["3.2.35.0","3.2.35.255"],cityId:"US-IAD-16510",latitude:36.9519,longitude:-75.448}])),this.get("/performance",(o,n)=>{var d,f;const i=((d=n.queryParams.src)==null?void 0:d.split(","))||[],s=((f=n.queryParams.dist)==null?void 0:f.split(","))||[],a=i.map(v=>({cityId:v,asn:v.split("-")[2],latitude:37.7749+Math.random()*10,longitude:-122.4194+Math.random()*10})),u=s.map(v=>({cityId:v,asn:v.split("-")[2],latitude:40.7128+Math.random()*10,longitude:-74.006+Math.random()*10})),l=a.flatMap(v=>u.map(y=>({sourceCityId:v.cityId,sourceAsn:v.asn,sourceLat:v.latitude,sourceLon:v.longitude,destCityId:y.cityId,destAsn:y.asn,destLat:y.latitude,destLon:y.longitude,latency:Math.floor(Math.random()*100+20)})));return{...Yp,sourceLocations:a,destLocations:u,latencyData:l}}),this.get("/cityset",()=>lr),this.post("/cityset",(o,n)=>{const i=JSON.parse(n.requestBody),s={id:lr.length+1,...i};return lr.push(s),s}),this.get("/country",()=>Wp),this.get("/city",(o,n)=>{const i=n.queryParams.country;return Kp[i]||[]}),this.get("/asn",(o,n)=>{var a;const i=n.queryParams.country,s=n.queryParams.city;return i&&s?((a=Gp[i])==null?void 0:a[s])||[]:[]})}})}const Jp=Fu({palette:{mode:"light",primary:{main:"#1976d2"},secondary:{main:"#dc004e"}}}),Xp=()=>document.cookie.split("; ").some(o=>o.startsWith("token=")),Qp=({children:o})=>Xp()?o:m.jsx(Yo,{to:"/login"});function tm(){return E.useEffect(()=>{Vp()},[]),m.jsxs(ju,{theme:Jp,children:[m.jsx(Nu,{}),m.jsx($u,{children:m.jsxs(qu,{children:[m.jsx(be,{path:"/login",element:m.jsx(ql,{})}),m.jsxs(be,{path:"/",element:m.jsx(Qp,{children:m.jsx($l,{})}),children:[m.jsx(be,{index:!0,element:m.jsx(Yo,{to:"/search",replace:!0})}),m.jsx(be,{path:"ipsearch",element:m.jsx(sc,{})}),m.jsx(be,{path:"asnsearch",element:m.jsx(gc,{})}),m.jsx(be,{path:"search",element:m.jsx(yc,{})}),m.jsx(be,{path:"cityset",element:m.jsx(xc,{})})]})]})})]})}console.log("Mounting React application...");fr.createRoot(document.getElementById("root")).render(m.jsx(Bi.StrictMode,{children:m.jsx(tm,{})}));
